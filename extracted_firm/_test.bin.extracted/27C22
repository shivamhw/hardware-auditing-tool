
&&*&&en**&**
alert('Invalid IP address.');
document.url.excludeIP.focus();
return false;
}
if ( !checkDigitRange(document.url.excludeIP.value,2,0,255) ) {
alert('Invalid IP address range in 2nd digit. It should be 1-254.');
document.url.excludeIP.focus();
return false;
}
if ( !checkDigitRange(document.url.excludeIP.value,3,0,255) ) {
alert('Invalid IP address range in 3rd digit. It should be 1-254.');
document.url.excludeIP.focus();
return false;
}
if ( !checkDigitRange(document.url.excludeIP.value,4,1,254) ) {
alert('Invalid IP address range in 4th digit. It should be 1-254.');
document.url.excludeIP.focus();
return false;
}
return true;
}
function updateFilterMode()
{
if (document.url.filterMode[1].checked)
disableCheckBox(document.url.blockAny);
else
enableCheckBox(document.url.blockAny);
}
var selectflag=0;
function ClearAll()
{
document.url.urlFQDN.value = "";
enableTextField(document.url.urlFQDN);
enableRadioGroup(document.url.filterMode);
document.url.Sun.checked=false;
document.url.Mon.checked=false;
document.url.Tue.checked=false;
document.url.Wed.checked=false;
document.url.Thu.checked=false;
document.url.Fri.checked=false;
document.url.Sat.checked=false;
document.url.Everyday.checked=false;
document.url.startHour.value = "";
document.url.startMin.value = "";
document.url.endHour.value = "";
document.url.endMin.value = "";
document.url.alltime.checked = false;
}
function PostURL(any,filter,schedulename,port,day,starthr,startmin,endhr,endmin,delrule)
{
ClearAll();
document.url.deleterule.value = delrule;
var CHECKED_STR = new Array();
CHECKED_STR[0]=document.url.Sun;
CHECKED_STR[1]=document.url.Mon;
CHECKED_STR[2]=document.url.Tue;
CHECKED_STR[3]=document.url.Wed;
CHECKED_STR[4]=document.url.Thu;
CHECKED_STR[5]=document.url.Fri;
CHECKED_STR[6]=document.url.Sat;
CHECKED_STR[7]=document.url.Everyday;
if(any)
{
document.url.blockAny.checked=true;
disableTextField(document.url.urlFQDN);
disableRadioGroup(document.url.filterMode);
}
else
{
document.url.blockAny.checked=false;
document.url.filterMode.checked = true;
document.url.urlFQDN.value = filter;
}
if(port)
{
if(port & lan1port)
document.url.lan1.checked=true;
if(port & lan2port)
document.url.lan2.checked=true;
if(port & lan3port)
document.url.lan3.checked=true;
if(port & lan4port)
document.url.lan4.checked=true;
if(port & wlanport)
document.url.wlroot.checked=true;
}
if(day)
{
var selectnum = 0;
for(i = 0; i < 7;i++)
{
if(day & 1 << i)
{
CHECKED_STR[i].checked=true;
selectnum++;
}
}
if(selectnum == 7)
CHECKED_STR[0]=true;
}
if(schedulename.length!=0)
{
document.getElementsByName("schedulemode")[0].checked=true;
document.url.schedule.value = schedulename;
}
else
{
document.getElementsByName("schedulemode")[1].checked=true;
}
checkScheduleMode();
document.url.startHour.value = starthr;
document.url.startMin.value = startmin;
document.url.endHour.value = endhr;
document.url.endMin.value = endmin;
if(starthr == '00' && startmin == '00' && endhr=='23' && endmin=='59')
document.url.alltime.checked = true;
selectflag =1;
}
function ModifyClick()
{
if(selectflag == 0)
{
alert('No select any entry to modified !!');
return false;
}
return addClick();
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Parent Control";
HelpItem="parentctrl";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">URL BLOCK</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configure the blocked URL in specified time. Here you can add/delete filtered URL.Firstly,you should enable URL Blocking Capability.</p>
Note:To use this feature,the time of router must be correct,Please set in SETUP -- Time and Date.
</td>
</tr>
</table>
<form action="form2parentctrl.cgi" method=POST name="url">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">URL Blocking Capability</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">URL Blocking Capability:</td>
<td class="form_label_right">
<input type="radio" value="0" name="urlcap" >Disable&nbsp;&nbsp;
<input type="radio" value="1" name="urlcap" >Enable
</td>
</tr>
</table>
</td>
</tr>
</table>
<input type="submit" value="Apply Changes" >&nbsp;&nbsp;
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">URL Blocking</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left"><input type="checkbox" name="blockAny" value="1" ONCLICK="updateUrlText()"></td>
<td class="form_label_right"><b>Block Any URL</b></td>
</tr>
<tr>
<td class="form_label_left">
<input type="radio" name="filterMode" value="0" checked>
Keyword:
</td>
<td class="form_label_right">
<input type="text" name="urlFQDN" size="32" maxlength="32"></td>
</tr>
<tr>
<td class="form_label_left">Schedule Mode</td>
<td class="form_label_right">
<input type="radio" name="schedulemode" value=0 onclick="checkScheduleMode()">Existing Schedule
<input type="radio" name="schedulemode" value=1 onclick="checkScheduleMode()" checked>Manual Schedule
</td>
</tr>
<tr>
<td class="form_label_left">Schedule:</td>
<td class="form_label_right">
<select name="schedule">
<VWS_SCREEN (char*) xscrnSelectSchedule[];>
 </select>
<A href="schedule.htm">View Available Schedules</A>
</td>
</tr>
<tr>
<td class="form_label_top">Days:</td>
<td class="form_label_right">
<input type=checkbox name="Everyday" value=0 onclick="CheckDay()">EveryDay<br>
<input type=checkbox name="Sun" value=1 >Sun&nbsp;&nbsp;
<input type=checkbox name="Mon" value=1 >Mon&nbsp;&nbsp;
<input type=checkbox name="Tue" value=1 >Tue&nbsp;&nbsp;
<input type=checkbox name="Wed" value=1 >Wed&nbsp;&nbsp;<br>
<input type=checkbox name="Thu" value=1 >Thu&nbsp;&nbsp;
<input type=checkbox name="Fri" value=1 >Fri&nbsp;&nbsp;
<input type=checkbox name="Sat" value=1 >Sat&nbsp;&nbsp;
</td>
</tr>
<tr>
<td class="form_label_left">All day(24Hour):</td>
<td class="form_label_right"><input type=checkbox name="alltime" value=0 onclick="CheckTime()"></td>
</tr>
<tr>
<td class="form_label_left">Time:</td>
<td class="form_label_right">From&nbsp;
<input type="text" name="startHour" id="startHour" size="2" maxlength="2">:<input type="text" name="startMin" id=="startMin" size="2" maxlength="2">
To&nbsp;
<input type="text" name="endHour" id="endHour" size="2" maxlength="2">:<input type="text" name="endMin" id="endMin" size="2" maxlength="2">&nbsp;<br>(e.g. From 09:21 To 18:30)
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Add Filter" name="addFQDN" onClick="return addClick()">&nbsp;&nbsp;
<input type="submit" value="Modify Filter" name="modify" onClick="return ModifyClick()">&nbsp;&nbsp;
<table id="body_header" border="0" cellspacing="0">
<tr><td class="topheader">URL Blocking Table:</td></tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500" id="parent_table">
<tr class="form_label_row">
<td class="form_label_col">Select</td>
<td class="form_label_col">Filtered URL</td>
<td class="form_label_col">Days</td>
<td class="form_label_col">Time</td>
<td class="form_label_col">Rule Name</td>
</tr>
<VWS_FUNCTION (void*)showTimeURLTable();>
 </table>
</td>
</tr>
</table>
<br>
<input type="hidden" NAME="deleterule" value="">
<input type="submit" value="Delete Selected URL" name="delFQDN">&nbsp;&nbsp;
<input type="hidden" NAME="submit.htm?parent_ctrl.htm" value="Send">
<script>
checkScheduleMode();
<VWS_FUNCTION (void*)initpagestatus();>
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@schedule.htm@#*&10327
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Schedules</title>
<SCRIPT>
<VWS_FUNCTION (void*)URLTableMaxItem();>
function CheckTime()
{
if (document.url.alltime.checked)
{
document.url.startHour.value="00";
document.url.startMin.value="00";
document.url.endHour.value="23";
document.url.endMin.value="59";
document.getElementById("startHour").setAttribute("readOnly","true");
document.getElementById("startMin").setAttribute("readOnly","true");
document.getElementById("endHour").setAttribute("readOnly","true");
document.getElementById("endMin").setAttribute("readOnly","true");
}
else
{
document.url.startHour.value="";
document.url.startMin.value="";
document.url.endHour.value="";
document.url.endMin.value="";
document.getElementById("startHour").removeAttribute("readOnly");
document.getElementById("startMin").removeAttribute("readOnly");
document.getElementById("endHour").removeAttribute("readOnly");
document.getElementById("endMin").removeAttribute("readOnly");
}
}
function CheckDay()
{
if(document.url.Everyday.checked)
{
document.url.Sun.checked=true;
document.url.Mon.checked=true;
document.url.Tue.checked=true;
document.url.Wed.checked=true;
document.url.Thu.checked=true;
document.url.Fri.checked=true;
document.url.Sat.checked=true;
}
else
{
document.url.Sun.checked=false;
document.url.Mon.checked=false;
document.url.Tue.checked=false;
document.url.Wed.checked=false;
document.url.Thu.checked=false;
document.url.Fri.checked=false;
document.url.Sat.checked=false;
}
}
function addClick()
{	
if(document.url.rulename.value=="")
{
alert("Please input rule name.");
return false;
}
else
{
var tab = document.getElementById("schedule_table") ;
var rows = tab.rows.length;
if((rows-1)==maxitem)
{
alert("Max table item is "+maxitem);
return false;
}
else
{
for(i=0;i<rows;i++)
{      	
if(document.all)	//ie explore
var namestr=tab.rows[i].cells[1].innerText;
else
var namestr=tab.rows[i].cells[1].textContent;
if(namestr == document.url.rulename.value)
{
alert("rule name has exist!")
return false;
}
}  
}
}
if(!document.url.Sun.checked && !document.url.Mon.checked && !document.url.Tue.checked && !document.url.Wed.checked &&
!document.url.Thu.checked && !document.url.Fri.checked && !document.url.Sat.checked)
{
alert("Invalid Day!");
return false;
}
if(document.url.startHour.value=="" && document.url.startMin.value=="" &&
document.url.endHour.value=="" && document.url.endMin.value=="")
{
alert("Invalid Time!");
return false;
}
var str1=document.url.startHour.value;
var i=0;
if (str1!="") {
if(str1.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.startHour.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str1.charAt(i) < '0' || str1.charAt(i) > '9')
{
alert("Invalid start hour value!");
document.url.startHour.focus();
return false;
}
}
if(str1.charAt(0) > '2' || (str1.charAt(0) == '2' && str1.charAt(1) > '3'))
{
alert("Invalid start hour value!");
document.url.startHour.focus();
return false;
}
}
var str2=document.url.startMin.value;
if (str2!="") {
if(str2.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.startMin.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str2.charAt(i) < '0' || str2.charAt(i) > '9')
{
alert("Invalid start minute value!");
document.url.startMin.focus();
return false;
}
}
if(str2.charAt(0) > '5')
{
alert("Invalid start minute value!");
document.url.startMin.focus();
return false;
}
}
var str3=document.url.endHour.value;
if (str3!="") {
if(str3.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.endHour.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str3.charAt(i) < '0' || str3.charAt(i) > '9')
{
alert("Invalid end hour value!");
document.url.endHour.focus();
return false;
}
}
if(str3.charAt(0) > '2' || (str3.charAt(0) == '2' && str3.charAt(1) > '3'))
{
alert("Invalid end hour value!");
document.url.endHour.focus();
return false;
}
}
var str4=document.url.endMin.value;
if (str4!="") {
if(str4.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.endMin.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str4.charAt(i) < '0' || str4.charAt(i) > '9')
{
alert("Invalid end minute value!");
document.url.endMin.focus();
return false;
}
}
if(str4.charAt(0) > '5')
{
alert("Invalid end minute value!");
document.url.endMin.focus();
return false;
}
}
if(!((str1=="" && str2=="" && str3=="" && str4=="") || (str1!="" && str2!="" && str3!="" && str4!=""))){
alert("Please input full time setting!");
return false;
}
if((str1.charAt(0) > str3.charAt(0)) || ((str1.charAt(0) == str3.charAt(0)) && (str1.charAt(1) > str3.charAt(1))) || 
((str1.charAt(0) == str3.charAt(0)) && (str1.charAt(1) == str3.charAt(1)) && (str2.charAt(0) > str4.charAt(0))) || 
((str1.charAt(0) == str3.charAt(0)) && (str1.charAt(1) == str3.charAt(1)) && (str2.charAt(0) == str4.charAt(0)) && (str2.charAt(1) > str4.charAt(1)))){
alert("Start time is larger than end time!");
return false;
}
if((str1.charAt(0)== str3.charAt(0)) && (str1.charAt(1)== str3.charAt(1)) 
&& (str2.charAt(0)== str4.charAt(0)) && (str2.charAt(1)== str4.charAt(1)))
{
alert("Start time is equle end time!");
return false;
}
return true;
}
function updateUrlText()
{
if (document.url.blockAny.checked) {	 	
disableTextField(document.url.urlFQDN);	 	
disableRadioGroup(document.url.filterMode);	 
}
else {
enableTextField(document.url.urlFQDN);
enableRadioGroup(document.url.filterMode);	 
}
}
function addIPClick()
{
if (document.url.excludeIP.value=="") {
alert("IP address cannot be empty! It should be filled with 4 digit numbers as xxx.xxx.xxx.xxx.");
document.url.excludeIP.focus();
return false;
}
if ( validateKey(document.url.excludeIP.value ) == 0 ) {
alert("Invalid IP address value. It should be the decimal number (0-9).");
document.url.excludeIP.focus();
return false;
}
var str=document.url.excludeIP.value;
var count=0;
for (var i=0; i<str.length; i++) 
{
if (str.charAt(i) == '.')
{
count++;
}
}
if(count!=3)
{
alert("Invalid IP address. It should be filled with 4 digit numbers as xxx.xxx.xxx.xxx.");
document.url.excludeIP.focus();
return false;
}
if ( !checkDigitRange(document.url.excludeIP.value,1,1,223) ) {
alert('Invalid IP address range in 1st digit. It should be 1-223.');
document.url.excludeIP.focus();
return false;
}
if( IsLoopBackIP(document.url.excludeIP.value))
{
alert('Invalid IP address.');
document.url.excludeIP.focus();
return false;
}
if ( !checkDigitRange(document.url.excludeIP.value,2,0,255) ) {
alert('Invalid IP address range in 2nd digit. It should be 1-254.');
document.url.excludeIP.focus();
return false;
}
if ( !checkDigitRange(document.url.excludeIP.value,3,0,255) ) {
alert('Invalid IP address range in 3rd digit. It should be 1-254.');
document.url.excludeIP.focus();
return false;
}
if ( !checkDigitRange(document.url.excludeIP.value,4,1,254) ) {
alert('Invalid IP address range in 4th digit. It should be 1-254.');
document.url.excludeIP.focus();
return false;
}
return true;
}
function updateFilterMode()
{
if (document.url.filterMode[1].checked)
disableCheckBox(document.url.blockAny);
else 
enableCheckBox(document.url.blockAny);
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Parent Control";
HelpItem="schedule";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Schedules</td>
</tr>
<tr>
<td class="content">
<p>Schedule allows you to create scheduling rules to be applied for URL block.</p>
</td>
</tr>
</table>
<form action="form2parentctrl.cgi" method=POST name="url">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Add Schedule Rule</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Rule Name:</td>
<td class="form_label_right"><input type="text" maxlength="15" size="15" name="rulename"></td>
</tr>
<tr>
<td class="form_label_top">Days:</td>
<td class="form_label_right">
<input type=checkbox name="Everyday" value=0 onclick="CheckDay()">EveryDay<br>
<input type=checkbox name="Sun" value=1 >Sun&nbsp;&nbsp;
<input type=checkbox name="Mon" value=1 >Mon&nbsp;&nbsp;
<input type=checkbox name="Tue" value=1 >Tue&nbsp;&nbsp;
<input type=checkbox name="Wed" value=1 >Wed&nbsp;&nbsp;<br>
<input type=checkbox name="Thu" value=1 >Thu&nbsp;&nbsp;
<input type=checkbox name="Fri" value=1 >Fri&nbsp;&nbsp;
<input type=checkbox name="Sat" value=1 >Sat&nbsp;&nbsp;
</td>
</tr> 
<tr>
<td class="form_label_left">All day(24Hour):</td>
<td class="form_label_right"><input type=checkbox name="alltime" value=0 onclick="CheckTime()"></td>
</tr>
<tr>
<td class="form_label_left">Time:</td>
<td class="form_label_right">From&nbsp;
<input type="text" name="startHour" id="startHour" size="2" maxlength="2">:<input type="text" name="startMin" id="startMin" size="2" maxlength="2">
To&nbsp;
<input type="text" name="endHour"  id="endHour" size="2" maxlength="2">:<input type="text" name="endMin" id="endMin" size="2" maxlength="2">&nbsp;<br>(e.g. From 09:21 To 18:30)
</td>
</tr> 
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Add Rules" name="addFQDN" onClick="return addClick()">&nbsp;&nbsp;
<table id="body_header" border="0" cellspacing="0">
<tr><td class="topheader">Rules Table:</td></tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500" id="schedule_table">
<tr class="form_label_row">
<td class="form_label_col">Select</td>
<td class="form_label_col">Rule Name</td>	
<td class="form_label_col">Days</td>
<td class="form_label_col">Time</td></tr>
<VWS_FUNCTION (void*)showScheduleRulesTable();>
 </table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Delete Selected Rule" name="del_schedule">&nbsp;&nbsp;
<input type="hidden" NAME="submit.htm?schedule.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@mac_block.htm@#*&8765
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Mac Block</title>
<SCRIPT>
<VWS_FUNCTION (void*)MACTableMaxItem();>
function CheckTime()
{
if (document.url.alltime.checked)
{
document.url.startHour.value="00";
document.url.startMin.value="00";
document.url.endHour.value="23";
document.url.endMin.value="59";
document.getElementById("startHour").setAttribute("readOnly","true");
document.getElementById("startMin").setAttribute("readOnly","true");
document.getElementById("endHour").setAttribute("readOnly","true");
document.getElementById("endMin").setAttribute("readOnly","true");
}
else
{
document.url.startHour.value="";
document.url.startMin.value="";
document.url.endHour.value="";
document.url.endMin.value="";
document.getElementById("startHour").removeAttribute("readOnly");
document.getElementById("startMin").removeAttribute("readOnly");
document.getElementById("endHour").removeAttribute("readOnly");
document.getElementById("endMin").removeAttribute("readOnly");
}
}
function CheckDay()
{
if(document.url.Everyday.checked)
{
document.url.Sun.checked=true;
document.url.Mon.checked=true;
document.url.Tue.checked=true;
document.url.Wed.checked=true;
document.url.Thu.checked=true;
document.url.Fri.checked=true;
document.url.Sat.checked=true;
}
else
{
document.url.Sun.checked=false;
document.url.Mon.checked=false;
document.url.Tue.checked=false;
document.url.Wed.checked=false;
document.url.Thu.checked=false;
document.url.Fri.checked=false;
document.url.Sat.checked=false;
}
}
function addClick()
{	
if(document.url.macrulename.value=="")
{
alert("Please input rule name.");
return false;
}
else
{
var tab = document.getElementById("mac_block_table") ;
var rows = tab.rows.length;
if((rows-1)==maxitem)
{
alert("Max table item is "+maxitem);
return false;
}
else
{
for(i=0;i<rows;i++)
{
if(document.all)	//ie explore
var namestr=tab.rows[i].cells[1].innerText;
else
var namestr=tab.rows[i].cells[1].textContent;
if(namestr == document.url.macrulename.value)
{
alert("rule name has exist!")
return false;
}
}  
}
}
if(!checkFormatUnicastMac(document.url.macaddr))
return false;  
if(!document.url.Sun.checked && !document.url.Mon.checked && !document.url.Tue.checked && !document.url.Wed.checked &&
!document.url.Thu.checked && !document.url.Fri.checked && !document.url.Sat.checked)
{
alert("Invalid Day!");
return false;
}
if(document.url.startHour.value=="" && document.url.startMin.value=="" &&
document.url.endHour.value=="" && document.url.endMin.value=="")
{
alert("Invalid Time!");
return false;
}
var str1=document.url.startHour.value;
var i=0;
if (str1!="") {
if(str1.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.startHour.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str1.charAt(i) < '0' || str1.charAt(i) > '9')
{
alert("Invalid start hour value!");
document.url.startHour.focus();
return false;
}
}
if(str1.charAt(0) > '2' || (str1.charAt(0) == '2' && str1.charAt(1) > '3'))
{
alert("Invalid start hour value!");
document.url.startHour.focus();
return false;
}
}
var str2=document.url.startMin.value;
if (str2!="") {
if(str2.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.startMin.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str2.charAt(i) < '0' || str2.charAt(i) > '9')
{
alert("Invalid start minute value!");
document.url.startMin.focus();
return false;
}
}
if(str2.charAt(0) > '5')
{
alert("Invalid start minute value!");
document.url.startMin.focus();
return false;
}
}
var str3=document.url.endHour.value;
if (str3!="") {
if(str3.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.endHour.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str3.charAt(i) < '0' || str3.charAt(i) > '9')
{
alert("Invalid end hour value!");
document.url.endHour.focus();
return false;
}
}
if(str3.charAt(0) > '2' || (str3.charAt(0) == '2' && str3.charAt(1) > '3'))
{
alert("Invalid end hour value!");
document.url.endHour.focus();
return false;
}
}
var str4=document.url.endMin.value;
if (str4!="") {
if(str4.length != 2){
alert("Invalid time format! correct format should be like: 09,15");
document.url.endMin.focus();
return false;
}
for (i=0; i<2; i++) 
{
if (str4.charAt(i) < '0' || str4.charAt(i) > '9')
{
alert("Invalid end minute value!");
document.url.endMin.focus();
return false;
}
}
if(str4.charAt(0) > '5')
{
alert("Invalid end minute value!");
document.url.endMin.focus();
return false;
}
}
if(!((str1=="" && str2=="" && str3=="" && str4=="") || (str1!="" && str2!="" && str3!="" && str4!=""))){
alert("Please input full time setting!");
return false;
}
if((str1.charAt(0) > str3.charAt(0)) || ((str1.charAt(0) == str3.charAt(0)) && (str1.charAt(1) > str3.charAt(1))) || 
((str1.charAt(0) == str3.charAt(0)) && (str1.charAt(1) == str3.charAt(1)) && (str2.charAt(0) > str4.charAt(0))) || 
((str1.charAt(0) == str3.charAt(0)) && (str1.charAt(1) == str3.charAt(1)) && (str2.charAt(0) == str4.charAt(0)) && (str2.charAt(1) > str4.charAt(1)))){
alert("Start time is larger than end time!");
return false;
}
if((str1.charAt(0)== str3.charAt(0)) && (str1.charAt(1)== str3.charAt(1)) 
&& (str2.charAt(0)== str4.charAt(0)) && (str2.charAt(1)== str4.charAt(1)))
{
alert("Start time is equle end time!");
return false;
}
return true;
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Parent Control";
HelpItem="blockmac";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">MAC BLOCK</td>
</tr>
<tr>
<td class="content">
<p>This page is used to block a LAN device connected to the router in the specified time section.
To find out the MAC address of a Windows-based PC, open a command prompt window and type "ipconfig /all".</p>
</td>
</tr>
</table>
<form action="form2macblock.cgi" method=POST name="url">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">MAC Blocking</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Rule Name:</td>
<td class="form_label_right"><input type="text" name="macrulename" size="17" maxlength="17"></td>
</tr>
<tr>
<td class="form_label_left">MAC Address:</td>
<td class="form_label_right"><input type="text" name="macaddr" size="17" maxlength="17">(Ex. 00:E0:86:71:05:02)</td>
</tr>
<tr>
<td class="form_label_top">Days:</td>
<td class="form_label_right">
<input type=checkbox name="Everyday" value=0 onclick="CheckDay()">EveryDay<br>
<input type=checkbox name="Sun" value=1 >Sun&nbsp;&nbsp;
<input type=checkbox name="Mon" value=1 >Mon&nbsp;&nbsp;
<input type=checkbox name="Tue" value=1 >Tue&nbsp;&nbsp;
<input type=checkbox name="Wed" value=1 >Wed&nbsp;&nbsp;<br>
<input type=checkbox name="Thu" value=1 >Thu&nbsp;&nbsp;
<input type=checkbox name="Fri" value=1 >Fri&nbsp;&nbsp;
<input type=checkbox name="Sat" value=1 >Sat&nbsp;&nbsp;
</td>
</tr> 
<tr>
<td class="form_label_left">All day(24Hour):</td>
<td class="form_label_right"><input type=checkbox name="alltime" value=0 onclick="CheckTime()"></td>
</tr>
<tr>
<td class="form_label_left">Time:</td>
<td class="form_label_right">From&nbsp;
<input type="text" name="startHour" id="startHour" size="2" maxlength="2">:<input type="text" name="startMin" id="startMin" size="2" maxlength="2">
To&nbsp;
<input type="text" name="endHour" id="endHour" size="2" maxlength="2">:<input type="text" name="endMin" id="endMin" size="2" maxlength="2">&nbsp;<br>(e.g. From 09:21 To 18:30)
</td>
</tr> 
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Add Rule" name="addMAC" onClick="return addClick()">&nbsp;&nbsp;
<table id="body_header" border="0" cellspacing="0">
<tr><td class="topheader">MAC Blocking Table:</td></tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500" id="mac_block_table">
<tr class="form_label_row">
<td class="form_label_col">Select</td>
<td class="form_label_col">Rule name</td>	
<td class="form_label_col">MAC</td>	
<td class="form_label_col">Days</td>	
<td class="form_label_col">Time</td></tr>	
<VWS_FUNCTION (void*)showTimeMACTable();>
 </table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Delete Selected" name="delMAC">&nbsp;&nbsp;
<input type="hidden" NAME="submit.htm?mac_block.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wanadsl_auto_droute.htm@#*&32920
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>ADSL Connection Mode</title>
<script>
<VWS_FUNCTION (void*)PvcParameterFixed();>
var initConnectMode;
var pppConnectStatus=0;
var selectflag=0;
function pppTypeSelection()
{
if ( document.adsl.pppConnectType.selectedIndex == 2) {
document.adsl.pppIdleTime.value = "";
disableTextField(document.adsl.pppIdleTime);
}
else {
disableButtonIB(document.adsl.pppConnect);
disableButtonIB(document.adsl.pppDisconnect);
if (document.adsl.pppConnectType.selectedIndex == 1) {
if(document.adsl.pppIdleTime.value=="")
document.adsl.pppIdleTime.value = 10;
enableTextField(document.adsl.pppIdleTime);
}
else {
document.adsl.pppIdleTime.value = "";
disableTextField(document.adsl.pppIdleTime);
}
}
}
function pppConnectClick(connect)
{
if (( document.adsl.adslConnectionMode.selectedIndex == 2 ) ||
( document.adsl.adslConnectionMode.selectedIndex == 3 ) ) {
if ( document.adsl.pppConnectType.selectedIndex == 2 && pppConnectStatus==connect) {
if (document.adsl.pppUserName.value=="") {
alert('PPP user name cannot be empty!');
document.adsl.pppUserName.focus();
return false;
}
}
return true;
}
return false;
}
function addClick()
{
return vcCheck();
}
function modifyCheck()
{
if(selectflag==0)
{
alert('No select any entry to modified !!');
return false;
}
if( (document.adsl.vpi.value==1)&&(document.adsl.vci.value==39))
{
alert('This interface (vpi='+document.adsl.vpi.value+', vci='+document.adsl.vci.value+') is reserved can not be modified !!');
return false;
}
return vcCheck();
}
function delCheck()
{
if(fixparameter =='1')
{
var radiolist=document.getElementsByName("select");
var len=radiolist.length;
var selectedvalue;
for(var k=0;k<len;k++)
{
if(radiolist[k].checked)
{
selectedvalue=radiolist[k].value;
break;
}
}
var arraylen=FixPara.length;
for(i=0;i<arraylen;i++)
{
if(selectedvalue == FixPara[i])
{
alert('This interface is default,can not be deleted !!');
return false;
}
}
}
return true;
}
function vcCheck()
{
digit = getDigit(document.adsl.vpi.value, 1);
if ( validateKey(document.adsl.vpi.value) == 0 ||
(digit > 255 || digit < 0) ) {
alert("Invalid VPI value! You should set a value between 0-255.");
document.adsl.vpi.focus();
return false;
}
digit = getDigit(document.adsl.vci.value, 1);
if ( validateKey(document.adsl.vci.value) == 0 ||
(digit > 65535 || digit < 32) ) {
alert("Invalid VCI value! You should set a value between 32-65535.");
document.adsl.vci.focus();
return false;
}
if (( document.adsl.adslConnectionMode.selectedIndex == 2 ) ||
( document.adsl.adslConnectionMode.selectedIndex == 3 )) {
if (document.adsl.pppUserName.value=="") {
alert('PPP user name cannot be empty!');
document.adsl.pppUserName.focus();
return false;
}
if(!checkSpecialChar(document.adsl.pppUserName.value,1))
{
alert("Invalid characters!");
document.adsl.pppUserName.focus();
return false;
}
if(!checkSpecialChar(document.adsl.pppPassword.value,0))
{
alert("Invalid characters!");
document.adsl.pppPassword.focus();
return false;
}
if(document.adsl.pppConnectType.value==1){
digit = getDigit(document.adsl.pppIdleTime.value, 1);
if( validateKey(document.adsl.pppIdleTime.value) == 0 ||
(digit==0)){
alert('Invalid PPP IdleTime!');
document.adsl.pppIdleTime.focus();
return false;
}
}
}
if(document.adsl.IpProtocolType.value == 0 ||document.adsl.IpProtocolType.value == 1)
{
if (( document.adsl.adslConnectionMode.selectedIndex == 1 ) ||
( document.adsl.adslConnectionMode.selectedIndex == 4 ) ||
( document.adsl.adslConnectionMode.selectedIndex == 5 ))
{
if (document.adsl.ipMode[0].checked) {
if ( !checkIP(document.adsl.ip))
{
return false;
}
if (document.adsl.remoteIp.value!="")
{
if ( !checkIP(document.adsl.remoteIp))
{
return false;
}
}
if (!checkMask(document.adsl.netmask))
return false;
}
}
}
if(document.adsl.IpProtocolType.value == 0 ||document.adsl.IpProtocolType.value == 2)
{
if(document.adsl.Ipv6AddrType.value == 1){
if(document.adsl.Ipv6Addr.value != ""){
if (! isGlobalIpv6Address( document.adsl.Ipv6Addr.value) ){
alert("Invalid ipv6 address!");
document.adsl.Ipv6Addr.focus();
return false;
}
var prefixlen= getDigit(document.adsl.Ipv6PrefixLen.value, 1);
if (prefixlen > 128 || prefixlen <= 0) {
alert("Invalid ipv6 prefix length!");
document.adsl.Ipv6PrefixLen.focus();
return false;
}
}
if(document.adsl.Ipv6Gateway.value != "" ){
if (! isUnicastIpv6Address( document.adsl.Ipv6Gateway.value) ){
alert("Invalid ipv6 gateway address!");
document.adsl.Ipv6Gateway.focus();
return false;
}
}
}else{
document.adsl.Ipv6Addr.value = "";
document.adsl.Ipv6PrefixLen.value = "";
document.adsl.Ipv6Gateway.value = "";
}
}
if (document.adsl.vlan[1].checked)
{
if(document.adsl.vlanid.value < 1 || document.adsl.vlanid.value > 4095)
{
alert("Invalid VLAN ID,it should be 1-4095.");
document.adsl.vlanid.focus();
return false;
}
}
return true;
}
function setPPPConnected()
{
pppConnectStatus = 1;
}
function resetClicked()
{
if (( initConnectMode == 2 ) ||
( initConnectMode == 3 )) {
pppSettingsEnable();
ipSettingsDisable();
}
else if ( initConnectMode == 0 ) {
document.adsl.naptEnabled.disabled = true;
document.adsl.igmpEnabled.disabled = true;
pppSettingsDisable();
ipSettingsDisable();
}
else {
pppSettingsDisable();
ipSettingsEnable();
}
if (initConnectMode == 4)
document.adsl.ipUnnum.disabled = false;
if(fixparameter =='1')
{
document.getElementById("vpi").removeAttribute("readOnly");
document.getElementById("vci").removeAttribute("readOnly");
document.getElementById("pppUserName").removeAttribute("readOnly");

&&*&&en**&**
document.getElementById("pppPassword").removeAttribute("readOnly");
document.adsl.adslConnectionMode.disabled=false;
document.adsl.adslEncap[0].disabled=false;
document.adsl.adslEncap[1].disabled=false;
}
selectflag=0;
}
function disableFixedIpInput()
{
disableTextField(document.adsl.ip);
disableTextField(document.adsl.remoteIp);
disableTextField(document.adsl.netmask);
}
function enableFixedIpInput()
{
enableTextField(document.adsl.ip);
enableTextField(document.adsl.netmask);
if(document.DrouteMethod.autoDroute[0].checked == false)
{
if(document.adsl.droute[1].checked)
enableTextField(document.adsl.remoteIp);
}else
{
enableTextField(document.adsl.remoteIp);
}
}
function ipTypeSelection()
{
if ( document.adsl.ipMode[0].checked ) {
enableFixedIpInput();
} else {
disableFixedIpInput()
}
}
function pppSettingsEnable()
{
enableTextField(document.adsl.pppUserName);
enableTextField(document.adsl.pppPassword);
enableTextField(document.adsl.pppConnectType);
pppTypeSelection();
if(document.DrouteMethod.autoDroute[1].checked == true)
{
document.adsl.droute[0].disabled = false;
document.adsl.droute[1].disabled = false;
}
}
function naptClicked()
{
if(document.adsl.adslConnectionMode.selectedIndex == 4 )
{
if (document.adsl.naptEnabled.checked == true) {
document.adsl.ipUnnum.checked = false;
document.adsl.ipUnnum.disabled = true;
}
else
document.adsl.ipUnnum.disabled = false;
}
}
function click1q()
{
if (document.adsl.vlan[0].checked)
document.adsl.vlanid.disabled=true;
else
document.adsl.vlanid.disabled=false;
}
function pppUnnumberedSettingsEnable()
{
enableTextField(document.adsl.pppUserName);
enableTextField(document.adsl.pppPassword);
enableTextField(document.adsl.pppConnectType);
enableTextField(document.adsl.unnumberedip);
enableTextField(document.adsl.unnumberedmask);
pppTypeSelection();
}
function pppSettingsDisable()
{
disableTextField(document.adsl.pppUserName);
disableTextField(document.adsl.pppPassword);
disableTextField(document.adsl.pppIdleTime);
disableTextField(document.adsl.pppConnectType);
disableButtonIB(document.adsl.pppConnect);
disableButtonIB(document.adsl.pppDisconnect);
document.adsl.droute[0].disabled = true;
document.adsl.droute[1].disabled = true;
}
function ipSettingsEnable()
{
if ( document.adsl.adslConnectionMode.selectedIndex == 4)
{
document.adsl.ipMode[0].checked = true;
if (document.adsl.naptEnabled.checked)
document.adsl.ipUnnum.disabled = true;
else
document.adsl.ipUnnum.disabled = false;
document.adsl.ipMode[0].disabled = true;
document.adsl.ipMode[1].disabled = true;
}
else {
document.adsl.ipMode[0].disabled = false;
document.adsl.ipMode[1].disabled = false;
}
if(document.DrouteMethod.autoDroute[0].checked == false)
{
document.adsl.droute[0].disabled = false;
document.adsl.droute[1].disabled = false;
if(document.adsl.droute[0].checked==true)
document.adsl.remoteIp.disabled=true;
else
document.adsl.remoteIp.disabled=false;
}
else{
document.adsl.remoteIp.disabled=false;
}
ipTypeSelection();
}
function ipunnumSettingsEnable()
{
if ( document.adsl.adslConnectionMode.selectedIndex == 4)
{
document.adsl.ipMode[0].checked = true;
if (document.adsl.naptEnabled.checked)
document.adsl.ipUnnum.disabled = true;
else
document.adsl.ipUnnum.disabled = false;
document.adsl.ipMode[0].disabled = true;
document.adsl.ipMode[1].disabled = true;
document.adsl.remoteIp.disabled = true;
if(document.DrouteMethod.autoDroute[0].checked == false)
{
document.adsl.droute[0].disabled = false;
document.adsl.droute[1].disabled = false;
}
ipTypeSelection();
}
else
{
document.adsl.ipMode[0].disabled = true;
document.adsl.ipMode[1].disabled = true;
disableFixedIpInput();
}
}
function ipSettingsDisable()
{
document.adsl.ipMode[0].disabled = true;
document.adsl.ipMode[1].disabled = true;
disableFixedIpInput();
document.adsl.droute[0].disabled = true;
document.adsl.droute[1].disabled = true;
}
function ipModeSelection()
{
if (document.adsl.ipUnnum.checked) {
pppSettingsDisable();
ipSettingsDisable();
if(document.DrouteMethod.autoDroute[0].checked == false)
{
document.adsl.droute[0].disabled = false;
document.adsl.droute[1].disabled = false;
}
}
else
ipSettingsEnable();
}
function ipUnnumModeSelection()
{
if (document.adsl.ipUnnum.checked) {
ipSettingsDisable();
if(document.DrouteMethod.autoDroute[0].checked == false)
{
document.adsl.droute[0].disabled = false;
document.adsl.droute[1].disabled = false;
}
document.adsl.ipMode[0].checked = false;
document.adsl.ipMode[1].checked = false;
document.adsl.remoteIp.disabled = true;
}
else
ipunnumSettingsEnable();
}
function adslConnectionModeSelection()
{
document.adsl.naptEnabled.disabled = false;
document.adsl.igmpEnabled.disabled = false;
document.adsl.igmpEnabled.checked = false;
document.adsl.adslEncap[1].disabled = false;
if (( document.adsl.adslConnectionMode.selectedIndex == 1 ) ||
( document.adsl.adslConnectionMode.selectedIndex == 2 ))
document.adsl.naptEnabled.checked = true;
else
document.adsl.naptEnabled.checked = false;
ipv6SettingsEnable();
document.getElementById('tbprotocol').style.display="block";
if ( document.adsl.adslConnectionMode.selectedIndex == 2 )
{
ipSettingsDisable();
pppSettingsEnable();
document.adsl.ipUnnum.disabled =true;
}
else if ( document.adsl.adslConnectionMode.selectedIndex == 3 ) {
ipSettingsDisable();
pppSettingsEnable();
document.adsl.ipUnnum.disabled =true;
}
else if ((document.adsl.adslConnectionMode.selectedIndex == 4) )
{
document.adsl.ipMode[0].checked = true;
pppSettingsDisable();
ipSettingsEnable();
document.adsl.ipUnnum.disabled = true;
document.adsl.ipMode[0].disabled = true;
document.adsl.ipMode[1].disabled = true;
document.adsl.ipUnnum.disabled =false;
}
else if (document.adsl.adslConnectionMode.selectedIndex == 5)
{
document.adsl.ipMode[0].checked = true;
document.adsl.adslEncap[0].checked = true;
pppSettingsDisable();
ipSettingsEnable();
document.adsl.ipUnnum.disabled = true;
document.adsl.ipMode[0].disabled = true;
document.adsl.ipMode[1].disabled = true;
document.adsl.adslEncap[1].disabled = true;
}
else if ( document.adsl.adslConnectionMode.selectedIndex == 0 ) {
document.adsl.ipUnnum.disabled = true;
document.adsl.naptEnabled.disabled = true;
document.adsl.igmpEnabled.disabled = true;
pppSettingsDisable();
ipSettingsDisable();
ipv6SettingsDisable();
document.getElementById('tbprotocol').style.display="none";
}
else {
pppSettingsDisable();
ipSettingsEnable();
document.adsl.ipUnnum.disabled = true;
}
if( document.adsl.adslConnectionMode.selectedIndex != 0 )
protocolChange();
}
function DeleteClick()
{
if(selectflag==0)
{
alert('No select any entry to deleted !!');
return false;
}
if( (document.adsl.vpi.value==1)&&(document.adsl.vci.value==39))
{
alert('This interface (vpi='+document.adsl.vpi.value+', vci='+document.adsl.vci.value+') is reserved can not be deleted !!');
return false;
}
if ( !confirm('Do you really want to delete the selected entry?') ) {
return false;
}
else
return true;
}
function clearAll()
{
document.adsl.vpi.value = 0;
document.adsl.vci.value = "";
document.adsl.adslEncap.value = 0;
document.adsl.naptEnabled.checked = false;
document.adsl.igmpEnabled.checked = false;
document.adsl.adslConnectionMode.value = 0;
document.adsl.pppUserName.value = "";
document.adsl.pppPassword.value = "";
document.adsl.pppConnectType.value = 0;
document.adsl.pppIdleTime.value = "";
document.adsl.netmask.value = "";
document.adsl.ipMode.value = 0;
document.adsl.ip.value = "";
document.adsl.remoteIp.value = "";
if(fixparameter =='1')
{
document.getElementById("vpi").removeAttribute("readOnly");
document.getElementById("vci").removeAttribute("readOnly");
document.getElementById("pppUserName").removeAttribute("readOnly");
document.getElementById("pppPassword").removeAttribute("readOnly");
document.adsl.adslConnectionMode.disabled=false;
document.adsl.adslEncap[0].disabled=false;
document.adsl.adslEncap[1].disabled=false;
}
document.adsl.IpProtocolType.value=1;
document.adsl.Ipv6AddrType.value=0;
document.adsl.Ipv6Addr.value="";
document.adsl.Ipv6PrefixLen.value="";
document.adsl.Ipv6Gateway.value="";
document.adsl.dhcp6mode.value=0;
document.adsl.iaenable.checked = true;
document.adsl.pdenable.checked = true;
}
function postVC(vpi,vci,encap,napt,mode,vlan, vlanid, igmp,username,passwd,auth,acname,servicename,pppType,idletime,ipmode,ipaddr,netmask,remoteip,ipunnum,
protocoltype, ipv6type, ipv6add, ipv6prefix, ipv6gw, dhcp6mode, dhcp6pdenable, dhcp6iaenable,
ipv6dhcpcenable, ipv6requestaddr, ipv6requestprefix,
status,droute,enable)
{
clearAll();
document.adsl.vpi.value = vpi;
document.adsl.vci.value = vci;
if (encap == "LLC")
document.adsl.adslEncap[0].checked = true;
else
document.adsl.adslEncap[1].checked = true;
if (mode == "br1483")
document.adsl.adslConnectionMode.value = 0;
else if (mode == "mer1483")
document.adsl.adslConnectionMode.value = 1;
else if (mode == "PPPoE")
document.adsl.adslConnectionMode.value = 2;
else if (mode == "PPPoA")
document.adsl.adslConnectionMode.value = 3;
else if (mode == "rt1483")
document.adsl.adslConnectionMode.value = 4;
else if (mode == "IPoA")
document.adsl.adslConnectionMode.value = 5;
adslConnectionModeSelection();
if (vlan == "Enable") {
document.adsl.vlan[1].checked = true;
}
else {
document.adsl.vlan[0].checked = true;
}
document.adsl.vlanid.value = vlanid;
click1q();
if (napt == "On")
document.adsl.naptEnabled.checked = true;
else
document.adsl.naptEnabled.checked = false;
if (igmp == "On")
document.adsl.igmpEnabled.checked = true;
else
document.adsl.igmpEnabled.checked = false;
if (enable == 0)
document.adsl.chEnable[1].checked = true;
else
document.adsl.chEnable[0].checked = true;
if((mode == "PPPoE") || (mode == "PPPoA") )
{
document.adsl.pppUserName.value = username;
document.adsl.pppPassword.value = passwd;
document.adsl.pppauth.value=auth;
document.adsl.pppacname.value = acname;
document.adsl.pppservicename.value = servicename;
document.adsl.ipUnnum.disabled = true;
if (pppType == "persistent")
document.adsl.pppConnectType.value = 0;
else if (pppType == "dial-on-demand")
document.adsl.pppConnectType.value = 1;
else
{
document.adsl.pppConnectType.value = 2;
if (status == 0)
{
disableButtonIB(document.adsl.pppConnect);
disableButtonIB(document.adsl.pppDisconnect);
}
if (status == 2)
{
enableButtonIB(document.adsl.pppConnect);
disableButtonIB(document.adsl.pppDisconnect);
}
else
{
enableButtonIB(document.adsl.pppDisconnect);
disableButtonIB(document.adsl.pppConnect);
}
}
pppTypeSelection();
if (pppType == "dial-on-demand")
document.adsl.pppIdleTime.value = idletime;
}
else if (mode == "mer1483" || mode == "rt1483" || mode == "IPoA")
{
document.adsl.ipMode[ipmode].checked = true;
if (ipmode == 0)
{
document.adsl.ip.value=ipaddr;
document.adsl.remoteIp.value=remoteip;
document.adsl.netmask.value=netmask;
}
if(mode == "rt1483")
{
if(document.adsl.naptEnabled.checked ==true)
document.adsl.ipUnnum.disabled = true;
else
document.adsl.ipUnnum.disabled = false;
}
}
if(document.DrouteMethod.autoDroute[0].checked == false)
{
if (droute == 1){
document.adsl.droute[1].checked = true;
if(ipunnum == 0){
if(mode != "PPPoE" && mode != "PPPoA")
document.adsl.remoteIp.disabled=false;
}
}
else{
document.adsl.droute[0].checked = true;
document.adsl.remoteIp.disabled=true;
}
}
if(ipunnum == 1)
document.adsl.ipUnnum.checked = true;
else
document.adsl.ipUnnum.checked = false;
if(mode != "br1483"){
document.adsl.IpProtocolType.value = protocoltype;
if(protocoltype != 1){
document.adsl.Ipv6AddrType.value = ipv6type;
ipv6Wanchange();
if(ipv6type == 1){
document.adsl.Ipv6Addr.value = ipv6add;
document.adsl.Ipv6PrefixLen.value = ipv6prefix;
document.adsl.Ipv6Gateway.value = ipv6gw;
}
document.adsl.dhcp6mode.value = dhcp6mode;
if(dhcp6pdenable==1)
document.adsl.pdenable.checked = true;
else
document.adsl.pdenable.checked = false;
if(dhcp6iaenable==1)
document.adsl.iaenable.checked = true;
else
document.adsl.iaenable.checked = false;
}
protocolChange();
}
if(fixparameter =='1')
{
var radiolist=document.getElementsByName("select");
var len=radiolist.length;
var selectedvalue;
for(var k=0;k<len;k++)
{
if(radiolist[k].checked)
{
selectedvalue=radiolist[k].value;
break;
}
}
var arraylen=FixPara.length;
for(i=0;i<arraylen;i++)
{
if(selectedvalue == FixPara[i])
{
document.getElementById("vpi").setAttribute("readOnly","true");
document.getElementById("vci").setAttribute("readOnly","true");
document.getElementById("pppUserName").setAttribute("readOnly","true");
document.getElementById("pppPassword").setAttribute("readOnly","true");
document.adsl.adslConnectionMode.disabled=true;
document.adsl.adslEncap[0].disabled=true;
document.adsl.adslEncap[1].disabled=true;
}
}
}
selectflag=1;
}
function remoteipenable()
{
if(document.adsl.adslConnectionMode.selectedIndex==1)
document.adsl.remoteIp.disabled=false;
else if((document.adsl.adslConnectionMode.selectedIndex==4))
{
if(document.adsl.ipUnnum.checked)
document.adsl.remoteIp.disabled=true;
else
document.adsl.remoteIp.disabled=false;
}
else if((document.adsl.adslConnectionMode.selectedIndex==5)){
document.adsl.remoteIp.disabled=false;
}
}
function remoteipdisable()
{
if(document.adsl.adslConnectionMode.selectedIndex==1||document.adsl.adslConnectionMode.selectedIndex==4
|| document.adsl.adslConnectionMode.selectedIndex==5)
document.adsl.remoteIp.disabled=true;
}
function autopvcapplycheckclick()
{
if(document.adsl.autopvc.checked == true ){
if(!confirm("auto search pvc mode will have only one wan interface,really?")){
document.adsl.autopvc.checked = false;
return false;
}
}
updatepvcState();
}
function updatepvcState()
{
if (document.adsl.autopvc.checked== true) {
document.adsl.autopvc.value="ON";
document.adsl.enablepvc.value = 1;
disableTextField(document.adsl.vpi);
disableTextField(document.adsl.vci);
enableTextField(document.adsl.autopvcvci);
enableTextField(document.adsl.autopvcvpi);
enableButtonIB(document.adsl.autopvcadd);
} else {
document.adsl.autopvc.value="OFF";
document.adsl.enablepvc.value = 0;
disableTextField(document.adsl.autopvcvci);
disableTextField(document.adsl.autopvcvpi);
disableButtonIB(document.adsl.autopvcadd);
}
}
function updateauto()
{
if(document.adsl.enablepvc.value==1)
{
disableTextField(document.adsl.vpi);
disableTextField(document.adsl.vci);
}
else
{
enableTextField(document.adsl.vpi);
enableTextField(document.adsl.vci);
}
}
function updatepvcState2()
{
if (document.adsl.autopvc.checked == true) {
document.adsl.autopvc.value="ON";
document.adsl.enablepvc.value = 1;
} else {
document.adsl.autopvc.value="OFF";
document.adsl.enablepvc.value = 0;
}
}
function autopvcCheckClick()
{
var dVPI,dVCI;
if (document.adsl.autopvc.checked == true) {
document.adsl.enablepvc.value = 1;
dVPI = getDigit(document.adsl.autopvcvpi.value, 1);
if ( validateKey(document.adsl.autopvcvpi.value) == 0 ||
(dVPI > 255 || dVPI < 0) ) {
alert("Invalid VPI value! You should set a value between 0-255.");
document.adsl.autopvcvpi.focus();
return false;
}
dVCI = getDigit(document.adsl.autopvcvci.value, 1);
if ( validateKey(document.adsl.autopvcvci.value) == 0 ||
(dVCI > 65535 || dVCI < 32) ) {
alert("Invalid VCI value! You should set a value between 32-65535.");
document.adsl.autopvcvci.focus();
return false;
}
if ( (dVPI == 0 && dVCI == 0) ) {
alert("Invalid VPI/VCI value!");
document.adsl.autopvcvpi.focus();
return false;
}
document.adsl.addVPI.value = dVPI;
document.adsl.addVCI.value = dVCI;
}else {
alert(" You should enable Auto-PVC search first.");
return false;
}
}
function dhcp6cEnable()
{
if(document.adsl.dhcp6mode.value == 2){
document.adsl.iaenable.disabled=true;
document.adsl.pdenable.disabled=true;
document.getElementById('tbdhcpia').style.display="none";
document.getElementById('tbdhcppd').style.display="none";
}else{
{
document.adsl.pdenable.disabled=false;
document.getElementById('tbdhcppd').style.display="";
}
if(document.adsl.dhcp6mode.value == 0){
document.adsl.iaenable.disabled=true;
document.getElementById('tbdhcpia').style.display="none";
}else{
document.adsl.iaenable.disabled=false;
document.getElementById('tbdhcpia').style.display="";
}
}
}
function ianaclick()
{
}
function iapdclick()
{
}
function ipv6Wanchange()
{
if(document.adsl.Ipv6AddrType.value == 1)
document.getElementById('secIPv6Div').style.display="block";
else
document.getElementById('secIPv6Div').style.display="none";
}
function ipv6SettingsDisable()
{
document.getElementById('tbipv6wan').style.display="none";
document.getElementById('secIPv6Div').style.display="none";
document.getElementById('dhcp6c_ctrlblock').style.display="none";
}
function ipv6SettingsEnable()
{
if(document.adsl.IpProtocolType.value != 1){
document.getElementById('tbipv6wan').style.display="block";
ipv6Wanchange();
document.getElementById('dhcp6c_ctrlblock').style.display="block";
dhcp6cEnable();
}
}
function protocolChange()
{
if(document.adsl.IpProtocolType.value == 1){
if( document.adsl.adslConnectionMode.selectedIndex ==1 ||
document.adsl.adslConnectionMode.selectedIndex ==4 ||
document.adsl.adslConnectionMode.selectedIndex ==5)
ipSettingsEnable();
ipv6SettingsDisable();
}else{
if(document.adsl.IpProtocolType.value == 2){
ipSettingsDisable();
}else{
if( document.adsl.adslConnectionMode.selectedIndex ==1 ||
document.adsl.adslConnectionMode.selectedIndex ==4 ||
document.adsl.adslConnectionMode.selectedIndex ==5)
ipSettingsEnable();
}
ipv6SettingsEnable();
}
}
function SubmitDataEnable()
{
if(document.adsl.adslEncap[0].disabled ==true)
document.adsl.adslEncap[0].disabled = false;
if(document.adsl.adslEncap[1].disabled == true)
document.adsl.adslEncap[1].disabled = false;
if(document.adsl.adslConnectionMode.disabled ==true)
document.adsl.adslConnectionMode.disabled=false;
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<BODY>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Internet Setup";
HelpItem="wanif";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Channel Configuration</td>
</tr>
<tr>
<td class="content">
<p> This page is used to configure the parameters for the channel operation modes of your ADSL Modem/Router. Note : When connect type of PPPoE and PPPoA only is "Manual", the "Connect" and "Disconnect" button will be enable.</p>
</td>
</tr>
</table>
<form action="form2DrouteMechanism.cgi" method=POST name="DrouteMethod">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Default Route Selection</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Default Route Selection:</td>
<td class="form_label_right">
<input type="radio" value="1" name="autoDroute" onClick="this.form.submit();">Auto&nbsp;&nbsp;
<input type="radio" value="0" name="autoDroute" onClick="this.form.submit();">Specified
</td>
</tr>
</table>
</td>
</tr>
</table>
<input type="hidden" NAME="submit.htm?wanadsl_auto_droute.htm" value="Send">
</form>
<form action="form2WanAdsl.cgi" method=POST name="adsl" onSubmit="SubmitDataEnable()">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Channel Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr><td>
<b>VPI: </b><input type="text" id="vpi" name="vpi" size="4" maxlength="3" value=0>&nbsp;&nbsp;
<b>VCI: </b><input type="text" id="vci" name="vci" size="6" maxlength="5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</td>
<td>
<b>Encapsulation: </b>
<input type="radio" value="0" name="adslEncap" checked>LLC&nbsp;&nbsp;
<input type="radio" value="1" name="adslEncap">VC-Mux
</td></tr>
<tr>
<td>
<b>Channel Mode:</b></font>
<VWS_SCREEN (char*) xscrnAdslConnectionMode[];>
 </td>
<td>
<b>Enable NAPT: </b></font><input type="checkbox" name="naptEnabled" size="2" maxlength="2" value="ON" onClick="naptClicked()">
<b>Enable IGMP: </b></font><input type="checkbox" name="igmpEnabled" size="2" maxlength="2" value="ON">
</td></tr>
<tr>
<td>
<b>802.1q:</b></font>
<input type="radio" value="0" name="vlan" checked onClick=click1q()>Disable&nbsp;&nbsp;
<input type="radio" value="1" name="vlan" onClick=click1q()>Enable
</td>
<td>
<b>VLAN ID(1-4095):</b></font>
<input type=text name=vlanid size=6 maxlength=4 value=0 disabled>
</td>
</tr>
<b><input type="radio" value=1 name="chEnable" checked style="display:none">&nbsp;&nbsp;
<input type="radio" value=0 name="chEnable" style="display:none">
</b>
</table>
<div id="tbprotocol">
<table class="formarea" border="0" width="500" cellspacing="0" cellpadding="0">
<tr><td colspan=2 width="500"><hr size=2 align=top></td></tr>
</table>
<table lass="formarea" border="0" width="500" cellspacing="0" cellpadding="0">
<tr id="TrIpProtocolType">
<td width="120px"><b>IP Protocol:</b></td>
<td><select id="IpProtocolType" style="WIDTH: 130px" onChange="protocolChange()" name="IpProtocolType">
<option value="0" > Ipv4/Ipv6</option>
<option value="1" > Ipv4</option>
<option value="2" > Ipv6</option>
</select>
</td>
</tr>
</table>
</div>
<table class="formarea" border=0 width="500" cellspacing=4 cellpadding=0>
<tr><td colspan=5><hr size=2 align=top></td></tr>
<tr><td align="left"><b>PPP Settings:</b></td>
<td><b>User Name:</b></td>
<td><input type="text" id="pppUserName" name="pppUserName" size="10" maxlength="256"></td>
<td><b>Password:</b></td>
<td><input type="password" id="pppPassword" name="pppPassword" size="10" maxlength="256"></td>
<input type="hidden" name="pppauth" maxlength="30">
<input type="hidden" name="pppacname" maxlength="30">
<input type="hidden" name="pppservicename" maxlength="30">
</tr>
<tr><td></td>
<td><b>Type:</b></td>
<td><select size="1" name="pppConnectType" onChange="pppTypeSelection()">
<option selected value="0">Continuous</option>
<option value="1">Connect on Demand</option>
<option value="2">Manual</option>
</select>
</td>
<td><b>Idle Time (min):</b></td>
<td><input type="text" name="pppIdleTime" size="10" maxlength="3"></td>
</tr>
<tr><td colspan=5><hr size=2 align=top></td></tr>
<tr><td align="left"><b>WAN IP Settings:</b></td>
<td><b>Type:</b></td>
<td>
<input type="radio" value="0" name="ipMode" checked onClick="ipTypeSelection()">Fixed IP
</td>
<td>
<input type="radio" value="1" name="ipMode" onClick="ipTypeSelection()">DHCP
</td>
</tr>
<tr><td></td>
<td><b>Local IP Address:</b></td>
<td><input type="text" name="ip" size="10" maxlength="15"></td>
<td><b>Remote IP Address:</b></td>
<td><input type="text" name="remoteIp" size="10" maxlength="15"></td>
</tr>
<tr><td></td>
<td><b>Netmask:</b></td>
<td><input type="text" name="netmask" size="10" maxlength="15"></td>
</tr>
<tr>
<td><b>Default Route:</b></td>
<td><input type=radio value=0 name="droute" onClick="remoteipdisable()">Disable</td>
<td><input type=radio value=1 name="droute" checked onClick="remoteipenable()">Enable&nbsp;&nbsp;</td>
<td><input type=radio value=2 name="droute" >Auto</td>
</tr>
<tr>
<td><b>Unnumbered</b></font></td>
<td><input type="checkbox" name="ipUnnum" size="2" maxlength="2" value="ON" onClick="ipUnnumModeSelection()">
</td>
</tr>
</table>
<div id="tbipv6wan">
<table class="formarea" border=0 width="500" cellspacing=4 cellpadding=0>
<tr><td colspan=2 width="500"><hr size=2 align=top></td></tr>
</table>
<table class="formarea" border=0 width="500" cellspacing=4 cellpadding=0>
<tr><td width="120px"><b>IPv6 WAN Setting:</b></td><td></td></tr>
<tr id="TrIpv6AddrType">
<td><b>Address Mode:</b></td>
<td><select id=Ipv6AddrType style="WIDTH: 130px" onChange="ipv6Wanchange()" name=Ipv6AddrType>
<option value="0" > Slaac</option>
<option value="1" > Static</option>
</select>
</td>
</tr>
</table>
</div>
<table id="secIPv6Div" style="display:none" border=0 cellspacing=4 cellpadding=0>
<tr id=TrIpv6Addr>
<td width="120px"><b>IPv6 Address:</b></td>
<td><input id=Ipv6Addr maxLength=39 size=36 name=Ipv6Addr> /
<font size=2><input id=Ipv6PrefixLen maxLength=3 size=3 name=Ipv6PrefixLen> </td>
</tr>
<tr id=TrIpv6Gateway>
<td width="120px"><b>IPv6 Gateway:</b></td>
<td><input id=Ipv6Gateway maxLength=39 size=36 name=Ipv6Gateway></td>
</tr>
</table>
<br>
<div id="dhcp6c_ctrlblock" style="display:block">
<table id="tbdhcpv6" class="formarea" style="display:block" border=0 cellspacing=4 cellpadding=0>
<tr>
<td width="120px"><b>DHCPv6 Mode:</b></td>
<td>
<select name=dhcp6mode onChange="dhcp6cEnable()">
<option value="0" > Auto</option>
<option value="1" > Enable</option>
<option value="2" > Disable</option>
</select>
</td>
</tr>
<tr id = tbdhcpia>
<td width="120px"><b>Request DHCPv6 Address:</b></td>
<td><input type="checkbox" name="iaenable" value="ON" ></td>
</tr>
<tr id = tbdhcppd>
<td width="120px"><b>Request DHCPv6 PD:</b></td>
<td><input type="checkbox" name="pdenable" value="ON" ></td>
</tr>
</table>
</div>
</td>
</tr>
</table>
<BR>
<p>
<input type="submit" value="Connect" name="pppConnect" onClick="return pppConnectClick(0)">
<input type="submit" value="Disconnect" name="pppDisconnect" onClick="return pppConnectClick(1)">
<input type="submit" value="Add" name="add" onClick="return addClick()">
<input type="submit" value="Modify" name="modify" onClick="return modifyCheck()" >
<input type="submit" value="Delete" name="delvc" onClick="return delCheck()">
<input type="reset" value="Undo" name="reset" onClick="resetClicked()">
<input type="button" value="Refresh" onClick="window.location.href='wanadsl_auto_droute.htm'">
<BR>
<BR>
<table id="body_header" border="0" cellspacing="0" style="word-break:break-all">
<tr>
<td class="topheader">Current ATM VC Table:</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="600" style="table-layout:fixed; word-wrap:break-word; overflow:hidden;">
<tr class="form_label_row">
<td class="form_label_col">Select</td>
<td class="form_label_col">Inf</td>
<td class="form_label_col">Mode</td>
<td class="form_label_col">VPI</td>
<td class="form_label_col">VCI</td>
<td class="form_label_col">Encap</td>
<td class="form_label_col">NAPT</td>
<td class="form_label_col">IGMP</td>
<td class="form_label_col">DRoute</td>
<td class="form_label_col">IP Addr</td>
<td class="form_label_col">Remote IP</td>
<td class="form_label_col">NetMask</td>
<td class="form_label_col">User Name</td>
<td class="form_label_col">Unnumber</td>
<td class="form_label_col">Status</td>
<td class="form_label_col">Edit</td>
</tr>
<VWS_FUNCTION (void*)showAdslTable();>
 </table>
</td>
</tr>
</table>
<VWS_FUNCTION (void*)showAutoSearch();>
<script>
clearAll();
<VWS_FUNCTION (void*)autoDrouteState();>
 initConnectMode = document.adsl.adslConnectionMode.selectedIndex;
click1q();
adslConnectionModeSelection();
naptClicked();
document.adsl.droute[2].disabled = true;
if(document.DrouteMethod.autoDroute[0].checked == true)
{
document.adsl.droute[2].checked = true;
}
</script>
<input type="hidden" NAME="submit.htm?wanadsl_auto_droute.htm" value="Send">
</form>
<form action="form2WanAdsl.cgi" method=POST name="actionForm">
<input type="hidden" name="action">
<input type="hidden" name="idx">
<input type="hidden" name="connid">
<input type="hidden" NAME="submit.htm?wanadsl_auto_droute.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@fw-layer7filter.htm@#*&4130
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Software Forbidden</title>
<script>
<VWS_FUNCTION (void*)WebShowLayer7ForbiddenIP();>
function deleteCheck()
{
if(document.formDelLayer7.listnumber.value < 1)
{
alert("List is empty!");
return false;
}
if(document.formDelLayer7.select.length)
{
for(i=0;i<document.formDelLayer7.select.length;i++)
{
if(document.formDelLayer7.select[i].checked)
{return deleteClick();}
}
}else
{
if(document.formDelLayer7.select.checked)
{return deleteClick();}
}
alert("Please select an item as the object to delete from the list !");
return false;
}
function loadcheck()
{
if(document.formDelLayer7.listnumber.value < 1)
{
document.formDelLayer7.deleteSelFilterApp.disabled=true;
document.formDelLayer7.deleteAllFilterApp.disabled=true;
}
}
function checkIpRange(startIp,endIp)
{
if(getDigit(startIp,1)!=getDigit(endIp,1))
return false;
if(getDigit(startIp,2)!=getDigit(endIp,2))
return false;
if(getDigit(startIp,3)!=getDigit(endIp,3))
return false;
if(getDigit(startIp,4)>getDigit(endIp,4))
return false;
return true;
}
function checkIpMode()
{
if(document.getElementsByName("ipmode")[1].checked)
{
enableTextField(document.formAddLayer7.ipstart);
enableTextField(document.formAddLayer7.ipend);
}
else if(document.getElementsByName("ipmode")[0].checked)
{
enableTextField(document.formAddLayer7.ipstart);
disableTextField(document.formAddLayer7.ipend);
}
}
function AddCheck()
{
return true;
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body onLoad="loadcheck();">
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Network Tools";
HelpItem="layer7";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Software Forbidden</td>
</tr>
<tr>
<td class="content">
<p>This page is used to config some softwares to be forbidden.By it ,you can deny the ip packets from the specified software.</p>
</td>
</tr>
</table>
<form action="form2Layer7.cgi" method=POST name="formDelLayer7">
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Current Forbidden Software List</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500">
<tr class="form_label_row">
<td class="form_label_col">Software</td>
<td class="form_label_col">Select</td>
</tr>
<VWS_FUNCTION (void*)AppFilterList();>
 </table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Delete" name="deleteSelFilterApp" onClick="return deleteCheck()">&nbsp;&nbsp;
<input type="submit" value="Delete All" name="deleteAllFilterApp" onClick="return deleteAllClick()">&nbsp;&nbsp;&nbsp;
<input type="hidden" value="Send" name="submit.htm?fw-layer7filter.htm">
</form>
<form action="form2Layer7.cgi" method=POST name="formAddLayer7">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Add Forbidden Software</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Add Forbidden Software:</td>
<td class="form_label_right">
<select size="1" name="appname" >
<option select value="0">--</option>
<option value="1">QQ&QQ Game</option>
<option value="3">Yahoo Messenger</option>
<option value="4">BT related software</option>
<option value="5">Ourgame</option>
<option value="6">GameABC</option>
<option value="7">Chinagames</option>
<option value="8">HF netgames</option>
<option value="9">Mail Delievery</option>
<option value="10">Receiving Mail</option>
</select>
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Add" name="addLayer7" onclick="return AddCheck()">&nbsp;&nbsp;
<input type="hidden" value="Send" name="submit.htm?fw-layer7filter.htm">
</form>
<SCRIPT language="javascript">
</SCRIPT>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@diag-test.htm@#*&2045
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Diagnostic Tests</title>
<script>
var initInf;
function itfSelected()
{
initInf = document.diagtest.wan_if.value;
}
function submitonce(theform)
{
if (document.all||document.getElementById)
{
for (i=0;i<theform.length;i++)
{
var tempobj=theform.elements[i]
if(tempobj.type.toLowerCase()=="submit"||tempobj.type.toLowerCase()=="reset")
tempobj.disabled=true;
}
}
}
</script>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Maintenance";
SideItem="Diagnostics";
//	HelpItem="Device Info";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Diagnostic Test</td>
</tr>
<tr>
<td class=content>
<p>The DSL Router is capable of testing your DSL connection. The individual tests are listed below.
If a test displays a fail status, click "Run Diagnostic Test" button again to make sure the fail status
is consistent.
</p>
</td>
</tr>
</table>
<br>

&&*&&en**&**
<form action="formDiagTest.cgi" method=POST name="diagtest">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Select the Internet Connection</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row>
<td class='form_label_col'>
<select name="wan_if"  onChange="itfSelected()">
<VWS_SCREEN   (char*) ALLWaniflist[];>
 </select>
</td>
<td class='form_label_col'>
<input type=submit value="Run Diagnostic Test" name="start" onSubmit="javascript:submitonce(this)">
</td>
</tr>
</table> 
</td>
</tr>
</table>  
<p>
<VWS_FUNCTION (void *)lanTest() ;>
<p>
<VWS_FUNCTION (void *)wlanTest() ;>
<p>
<VWS_FUNCTION (void *)adslTest(); >
<p>
<VWS_FUNCTION (void *)internetTest(); >
 <br>
<input type="hidden" NAME="submit.htm?diag-test.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@traceroute.htm@#*&3948
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Traceroute</title>
<link href="stylemain.css" rel="stylesheet" type="text/css">
<head>
<script>
function apply()
{
var digit;
digit = getDigit(document.traceroute.numberoftries.value, 1);
if ( validateKey(document.traceroute.numberoftries.value) == 0 ||
(digit > 3 || digit < 1) ) {
alert("Invalid numberoftries value! You should set a value between 1-3.");
document.traceroute.numberoftries.focus();
return false;
}
digit = getDigit(document.traceroute.timeout.value, 1);
if ( validateKey(document.traceroute.timeout.value) == 0 ||
(digit > 65535 || digit < 1) ) {
alert("Invalid timeout value! You should set a value between 1-65535.");
document.traceroute.timeout.focus();
return false;
}
digit = getDigit(document.traceroute.datasize.value, 1);
if ( validateKey(document.traceroute.datasize.value) == 0 ||
(digit > 65535 || digit < 1) ) {
alert("Invalid PCR value! You should set a value between 1-65535.");
document.traceroute.datasize.focus();
return false;
}
digit = getDigit(document.traceroute.dscp.value, 1);
if ( validateKey(document.traceroute.dscp.value) == 0 ||
(digit > 63 || digit < 0) ) {
alert("Invalid dscp value! You should set a value between 0-63.");
document.traceroute.dscp.focus();
return false;
}
digit = getDigit(document.traceroute.maxhopcount.value, 1);
if ( validateKey(document.traceroute.maxhopcount.value) == 0 ||
(digit > 64 || digit < 1) ) {
alert("Invalid maxhopcount value! You should set a value between 1-64.");
document.traceroute.maxhopcount.focus();
return false;
}
return true;
}
</script>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Maintenance";
SideItem="Diagnostics";
//	HelpItem="Device Info";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Traceroute Diagnostic</td>
</tr>
<tr>
<td class=content>
<p>This page is used to traceroute diagnostic.
</p>
</td>
</tr>
</table>
<br>
<form action="form2traceroute.cgi" method=POST name="traceroute" >
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Traceroute</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class='form_label_left' width=20%>
Host
</td>
<td class='form_label_right' align=left>
<input type="text" name="ipaddr" size="30" maxlength="30">           
</td>
</tr>
<tr>
<td class='form_label_left' width=20%>
NumberOfTries
</td>
<td class='form_label_right' align=left>
<input type="text" name="numberoftries" size="1" maxlength="1" value="3">         
</td>
<tr>
<td class='form_label_left' width=20%>
Timeout
</td>
<td class='form_label_right' align=left>
<input type="text" name="timeout" size="5" maxlength="5" value="5000">ms      
</td>
</tr>
<tr>
<td class='form_label_left' width=20%>
Datasize
</td>
<td class='form_label_right' align=left>
<input type="text" name="datasize" size="5" maxlength="5" value="38">Bytes    
</td>
</tr>
<tr>
<td class='form_label_left' width=20%>
DSCP
</td>
<td class='form_label_right' align=left>
<input type="text" name="dscp" size="2" maxlength="2" value="0">   
</td>
</tr>
<tr>
<td class='form_label_left' width=20%>
MaxHopCount
</td>
<td class='form_label_right' align=left>
<input type="text" name="maxhopcount" size="2" maxlength="2" value="30"> 
</td>
</tr>
<tr>
<td class='form_label_left' width=20%>
Interface
</td>
<td class='form_label_right' align=left>
<VWS_SCREEN (char*) scrnTracerouteInterf[];>
 </td>
</tr>
</table> 
</td>
</tr>
</table> 
<br>
<VWS_SCREEN (char*) scrnTracerouteButtons[];>
<INPUT TYPE="hidden" NAME="submit.htm?tracerouterlt.htm" VALUE="Send" >
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@tracerouterlt.htm@#*&1384
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Traceroute</title>
<VWS_SCREEN (char*) xscrnSendTracerouteRefresh[];>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script type='text/javascript'>	
TabHeader="Maintenance";	
SideItem="Diagnostics";	
HelpItem="ping";
</script>
<script type='text/javascript'>	
mainTableStart();	
logo();	
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Traceroute Diagnostic</td>
</tr>
<tr>
<td class="content">
<p>This table shows the result of trace route.</p>
</td>
</tr>
</table>
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Ping Result</td>
</tr>
<tr>
<td class="content" align="left">
<table border=0>
<tr>
<td class="value4">
Traceroute 
<VWS_SCREEN (char*) xscrnShowTracerouteIp[];>
 <br><br>
<VWS_SCREEN (char*) xscrnShowTracerouteTraceIp[];>
 <VWS_SCREEN (char*) xscrnShowTracerouteShowResult1[];>
 <VWS_SCREEN (char*) xscrnShowTracerouteShowResult2[];>
 <form><input type=button value="  back  " OnClick=window.location.replace("traceroute.htm")></form>
</td>
</tr>
</table>
</td>
</tr>
</table>
<script type='text/javascript'>	
mainBodyEnd();	
ThirdRowEnd();	
Footer()	
mainTableEnd()
</script>
</blockquote>
</body></html>

&*#@fw_excludeip.htm@#*&3650
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>NAT EXCLUDE IP</title>
<script>
function checkIpRange(startIp,endIp)
{
if(getDigit(startIp,1)!=getDigit(endIp,1))
return false;
if(getDigit(startIp,2)!=getDigit(endIp,2))
return false;
if(getDigit(startIp,3)!=getDigit(endIp,3))
return false;
if(getDigit(startIp,4)>getDigit(endIp,4))
return false;
return true;
}
function addClick()
{
with(document.formNatExcludeIp)
{
if (lowip.value=="" && highip.value=="" )
return false;
if(!checkIP(lowip)) {
alert("please input a right low Ip address!");
return false;
}
if (highip.value != "")
{
if ( !checkIP(highip)) {
alert("please input a right high Ip address!");
return false;
}
if(!checkIpRange(lowip.value,highip.value))
{
alert("The low Ip address in ip range must be lesser than high Ip address!");
return false;
}
}
}
return true;
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="NAT";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>NAT EXCLUDE IP</td>
</tr>
<tr>
<td class=content>
<p>In the page ,you can config some source ip address which use the purge route mode
when access internet through the specified interface.
</p>
</td>
</tr>
</table>
<br>
<form action="form2excludeip.cgi" method=POST name="formNatExcludeIp">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Config</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class='form_label_left'>
interface
</td>
<td class='form_label_right' align=left>
<SELECT NAME="wanport" WIDTH=30 >
<VWS_SCREEN (char*) xscrnNaptEnableWanRouterPvcWithPPPOE[];>
 </SELECT>
</td>
</tr>
<tr>
<td class='form_label_left' width="20%" align=left>
IP Range
</td>
<td class='form_label_right' align=left>
<INPUT TYPE="TEXT" NAME="lowip" SIZE="15" MAXLENGTH="15" VALUE="" >
-
<INPUT TYPE="TEXT" NAME="highip" SIZE="15" MAXLENGTH="15" VALUE="" >
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Apply Changes" onClick="return addClick()">&nbsp;&nbsp;
<input type="reset" value="Reset" name="reset">&nbsp;&nbsp;
<input type="hidden" name="submit.htm?fw_excludeip.htm" VALUE="Send">
</form>
<br>
<form method=POST Action="form2excludeipdel.cgi">
<INPUT TYPE="HIDDEN" NAME="actiontype" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="natcmd" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="state" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="waninterface" VALUE="" >
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Current NAT Exclude IP Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row >
<td class='form_label_col'>
WAN Interface
</td>
<td class='form_label_col'>
Low IP
</td>
<td class='form_label_col'>
High IP
</td>
<td class='form_label_col'>
Action
</td>
</tr>
<VWS_FUNCTION (void*)showNatExcludeIpTable();>
 </table>
</td>
</tr>
</table>
<INPUT TYPE="HIDDEN" NAME="submit.htm?fw_excludeip.htm" VALUE="Send" >
</form>
<script language="JavaScript">
function natActionFunc( form , actiontype, natcmd, state,waninterface){
form.elements[0].value=actiontype;
form.elements[1].value=natcmd;
form.elements[2].value=state;
form.elements[3].value=waninterface;
form.submit();
}
</script>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wlwps.htm@#*&10050
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Wi-Fi Protected Setup</title>
<style>
.on {display:on}
.off {display:none}
</style>
<script>
var isClient;
var isConfig;
<VWS_SCREEN (char*) webShowWlanWSC_INIT1[];>
 var warn_msg1='WPS was disabled automatically because wireless mode setting could not be supported. ' +
'You need go to Wireless/Basic page to modify settings to enable WPS.';
var warn_msg2='WPS was disabled automatically because Radius Authentication could not be supported. ' +
'You need go to Wireless/Security page to modify settings to enable WPS.';
var warn_msg3="PIN number was generated. You have to click \'Apply Changes\' button to make change effectively.";
var warn_msg4='WPS was disabled automatically because WPS2.0 has some restrictions to enable WPS:<BR>' +
'1. Broadcast SSID must be enabled.(Setting is in Advanced Wireless/Wireless Advanced page)<br>' +
'2. The encryption of security must not be WEP or WPA-TKIP/WPA2-TKIP.(Setting is in Wireless/Security page)<br>' +
'3. If ACL mode is set to "Allow List", the list must not be empty.(Setting is in Advanced Wireless/Access Control page)';
var disable_all=0;
function triggerPBCClicked()
{
return true;
}
function triggerPINClicked()
{
return(saveChangesWPS(document.formWsc));
}
function compute_pin_checksum(val)
{
var accum = 0;
var code = parseInt(val)*10;
accum += 3 * (parseInt(code / 10000000) % 10);
accum += 1 * (parseInt(code / 1000000) % 10);
accum += 3 * (parseInt(code / 100000) % 10);
accum += 1 * (parseInt(code / 10000) % 10);
accum += 3 * (parseInt(code / 1000) % 10);
accum += 1 * (parseInt(code / 100) % 10);
accum += 3 * (parseInt(code / 10) % 10);
accum += 1 * (parseInt(code / 1) % 10);
var digit = (parseInt(accum) % 10);
return ((10 - digit) % 10);
}
function genPinClicked()
{
var num_str="1";
var rand_no;
var num;
while (num_str.length != 7) {
rand_no = Math.random()*1000000000;
num = parseInt(rand_no, 10);
num = num%10000000;
num_str = num.toString();
}
num = num*10 + compute_pin_checksum(num);
num = parseInt(num, 10);
document.formWsc.elements["localPin"].value = num;
alert(warn_msg3);
}
function validate_pin_code(code)
{
var accum=0;
accum += 3 * (parseInt(code / 10000000) % 10);
accum += 1 * (parseInt(code / 1000000) % 10);
accum += 3 * (parseInt(code / 100000) % 10);
accum += 1 * (parseInt(code / 10000) % 10);
accum += 3 * (parseInt(code / 1000) % 10);
accum += 1 * (parseInt(code / 100) % 10);
accum += 3 * (parseInt(code / 10) % 10);
accum += 1 * (parseInt(code / 1) % 10);
return (0 == (accum % 10));
}
function check_pin_code(str)
{
var i;
var code_len;
code_len = str.length;
if (code_len != 8 && code_len != 4)
return 1;
for (i=0; i<code_len; i++) {
if ((str.charAt(i) < '0') || (str.charAt(i) > '9'))
return 2;
}
if (code_len == 8) {
var code = parseInt(str, 10);
if (!validate_pin_code(code))
return 3;
else
return 0;
}
else
return 0;
}
function setPinClicked(form)
{
var ret;
ret = check_pin_code(form.elements["peerPin"].value);
if (ret == 1) {
alert('Invalid Enrollee PIN length! The device PIN is usually four or eight digits long.');
form.peerPin.focus();
return false;
}
else if (ret == 2) {
alert('Invalid Enrollee PIN! Enrollee PIN must be numeric digits.');
form.peerPin.focus();
return false;
}
else if (ret == 3) {
if ( !confirm('Checksum failed! Use PIN anyway? ') ) {
form.peerPin.focus();
return false;
}
}
return true;
}
function checkWPSstate(form)
{
if (disable_all) {
disableCheckBox(form.elements["disableWPS"]);
disableButton(form.elements["save"]);
disableButton(form.elements["reset"]);
}
if (disable_all || form.elements["disableWPS"].checked) {
disableTextField(form.elements["localPin"]);
disableTextField(form.elements["peerPin"]);
disableButton(form.elements["setPIN"]);
disableButton(form.elements["triggerPIN"]);
disableButton(form.elements["triggerPBC"]);
disableButton(form.elements["genPIN"]);
}
else {
enableTextField(form.elements["localPin"]);
enableTextField(form.elements["peerPin"]);
enableButton(form.elements["setPIN"]);
enableButton(form.elements["genPIN"]);
enableButton(form.elements["triggerPIN"]);
enableButton(form.elements["triggerPBC"]);
}
disableRadioGroup(form.elements["config"]);
return true;
}
function saveChangesWPS(form)
{
ret = check_pin_code(form.elements["localPin"].value);
if (ret == 1) {
alert('Invalid PIN length! The device PIN is usually four or eight digits long.');
form.localPin.focus();
return false;
}
else if (ret == 2) {
alert('Invalid PIN! The device PIN must be numeric digits.');
form.localPin.focus();
return false;
}
else if (ret == 3) {
alert('Invalid PIN! Checksum error.');
form.localPin.focus();
return false;
}
return true;
}
function updateState()
{
if (document.formWsc.wlanDisabled.value == "ON") {
disableTextField(document.formWsc.disableWPS);
disableTextField(document.formWsc.localPin);
disableButton(document.formWsc.genPIN);
disableButton(document.formWsc.triggerPBC);
disableButton(document.formWsc.save);
disableButton(document.formWsc.reset);
disableTextField(document.formWsc.peerPin);
disableButton(document.formWsc.setPIN);
}
}
</script>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Advanced Wireless";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<form action=form2Wsc.cgi method=POST name="formWsc">
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Wi-Fi Protected Setup
</td>
</tr>
<tr>
<td class=content>
<p>
This page allows you to change the setting for WPS (Wi-Fi Protected Setup). Using
this feature could let your wireless client automically syncronize its setting and
connect to the Access Point in a minute without any hassle.</p>
</td>
</tr>
</table>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>WIFI PROTECTED SETTINGS
</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width=100%>
<script>
<VWS_SCREEN (char*) webShowWlanWSC_WLANMODE[];>
 if (mode == 0 || mode == 3)
{
disable_all = check_wps_enc(encrypt, enable1x, wpa_auth);
if (disable_all == 0 && isWPSLimit == 1)
disable_all = 4;
}
else
disable_all = check_wps_wlanmode(mode, is_adhoc);
</script>
<tr>
<td align=right><input type="checkbox" name="disableWPS" value="ON"
<VWS_SCREEN (char*) webShowWlanWSC_DISABLED[];>
 ONCLICK="checkWPSstate(document.formWsc)">
</td>
<td class=form_label_enabled>&nbsp;&nbsp;Disable WPS
</td>
</tr>
<input type=hidden name="wlanDisabled"
<VWS_SCREEN (char*) webShowWlanDISABLED[];>
 >
<script>
if (isClient) {
document.write("<span id = \"hide_div\" class = \"off\">\n");
}
</script>
<tr>
<td class=form_label_40>WPS Status:</td>
<td><input type="radio" name="config" value=1
<VWS_SCREEN (char*) webShowWlanWSC_CONF_ON[];>
 >Configured&nbsp;&nbsp;
<input type="radio" name="config" value=0
<VWS_SCREEN (char*) webShowWlanWSC_CONF_OFF[];>
 >UnConfigured
</td>
</tr>
<script>
if (isClient) {
document.write("</span>\n");
}
</script>
<tr>
<td class=form_label_40>Self-PIN Number:</td>
<td>
<input type="text" name="localPin" size="12" maxlength="10"
<VWS_SCREEN (char*) webShowWlanWSC_LOCAL_PIN[];>
 >
&nbsp;&nbsp;
<input type="button" value="Regenerate PIN" name="genPIN" onClick="return genPinClicked()">
</td>
</tr>
<script>
if (!isClient) {
document.write("<span id = \"hide_div\" class = \"off\">\n");
}
</script>
<tr>
<td class=form_label_40>PIN Configuration:</td>
<td>
<input type="submit" value="Start PIN" name="triggerPIN" onClick="return triggerPINClicked()">
</td>
</tr>
<script>
if (!isClient) {
document.write("</span>\n");
}
</script>
<tr>
<td class=form_label_40>Push Button Configuration:</td>
<td>
<input type="submit" value="Start PBC" name="triggerPBC" onClick="return triggerPBCClicked()">
</td>
</tr>
</table>
</td>
</tr>
</table>
<p align=center>
<input type="submit" value="Apply Changes" name="save" onClick="return saveChangesWPS(document.formWsc)">&nbsp;&nbsp;
<input type="reset" value="Reset" name="reset">
</p>
<script>
if (disable_all) {
document.write("<font size=2><em>");
if (disable_all == 1)
document.write(warn_msg1);
else if(disable_all == 2)
document.write(warn_msg2);
else if (disable_all == 4)
document.write(warn_msg4);
}
</script>
<script>
<VWS_SCREEN (char*) webShowWlanWSC_CONFIG[];>
 if (isClient || !isConfig)
document.write("<span id = \"hide_div\" class = \"off\">\n");
</script>
<br><br>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>CURRENT KEY INFO
</td>
</tr>
<tr>
<td class=contet>
<table class=formlisting>
<tr class=form_label_row>
<td class=form_label_col>Authentication</td>
<td class=form_label_col>Encryption</td>
<td class=form_label_col>Key</td>
</tr>
<tr class=form_label_row>
<td class=form_label_col>
<VWS_SCREEN (char*) webShowWlanWSC_AUTH[];>
 </td>
<td class=form_label_col>
<VWS_SCREEN (char*) webShowWlanWSC_ENC[];>
 </td>
<td class=form_label_col>
<VWS_SCREEN (char*) webShowWlanWSC_KEY[];>
 </td>
</tr>
</table>
</td>
</tr>
</table>
<script>
if (isClient || !isConfig) {
document.write("</span>\n");
}
if (isClient)
document.write("<span id = \"hide_div\" class = \"off\">\n");
</script>
<br>
<br>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>CLIENT PIN INFO
</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width=100%>
<tr>
<td class=form_label_40>Client PIN Number:</td>
<td>
<input type="text" name="peerPin" size="12" maxlength="10" value="">
&nbsp;&nbsp;
</td>
</tr>
</table>
</td>
</tr>
</table>
<p align=center>
<input type="submit" value="Start PIN" name="setPIN" onClick="return setPinClicked(document.formWsc)">
</p>
<INPUT TYPE="hidden" NAME="submit.htm?wlwps.htm" VALUE="Send">
<script>
if (isClient)
document.write("</span>\n");
checkWPSstate(document.formWsc);
updateState();
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@autopvc.htm@#*&3513
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<script>
function autopvcapplycheckclick()
{
if(document.autopvc.enableautopvc.checked == true ){
if(!confirm("auto search pvc mode will have only one wan interface,really?")){
document.autopvc.enableautopvc.checked = false;
return false;	
}	
}	
// updatepvcState();	
}
function autopvcprobeClick()
{
if(!confirm(" Wait a minute, probe pvc function spends a moment on searching wan pvc!")){
return false;	
}
}
function autopvcCheckClick()
{
var dVPI,dVCI;
{
//	document.enablepvc.value = 1;  	
dVPI = getDigit(document.autopvc.autopvcvpi.value, 1);
if ( validateKey(document.autopvc.autopvcvpi.value) == 0 ||
(dVPI > 255 || dVPI < 0) ) {
alert("Invalid VPI value! You should set a value between 0-255.");
document.autopvc.autopvcvpi.focus();
return false;
}
dVCI = getDigit(document.autopvc.autopvcvci.value, 1);
if ( validateKey(document.autopvc.autopvcvci.value) == 0 ||
(dVCI > 65535 || dVCI < 32) ) {
alert("Invalid VCI value! You should set a value between 32-65535.");
document.autopvc.autopvcvci.focus();
return false;
}
if ( (dVPI == 0 && dVCI == 0) ) {
alert("Invalid VPI/VCI value!");
document.autopvc.autopvcvpi.focus();
return false;
}
//	document.addVPI.value = dVPI;
//	document.addVCI.value = dVCI;
}
}
</script>
</head>
<link href="stylemain.css" rel="stylesheet" type="text/css">
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Internet Setup";
HelpItem="autopvc";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Auto PVC Configuration</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configure pvc auto detect function. Here you can add/delete auto pvc search table.</p>
</td>
</tr>
</table>
<form action="form2autopvc.cgi" method=POST name="autopvc">
<VWS_FUNCTION (void*)showAutoSearchModeEnable();>
 <table>
<tr>
<td width="70%" colspan=2><font size=2><b>Probe WAN PVC</td>
<td width="30%" colspan=2><font size=2><b>
<input type="submit" name="autopvcprobe" value= "Probe" onClick="return autopvcprobeClick()">
</td>     
</tr>
</table>
<VWS_FUNCTION (void*)showProbePvcFunction();>
<br>
<table>
<tr>
<td><font size=2><b>VPI: </b></font>
<input type="text" name="autopvcvpi" size="4" maxlength="3" value = "">&nbsp;&nbsp;
</td>
<td><font size=2><b>VCI: </b></font>
<input type="text" name="autopvcvci" size="6" maxlength="5" value = "">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</td>	
<td>
<input type="submit" value="Add" name="autopvcadd" onClick="return autopvcCheckClick()">
</td>        
<td>
<input type="submit" value="Delete" name="autopvcdel" onClick="return autopvcCheckClick()">
</td>      
</tr>
</table>
<br>  
<table id="body_header" border="0" cellspacing="0">
<tbody>
<tr>
<td class="topheader">Current Auto-PVC Table</td>
</tr>
<tr>
<td class="content">
<table class="formlisting" border="0">
<tbody>
<tr class="form_label_row">
<td class="form_label_col" width="30%">PVC</td>
<td class="form_label_col" width="35%">VPI</td>
<td class="form_label_col" width="35%">VCI</td>
</tr>
<VWS_FUNCTION (void*)showAutoSearchPvcTable();>
 </tbody>
</table>
</td>
</tr>
</tbody>
</table>
<input type="hidden" NAME="submit.htm?autopvc.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@dhcpip.htm@#*&5337
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>LAN Interface Setup </title>
<SCRIPT>
function resetClick()
{
document.dhcpip.reset;
}
function dhcpIptable(ip1, ip2, ip3, ip4, mac)
{
this.ip1 = ip1;
this.ip2 = ip2;
this.ip3 = ip3;
this.ip4 = ip4;
//this.mac=mac;
this.mac = mac.replace(/:/g,"");
}
function checkPoolIP(ipaddr,macaddr)
{
var DhcpIpTables=new Array();
<VWS_FUNCTION (void*)CreateDhcpStaticIPArray();>;
 if (getDigit(ipaddr.value, 1) != lanip1) {
alert("The Ip address should be in the range of DHCP ip pool!");
ipaddr.focus();
return false;
}
if (getDigit(ipaddr.value, 2) != lanip2) {
alert("The Ip address should be in the range of DHCP ip pool!");
ipaddr.focus();
return false;
}
if (getDigit(ipaddr.value, 3) != lanip3) {
alert("The Ip address should be in the range of DHCP ip pool!");
ipaddr.focus();
return false;
}
if (!checkDigitRange(ipaddr.value, 4, startip, endip)) {
alert("The Ip address should be in the range of DHCP ip pool!");
ipaddr.focus();
return false;
}
for(var i=0; i<DhcpIpTables.length; i++) {
if (DhcpIpTables[i].ip4 == getDigit(ipaddr.value, 4)) {
alert("The Ip address has been occupied!");
ipaddr.focus();
return false;
}	
if (DhcpIpTables[i].mac == macaddr.value) {
alert("The mac address has bound another ip address!");
macaddr.focus();
return false;
}	
}
return true;
}
function saveChanges()
{
if (!checkIP(document.dhcpip.ipaddr)) {
return false;
}
if (!checkMacWithoutColon(document.dhcpip.macaddr, 1)) {
alert("Invalid mac address!please input one valid unicast mac address!");
return false;
}
if (!checkPoolIP(document.dhcpip.ipaddr,document.dhcpip.macaddr)) {
return false;
}
return true;
}
//sherbet_lu 20120820 start: add modify selected dhcp reserved entry
function modifyClick()
{
var DhcpIpTables=new Array();
<VWS_FUNCTION (void*)CreateDhcpStaticIPArray();>;
 if (!checkIP(document.dhcpip.ipaddr)) 
{
return false;
}
if (!checkMacWithoutColon(document.dhcpip.macaddr, 1)) 
{
alert("Invalid mac address!please input one valid unicast mac address!");
return false;
}
if (getDigit(document.dhcpip.ipaddr.value, 1) != lanip1) 
{
alert("The Ip address should be in the range of DHCP ip pool!");
document.dhcpip.ipaddr.focus();
return false;
}
if (getDigit(document.dhcpip.ipaddr.value, 2) != lanip2) 
{
alert("The Ip address should be in the range of DHCP ip pool!");
document.dhcpip.ipaddr.focus();
return false;
}
if (getDigit(document.dhcpip.ipaddr.value, 3) != lanip3) 
{
alert("The Ip address should be in the range of DHCP ip pool!");
document.dhcpip.ipaddr.focus();
return false;
}
if (!checkDigitRange(document.dhcpip.ipaddr.value, 4, startip, endip)) 
{
alert("The Ip address should be in the range of DHCP ip pool!");
document.dhcpip.ipaddr.focus();
return false;
}
return true;
}
//sherbet_lu 20120820 end
function postDhcpIp(ipaddr, macaddr)
{
document.dhcpip.ipaddr.value = ipaddr;
document.dhcpip.macaddr.value = macaddr.replace(/:/g,"");
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Local Network";
//	HelpItem="deviceinfo";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">DHCP Static IP Configuration</td>
</tr>
<tr>
<td class="content">
<p>  
This page lists the fixed IP/MAC address on your LAN. The device distributes the number configured to hosts on your network as they request Internet access.
</p>
</td>
</tr>
</table>
<form action="form2Dhcpip.cgi" method=POST name="dhcpip">
<table id="body_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">DHCP Static IP Settings</td>
</tr>
<tr>
<td class="content" align="left">
<table class=formarea border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">IP Address:</td>
<td class="form_label_right"><input type="text" name="ipaddr" size="15" maxlength="15" value="0.0.0.0"></td>
</tr>
<tr>
<td class="form_label_left">Mac Address:</td>
<td class="form_label_right"><input type="text" name="macaddr" size="17" maxlength="17" value="000000000000">(ex. 00E086710502)</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<p>
<input type="submit" value="Add" onClick="return saveChanges()">&nbsp;&nbsp;
<input type="submit" value="Modify" name="modify" onClick="return modifyClick()">&nbsp;&nbsp;
<input type="submit" value="Delete Selected" name="delete">&nbsp;&nbsp;
<input type="reset" value="Undo" name="reset" onClick="resetClick()">
<br><br>
<p>
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">DHCP Static IP Table:</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500">
<tr class="form_label_row">
<td class="form_label_col">Select</td>
<td class="form_label_col">IP Address</td>
<td class="form_label_col">MAC Address</td>
</tr>
<tr class="form_label_row">
</tr>
<VWS_FUNCTION (void*)showDhcpStaticIPTable();>
 </table>
</td>
</tr>
</table>
<br>
<input type="hidden" NAME="submit.htm?dhcpip.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@dhcpd.htm@#*&11384
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>DHCP Server Setup </title>
<SCRIPT>
var initialDhcp;
function openWindow(url, windowName) {
var wide=600;
var high=400;
if (document.all)
var xMax = screen.width, yMax = screen.height;
else if (document.layers)
var xMax = window.outerWidth, yMax = window.outerHeight;
else
var xMax = 640, yMax=480;
var xOffset = (xMax - wide)/2;
var yOffset = (yMax - high)/3;
var settings = 'width='+wide+',height='+high+',screenX='+xOffset+',screenY='+yOffset+',top='+yOffset+',left='+xOffset+', resizable=yes, toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes';
window.open( url, windowName, settings );
}
function dhcpdEnabled()
{
document.getElementById('dhcpserver_block').style.display = 'block';
if(document.dhcpd.setVendor)
enableButton( document.dhcpd.setVendor);
if(document.dhcpd.setOpt60)
enableButton( document.dhcpd.setOpt60);
}
function dhcpdDisabled()
{
document.getElementById('dhcpserver_block').style.display = 'none';
if(document.dhcpd.setVendor)
disableButton( document.dhcpd.setVendor);
if(document.dhcpd.setOpt60)
disableButton( document.dhcpd.setOpt60);
}
function dhcpdRelayEnabled()
{
document.getElementById('dhcprelay_block').style.display = 'block';
if(document.dhcpd.setVendor)
disableButton( document.dhcpd.setVendor);
if(document.dhcpd.setOpt60)
disableButton( document.dhcpd.setOpt60);
}
function dhcpdRelayDisabled()
{
document.getElementById('dhcprelay_block').style.display = 'none';
}
function resetClick()
{
if (initDhcpDisable==0)
{
dhcpdDisabled();
dhcpdRelayDisabled();
}
else if(initDhcpDisable==1){
dhcpdRelayEnabled();
dhcpdDisabled();
}
else{
dhcpdEnabled();
dhcpdRelayDisabled();
}
}
function checkSubnet(ip, mask, client)
{
ip_d = getDigit(ip, 4);
mask_d = getDigit(mask, 4);
if ( (ip_d & mask_d) != (client & mask_d ) )
return false;
return true;
}
function checkiflanipinpool(lanip, start, end)
{
if(checkNetwork(start, lanip) && checkNetwork(lanip, end)) {
return true;
}
return false;
}
function saveChanges()
{
if ( document.dhcpd.dhcpmode.value==2) {
if (document.dhcpd.dhcpRangeStart.value=="") {
alert("Please input DHCP IP pool range.");
document.dhcpd.dhcpRangeStart.value = document.dhcpd.dhcpRangeStart.defaultValue;
document.dhcpd.dhcpRangeStart.focus();
return false;
}
if (!checkIP( document.dhcpd.dhcpRangeStart)) {
document.dhcpd.dhcpRangeStart.focus();
return false;
}
if (document.dhcpd.dhcpRangeEnd.value=="") {
alert("Please input DHCP IP pool range.");
document.dhcpd.dhcpRangeEnd.value = document.dhcpd.dhcpRangeEnd.defaultValue;
document.dhcpd.dhcpRangeEnd.focus();
return false;
}
if (!checkIP( document.dhcpd.dhcpRangeEnd)) {
document.dhcpd.dhcpRangeEnd.focus();
return false;
}
if(!checkNetworkByMask(document.dhcpd.dhcpRangeStart.value, document.dhcpd.lan_ip.value, document.dhcpd.lan_mask.value)){
alert("Starting address should be in the same network with lan IP address.");
document.dhcpd.dhcpRangeStart.focus();
return false;
}
if(!checkNetworkByMask(document.dhcpd.dhcpRangeEnd.value, document.dhcpd.lan_ip.value, document.dhcpd.lan_mask.value)){
alert("Starting address should be in the same network with lan IP address.");
document.dhcpd.dhcpRangeStart.focus();
return false;
}
if(!checkNetwork(document.dhcpd.dhcpRangeStart.value, document.dhcpd.dhcpRangeEnd.value)) {
alert("Starting address should be in the same network with ending address.");
document.dhcpd.dhcpRangeStart.focus();
return false;
}
if(checkiflanipinpool(document.dhcpd.lan_ip.value, document.dhcpd.dhcpRangeStart.value, document.dhcpd.dhcpRangeEnd.value)) {
document.getElementById("localipinpool").style.display = 'block';
}
else
document.getElementById("localipinpool").style.display = 'none';

&&*&&en**&**
if (!checkMaskSpecial(document.dhcpd.dhcpSubnetMask))
return false;
if (document.dhcpd.dfgw.value=="") {
alert("Please input DHCP IP pool default gateway.");
document.dhcpd.dfgw.focus();
return false;
}
if (!checkIP( document.dhcpd.dfgw)) {
document.dhcpd.dfgw.focus();
return false;
}
if ( document.dhcpd.ltime.value == 0 ) {
alert('Invalid DHCP lease time. It should not be 0.');
document.dhcpd.ltime.focus();
return false;
}
if ( validateKey( document.dhcpd.ltime.value ) == 0 ) {
alert('Invalid DHCP lease time. It should be the decimal number (0-9).');
document.dhcpd.ltime.focus();
return false;
}
var maxleasetime=365*24*60;
if ( !checkDigitRange(document.dhcpd.ltime.value,1,1,maxleasetime) ) {
alert('Invalid DHCP lease time. It should be 1-'+maxleasetime+'.');
document.dhcpd.ltime.value = document.dhcpd.ltime.defaultValue;
document.dhcpd.ltime.focus();
return false;
}
if(checkIP(document.dhcpd.dns1) == false){
document.dhcpd.dns1.focus();
return false;
}
if(!checkSpecialChar(document.dhcpd.dname.value,1))
{
alert("Invalid characters!");
document.dhcpd.dname.focus();
return false;
}
if( (document.dhcpd.dns2.value != '') && checkIP(document.dhcpd.dns2) == false){
document.dhcpd.dns2.focus();
return false;
}
if( (document.dhcpd.dns3.value != '') && checkIP(document.dhcpd.dns3) == false){
document.dhcpd.dns3.focus();
return false;
}
}
if ( document.dhcpd.dhcpmode.value==1)
{
if(!checkIP(document.dhcpd.relayaddr))
{
return false;
}
}
return true;
}
function dhcpTblClick(url) {
if ( document.dhcpd.dhcpmode.value==2 ) {
openWindow(url, 'DHCPTbl' );
}
}
function dhcpRtTblClick(url) {
if ( document.dhcpd.dhcpmode.value==2 ) {
openWindow(url, 'DHCPRtTbl' );
}
}
function dhcpVendorTblClick(url) {
if ( document.dhcpd.dhcpmode.value==2 ) {
openWindow(url, 'DHCPVendorClassTbl' );
}
}
function dhcpInterfaceTblClick(url) {
if ( document.dhcpd.dhcpmode.value==2 ) {
openWindow(url, 'DHCPInterfaceTbl' );
}
}
function dhcpCUCOpt60TblClick(url) {
if ( document.dhcpd.dhcpmode.value==2 ) {
openWindow(url, 'DHCPCUCOpt60Tbl' );
}
}
function ShowIP(ipVal) {
document.write(getDigit(ipVal,1));
document.write('.');
document.write(getDigit(ipVal,2));
document.write('.');
document.write(getDigit(ipVal,3));
document.write('.');
}
function dhcpmodechang(){
if (document.dhcpd.dhcpmode.value==0)
{
dhcpdDisabled();
dhcpdRelayDisabled();
}
else if(document.dhcpd.dhcpmode.value==1)
{
dhcpdRelayEnabled();
dhcpdDisabled();
}else{
dhcpdRelayDisabled();
dhcpdEnabled();
}
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Local Network";
HelpItem="dhcp_server";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">DHCP Server Setting</td>
</tr>
<tr>
<td class="content">
<p>
This page can be used to config the DHCP mode:None,DHCP Relay or DHCP Server.<br>
(1)Enable the DHCP Server if you are using this device as a DHCP server. This page lists the
IP address pools available to hosts on your LAN. The device distributes numbers in the
pool to hosts on your network as they request Internet access.<br>
(2)Enable the DHCP Relay if you are using the other DHCP server to assign IP address to your hosts
on the LAN. You can set the DHCP server ip address.<br>
(3)If you choose "None", then the modem will do nothing when the hosts request a IP address.
</p>
</td>
</tr>
</table>
<form action="form2Dhcpd.cgi" method=POST name="dhcpd">
<input type="hidden" name="lan_ip" value=
<VWS_SCREEN (char*) xscrnLanIPAddr[];>
>
<input type="hidden" name="lan_mask" value=
<VWS_SCREEN (char*) xscrnLanSubnetMask[];>
>
<table id="body_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">DHCP Server Settings</td>
</tr>
<tr>
<td class="content" align="left">
<table class=formarea border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">LAN IP:</td>
<td class="form_label_right"><script>document.write(document.dhcpd.lan_ip.value);</script>/<script>document.write(document.dhcpd.lan_mask.value);</script></td>
</tr>
<tr>
<td class="form_label_left">DHCP Mode:</td>
<td class="form_label_right">
<select size="1" name="dhcpmode" onChange="dhcpmodechang()">
<VWS_SCREEN (char*) xscrnDhcpdMode[];>
 </select>
</td>
</tr>
</table>
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500" id="dhcpserver_block" style="display:block">
<VWS_FUNCTION (void*)showDhcpdInterfaceList();>
 <tr>
<td class="form_label_left">IP Pool Range:</td>
<td class="form_label_right">
<input type="text" name="dhcpRangeStart" size=20 maxlength=15 value="
<VWS_SCREEN (char*) xscrnDhcpdHostStartIp[];>
"><font face="Arial" size="5">- </font>
<input type="text" name="dhcpRangeEnd" size=20 maxlength=15 value="
<VWS_SCREEN (char*) xscrnDhcpdHostEndIp[];>
">&nbsp;
<input type="button" value="Show Client" name="dhcpClientTbl" onClick="dhcpTblClick('/dhcptbl.htm')" >
</td>
</tr>
<tr id="localipinpool" style="display:none">
<th class="form_label_left"><script>document.write(document.dhcpd.lan_ip.value);</script> is reserved!</th>
<th class="form_label_right">&nbsp;</th>
</tr>
<script>
if(checkiflanipinpool(document.dhcpd.lan_ip.value, document.dhcpd.dhcpRangeStart.value, document.dhcpd.dhcpRangeEnd.value)) {
document.getElementById("localipinpool").style.display = 'block';
}
else
document.getElementById("localipinpool").style.display = 'none';
</script>
<VWS_SCREEN (char*) xscrnDhcpdSubnetMask[];>
<VWS_SCREEN (char*) xscrnDhcpdDefaultGateway[];>
 <tr>
<td class="form_label_left">Max Lease Time:</td>
<td class="form_label_right">
<input type="text" name="ltime" size=10 maxlength=9 value="
<VWS_SCREEN (char*) xscrnDhcpdLease[];>
"><b>
<VWS_SCREEN (char*) xscrnDhcpdLeaseUnit[];>
</b>
</td>
</tr>
<tr>
<td class="form_label_left">Domain Name:</td>
<td class="form_label_right">
<input type="text" name="dname" size=22 maxlength=19 value="
<VWS_SCREEN (char*) xscrnDhcpdDomain[];>
">
</td>
</tr>
<tr>
<td class="form_label_left">DNS Servers:</td>
<td class="form_label_right">
<input type="text" name="dns1" size=22 maxlength=19 value="
<VWS_SCREEN (char*) xscrnDhcpddns1[];>
">
</td>
</tr>
<tr>
<td class="form_label_left"></td>
<td class="form_label_right">
<input type="text" name="dns2" size=22 maxlength=19 value="
<VWS_SCREEN (char*) xscrnDhcpddns2[];>
">
</td>
</tr>
<tr>
<td class="form_label_left"></td>
<td class="form_label_right">
<input type="text" name="dns3" size=22 maxlength=19 value="
<VWS_SCREEN (char*) xscrnDhcpddns3[];>
">
</td>
</tr>
</table>
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500" id="dhcprelay_block" style="display:block">
<tr>
<td class="form_label_left">Relay Server:</td>
<td class="form_label_right">
<input type="text" name="relayaddr" size=15 maxlength=15 value="
<VWS_SCREEN (char*) xscrnDhcpdRelayip[];>
">
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<INPUT TYPE="hidden" NAME="submit.htm?dhcpd.htm" VALUE="Send">
<input type="submit" value="Apply Changes" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
<input type="reset" value="Undo" name="reset" onClick="resetClick()">
<VWS_SCREEN (char*) xscrnDhcpdStaticRtButton[];>
 <VWS_SCREEN (char*) xscrnDhcpdVendorClassButton[];>
 <VWS_SCREEN (char*) xscrnDhcpdCUCOpt60Button[];>
 <SCRIPT>
initDhcpDisable = document.dhcpd.dhcpmode.value;
resetClick();
</SCRIPT>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@userconfig.htm@#*&6890
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>User Account configuration</title>
<SCRIPT>
selected=0;
var includeDigit=0;
var includeChar=0;
function includeSpace(str)
{
for (var i=0; i<str.length; i++) {
if ( str.charAt(i) == ' ' ) {
return true;
}
}
return false;
}
function includeSpecialKey(str)
{
for (var i=0; i<str.length; i++) {
if (( str.charAt(i)== ' ' ) || ( str.charAt(i)== '%' )
|| ( str.charAt(i)== '?' )
||( str.charAt(i)== '&' ) ||( str.charAt(i)== '"' )) {
return true;
}
}
return false;
}
function saveChanges()
{
if (document.userconfig.username.value.length > 0 &&
document.userconfig.newpass.value.length == 0) {
alert('Password cannot be empty. Please try it again.');
document.userconfig.newpass.focus();
return false;
}
if (document.userconfig.newpass.value != document.userconfig.confpass.value) {
alert('Password is not matched. Please type the same password between \'new\' and \'confirmed\' box.');
document.userconfig.newpass.focus();
return false;
}
if (includeSpecialKey(document.userconfig.username.value)) {
alert('Invalid username,Please try it again.');
document.userconfig.username.focus();
return false;
}
if(!checkSpecialChar(document.userconfig.username.value,1))
{
alert("Invalid characters in user name!");
document.userconfig.username.focus();
return false;
}
if (document.userconfig.newpass.value.length <5)
{
alert('Password should be at least 5 characters. Please try it again.');
document.userconfig.newpass.focus();
return false;
}
if (includeSpecialKey(document.userconfig.newpass.value)) {
alert('Invalid password,Please try it again.');
document.userconfig.newpass.focus();
return false;
}
if(!checkSpecialChar(document.userconfig.newpass.value,1))
{
alert("Invalid characters in password!");
document.userconfig.newpass.focus();
return false;
}
var str = document.userconfig.idletime.value;
if(str != "")
{
if(str.length > 2)
{
alert("Invalid idle time value!");
document.userconfig.idletime.focus();
return false;
}
else if(str.length == 1 && (str.charAt(0) < '1' ||str.charAt(0) >'9'))
{
alert("Invalid idle time value!");
document.userconfig.idletime.focus();
return false;
}
else if(str.length == 2)
{
if(str.charAt(0) == '6' && str.charAt(1) == '0')
{
return true;
}
else if(str.charAt(0) <'0' ||str.charAt(0) > '5')
{
alert("Invalid idle time value!");
document.userconfig.idletime.focus();
return false;
}
else if(str.charAt(1) <'0' ||str.charAt(1) > '9')
{
alert("Invalid idle time value!");
document.userconfig.idletime.focus();
return false;
}
}
}
else
return false;
return true;
}
function modifyClick()
{
if (!selected) {
alert("Please select an entry to modify!");
return false;
}
return saveChanges();
}
function delClick()
{
if(!selected)
{
alert("Please select an entry to delete!");
return false;
}
if(document.userconfig.username.value == "admin")
{
alert("Can't delete admin!");
return false;
}
if(document.userconfig.username.value == "user")
{
alert("Can't delete user!");
return false;
}
return true;
}
function postEntry(user, priv, pass, time)
{
document.userconfig.privilege.value = priv;
if (user == "admin" || user == "user")
document.userconfig.privilege.disabled = true;
else
document.userconfig.privilege.disabled = false;
document.userconfig.oldpass.disabled = false;
document.userconfig.username.value = user;
document.userconfig.hiddenpass.value = pass;
document.userconfig.idletime.value = time;
selected = 1;
}
function disablePriv()
{
document.userconfig.privilege.value = 0;
document.userconfig.privilege.disabled = true;
}
function resetConfig()
{
document.userconfig.privilege.value = 0;
document.userconfig.privilege.disabled = false;
document.userconfig.oldpass.disabled = true;
}
function checkAction()
{
if (!selected)
document.userconfig.oldpass.disabled = true;
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<BODY>
<blockquote>
<script language="JavaScript">
TabHeader="Maintenance";
SideItem="Password";
HelpItem="password";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>User Account Configuration</td>
</tr>
<tr>
<td class=content>
<p>This page is used to add user account to access the web server of ADSL Router.
Empty user name or password is not allowed.
</p>
</td>
</tr>
</table>
<br>
<form action="form2userconfig.cgi" method=POST name="userconfig">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class='form_label_left' width="20%">
User Name:
</td>
<td class='form_label_right'>
<input type="text" name="username" size="20" maxlength="29">
</td>
</tr>
<tr>
<td class='form_label_left' width="20%">
Privilege:
</td>
<td class='form_label_right'>
<select size="1" name="privilege">
<VWS_FUNCTION (void*)showPrivilegeTable(); >
 </select>
</td>
</tr>
<tr>
<td class='form_label_left' width="20%">
Old Password:
</td>
<td class='form_label_right'>
<input type="password" name="oldpass" size="20" maxlength="29">
</td>
</tr>
<tr>
<td class='form_label_left' width="20%">
New Password:
</td>
<td class='form_label_right'>
<input type="password" name="newpass" size="20" maxlength="29">
</td>
</tr>
<tr>
<td class='form_label_left' width="20%">
Confirm Password:
</td>
<td class='form_label_right'>
<input type="password" name="confpass" size="20" maxlength="29">
</td>
</tr>
<tr>
<td class='form_label_left' width="20%">
Idle logout time:
</td>
<td class='form_label_right'>
<input type="text" name="idletime" size="20" maxlength="29">&nbsp;(1-60min)
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Add" name="adduser" onClick="return saveChanges()">
<input type="submit" value="Modify" name="modify" onClick="return modifyClick()">
<input type="submit" value="Delete" name="deluser" onClick="return delClick()">
<input type="reset" value="Reset" name="reset" onClick="resetConfig()">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>User Account Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row>
<td class='form_label_col' width="20%">
Select
</td>
<td class='form_label_col' width="30%">
User Name
</td>
<td class='form_label_col' width="30%">
Privilege
</td>
<td class='form_label_col' width="20%">
Idle Time
</td>
</tr>
<VWS_FUNCTION (void*)showUserTable(); >
 </table>
</td>
</tr>
</table>
<input type="hidden" name="hiddenpass">
<input type="hidden" NAME="submit.htm?userconfig.htm" VALUE="Send">
<script>
checkAction();
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
<blockquote>
</body>
</html>

&*#@dhcpvendortbl.htm@#*&5172
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Vendor IP Range Set </title>
<SCRIPT>
var pool_ipprefix;
function postsetting(devname, startip, endip, gwip, option)
{
document.ipRange.name.value = devname;
document.ipRange.sIp.value = startip;
document.ipRange.dIp.value = endip;
document.ipRange.gwIp.value = gwip;
while(1) {
var option=option.replace("+"," ");
for (var i=0; i<option.length; i++) {
if (option.charAt(i) == "+")
break;
}
if (i >= option.length)
break;
}
document.ipRange.Opt60.value = option;
}
function checkInputIP(client)
{
var pool_ip, mask,ipstart,ipend;
var i, mask_d, ip_d, pool_d,ipstart_d,ipend_d;
var pool_ip_d, client_d;
pool_ip = document.ipRange.lan_ip.value;
mask = document.ipRange.lan_mask.value;
ipstart = document.ipRange.lan_dhcpRangeStart.value;
ipend = document.ipRange.lan_dhcpRangeEnd.value;
for (i=1; i<5; i++) {
mask_d = getDigit(mask, i);
pool_ip_d = getDigit(pool_ip, i);
client_d = getDigit(client, i);
ipstart_d = getDigit(ipstart, i);
ipend_d = getDigit(ipend, i);
if ((pool_ip_d & mask_d) != (client_d & mask_d)) {
return false;
}
}
if ((ipstart_d > client_d) || (ipend_d < client_d)) {
return false;
}
return true;
}
function addClick() 
{
if (document.ipRange.name.value=="") {
alert("device name cannot be NULL!");
document.ipRange.name.focus();
return false;
}
if (!checkIP(document.ipRange.sIp)) {
document.ipRange.sIp.focus();
return false;
}
if (!checkIP(document.ipRange.dIp)) {
document.ipRange.dIp.focus();
return false;
}
if (document.ipRange.Opt60.value=="") {
alert("option60 cannot be NULL!");
document.ipRange.Opt60.focus();
return false;
}
if (!checkInputIP(document.ipRange.sIp.value)) {
alert('Invalid Source range of IP Address. It should be in IP pool range.');
document.ipRange.sIp.focus();
return false;
}
if (!checkInputIP(document.ipRange.dIp.value)) {
alert('Invalid Destination range of IP Address. It should be in IP pool range.');
document.ipRange.dIp.focus();
return false;
}
return true;
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<div id="maincontent" style="width: 500px;">
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Device IP Range Set</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configure the IP address range based on device type.</p>
</td>
</tr>
</table>
<form action="formIpRange.cgi" method=POST name="ipRange">
<input type="hidden" name="lan_ip" value=
<VWS_SCREEN (char*) xscrnLanIPAddr[];>
>
<input type="hidden" name="lan_mask" value=
<VWS_SCREEN (char*) xscrnLanSubnetMask[];>
>
<input type="hidden" name="lan_dhcpRangeStart" value=
<VWS_SCREEN (char*) xscrnDhcpdHostStartIp[];>
>
<input type="hidden" name="lan_dhcpRangeEnd" value=
<VWS_SCREEN (char*) xscrnDhcpdHostEndIp[];>
>
<input type="hidden" name="lan_dhcpSubnetMask" value=
<VWS_SCREEN (char*) xscrnLanSubnetMask[];>
>
<input type="hidden" name="ltime" value=
<VWS_SCREEN (char*) xscrnDhcpdLease[];>
>
<input type="hidden" name="dname" value=
<VWS_SCREEN (char*) xscrnDhcpdDomain[];>
>
<input type="hidden" name="dhcpdSubnetMask60" value=
<VWS_SCREEN (char*) xscrnDhcpdSubnetMask60[];>
>
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Device IP Range Setup</td>
</tr>
<tr>
<td class="content" align="left">
<table class=formarea border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="form_label_left">device name:&nbsp;&nbsp;</td>
<td class="form_label_right"><input type="text" name="name" size="20" maxlength="20"></td>
</tr>
<tr>
<td class="form_label_left">start address:&nbsp;&nbsp;</td>
<td class="form_label_right"><input type="text" name="sIp" size="20" maxlength="15"></td>
</tr>
<tr>
<td class="form_label_left">end address:&nbsp;&nbsp;</td>
<td class="form_label_right"><input type="text" name="dIp" size="20" maxlength="15"></td>
</tr>
<VWS_SCREEN (char*) xscrnDhcpdSPDefaultGateway[];>
 <tr>
<td class="form_label_left">option60:&nbsp;&nbsp;</td>
<td class="form_label_right"><input type="text" name="Opt60" size="20" maxlength="20"></td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<p>
<input type="submit" value="add" name="add" onClick="return addClick()">&nbsp;&nbsp;
<input type="submit" value="delete" name="del">&nbsp;&nbsp;
<input type="submit" value="modify" name="mod" onClick="return addClick()">&nbsp;&nbsp
<input type="button" value=" Close " name="close" onClick="javascript: window.close();">
<p>
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">IP Range Table:</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500">
<tr class="form_label_row">
<td class="form_label_col">Select</td>
<td class="form_label_col">device name</td>
<td class="form_label_col">start address</td>
<td class="form_label_col">end address</td>
<td class="form_label_col">default gateway</td>
<td class="form_label_col">option60</td>
</tr>
<VWS_FUNCTION (void*)showVendorClassTable();>
 </table>
</td>
</tr>
</table>
<INPUT TYPE="hidden" NAME="submit.htm?dhcpvendortbl.htm" VALUE="Send">
</form>
</div>
</blockquote>
</body>
</html>

&*#@snmp.htm@#*&5835
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>SNMP Protocol Configuration</title>
<SCRIPT>
function checkTextStr(str)
{
for (var i=0; i<str.length; i++)
{
if ( str.charAt(i) == '%' || str.charAt(i) =='&' ||str.charAt(i) =='\\' || str.charAt(i) =='?' || str.charAt(i)=='"')
return false;
}
return true;
}
function saveChanges()
{
if(document.snmpTable.snmpEnabled.checked == false)
{
return true;
}
if (document.snmpTable.snmpTrapIpAddr.value=="") {
return true;
}
if ( validateKey( document.snmpTable.snmpTrapIpAddr.value ) == 0 ) {
alert("Invalid IP address value. It should be the decimal number (0-9).");
document.snmpTable.snmpTrapIpAddr.value = document.snmpTable.snmpTrapIpAddr.defaultValue;
document.snmpTable.snmpTrapIpAddr.focus();
return false;
}
if ( !checkDigitRange(document.snmpTable.snmpTrapIpAddr.value,1,1,254) ) {
alert('Invalid Trap IP address range in 1st digit. It should be 1-254.');
document.snmpTable.snmpTrapIpAddr.value = document.snmpTable.snmpTrapIpAddr.defaultValue;
document.snmpTable.snmpTrapIpAddr.focus();
return false;
}
if ( !checkDigitRange(document.snmpTable.snmpTrapIpAddr.value,2,1,254) ) {
alert('Invalid Trap IP address range in 2nd digit. It should be 1-254.');
document.snmpTable.snmpTrapIpAddr.value = document.snmpTable.snmpTrapIpAddr.defaultValue;
document.snmpTable.snmpTrapIpAddr.focus();
return false;
}
if ( !checkDigitRange(document.snmpTable.snmpTrapIpAddr.value,3,1,254) ) {
alert('Invalid Trap IP address range in 3rd digit. It should be 1-254.');
document.snmpTable.snmpTrapIpAddr.value = document.snmpTable.snmpTrapIpAddr.defaultValue;
document.snmpTable.snmpTrapIpAddr.focus();
return false;
}
if ( !checkDigitRange(document.snmpTable.snmpTrapIpAddr.value,4,1,254) ) {
alert('Invalid Trap IP address range in 4th digit. It should be 1-254.');
document.snmpTable.snmpTrapIpAddr.value = document.snmpTable.snmpTrapIpAddr.defaultValue;
document.snmpTable.snmpTrapIpAddr.focus();
return false;
}
if(!checkTextStr(document.snmpTable.snmpSysContact.value))
{
alert("Invalid value in System Contact");
document.snmpTable.snmpSysContact.focus();
return false;
}
if(!checkTextStr(document.snmpTable.snmpSysLocation.value))
{
alert("Invalid value in System Location");
document.snmpTable.snmpSysLocation.focus();
return false;
}
return true;
}
function updateState()
{
if(document.snmpTable.snmpEnabled.checked == true)
document.getElementById('snmpcontent').style.display = 'block';
else
document.getElementById('snmpcontent').style.display = 'none';
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body onLoad="updateState()">
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Network Tools";
HelpItem="snmp";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">SNMP Protocol Configuration</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configure the SNMP protocol. Here you may change
the setting for system description, trap ip address, community name, etc..</p>
</td>
</tr>
</table>
<form action="form2Snmp.cgi" method=POST name="snmpTable">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">SNMP Protocol Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">
<input type="checkbox" name="snmpEnabled"
<VWS_SCREEN (char*) xscrnShowSnmpState[];>
 onclick="updateState()">
</td>
<td class="form_label_enable" style="text-align:left">Enable SNMP</td>
</tr>
</table>
<div id="snmpcontent" style="display:none">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left"><font size=2><b>System Description</b></td>
<td class="form_label_right">
<VWS_SCREEN (char*) xscrnSnmpDescription[];>
 </td>
</tr>
<tr>
<td class="form_label_left"><font size=2><b>System Contact</b></td>
<td class="form_label_right"><input type="text" name="snmpSysContact" size="50" maxlength="64" value="
<VWS_SCREEN (char*) xscrnSnmpContact[];>
"></td>
</tr>
<tr>
<td class="form_label_left"><font size=2><b>System Name</b></td>
<td class="form_label_right"><input type="text" name="snmpSysName" size="50" maxlength="64" value="
<VWS_SCREEN (char*) xscrnSnmpName[];>
"></td>
</tr>
<tr>
<td class="form_label_left"><font size=2><b>System Location</b></td>
<td class="form_label_right"><input type="text" name="snmpSysLocation" size="50" maxlength="64" value="
<VWS_SCREEN (char*) xscrnSnmpLocation[];>
"></td>
</tr>
<tr>
<td class="form_label_left"><font size=2><b>Trap IP Address</b></td>
<td class="form_label_right"><input type="text" name="snmpTrapIpAddr" size="15" maxlength="15" value="
<VWS_SCREEN (char*) xscrnSnmpTrapHost[];>
"></td>
</tr>
<tr>
<td class="form_label_left"><font size=2><b>Community name (read-only)</b></td>
<td class="form_label_right"><input type="text" name="snmpCommunityRO" size="50" maxlength="64" value="
<VWS_SCREEN (char*) xscrnSnmpCommStrRo[];>
"></td>
</tr>
<tr>
<td class="form_label_left"><font size=2><b>Community name (read-write)</b></td>
<td class="form_label_right"><input type="text" name="snmpCommunityRW" size="50" maxlength="64" value="
<VWS_SCREEN (char*) xscrnSnmpCommStrRw[];>
"></td>
</tr>
</table>
</div>
</td>
</tr>
</table>
<br>
<INPUT TYPE="hidden" NAME="submit.htm?snmp.htm" VALUE="Send">
<input type="submit" value="Apply Changes" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
<input type="reset" value="Reset" name="reset">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wlbasic.htm@#*&11435
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>WLAN Basic Settings</title>
<style>
.on {display:on}
.off {display:none}
</style>
<SCRIPT>
var regDomain, defaultChan, lastBand=0, lastMode=0, WiFiTest=0;
function skip () { this.blur(); }
function openWindow(url, windowName) {
var wide=620;
var high=420;
if (document.all)
var xMax = screen.width, yMax = screen.height;
else if (document.layers)
var xMax = window.outerWidth, yMax = window.outerHeight;
else
var xMax = 640, yMax=500;
var xOffset = (xMax - wide)/2;
var yOffset = (yMax - high)/3;
var settings = 'width='+wide+',height='+high+',screenX='+xOffset+',screenY='+yOffset+',top='+yOffset+',left='+xOffset+', resizable=yes, toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes';
window.open( url, windowName, settings );
}
function showMacClick(url)
{
if (document.wlanSetup.wlanDisabled.value != "ON")
openWindow(url, 'showWirelessClient' );
}
function saveChanges()
{
if(!checkSpecialCharExcludeSpace(document.wlanSetup.ssid.value, 1)){
alert('Invalid SSID.');
document.wlanSetup.ssid.focus();
return false;
}
if (document.wlanSetup.wlanDisabled.value != "ON") {
band = 0;
if (document.wlanSetup.band.selectedIndex == 0)
band = 1;
else if (document.wlanSetup.band.selectedIndex == 1)
band = 2;
else if (document.wlanSetup.band.selectedIndex == 2)
band = 3;
else if (document.wlanSetup.band.value == 7)
band = 8;
else if (document.wlanSetup.band.value == 9)
band = 10;
else if (document.wlanSetup.band.value == 10)
band = 11;
else
band = 4;
basicRate=0;
operRate=0;
if (band & 1) {
basicRate|=0xf;
operRate|=0xf;
}
if ( (band & 2) || (band & 4) ) {
operRate|=0xff0;
if (!(band & 1)) {
if (WiFiTest)
basicRate=0x15f;
else
basicRate=0x1f0;
}
}
if (band & 8) {
if (!(band & 3))
operRate|=0xfff;
if (band & 1)
basicRate=0xf;
else if (band & 2)
basicRate=0x1f0;
else
basicRate=0xf;
}
operRate|=basicRate;
document.wlanSetup.basicrates.value = basicRate;
document.wlanSetup.operrates.value = operRate;
}
return true;
}
function disableWLAN()
{
disableTextField(document.wlanSetup.band);
disableTextField(document.wlanSetup.mode);
disableTextField(document.wlanSetup.ssid);
disableTextField(document.wlanSetup.chanwid);
disableTextField(document.wlanSetup.ctlband);
disableTextField(document.wlanSetup.chan);
disableTextField(document.wlanSetup.txpower);
disableButton(document.wlanSetup.showMac);
}
function enableWLAN()
{
enableTextField(document.wlanSetup.band);
enableTextField(document.wlanSetup.mode);
enableTextField(document.wlanSetup.ssid);
enableTextField(document.wlanSetup.chanwid);
enableTextField(document.wlanSetup.ctlband);
enableTextField(document.wlanSetup.chan);
enableTextField(document.wlanSetup.txpower);
enableButton(document.wlanSetup.showMac);
enableButton(document.wlanSetup.save);
}
function updateIputState()
{
if (document.wlanSetup.wlanDisabled.checked == true) {
document.wlanSetup.wlanDisabled.value="ON";
disableWLAN();
} else {
document.wlanSetup.wlanDisabled.value="OFF";
enableWLAN();
}
if (document.wlanSetup.chanwid.selectedIndex == 0)
disableCheckBox(document.wlanSetup.elements.ctlband);
else if (document.wlanSetup.wlanDisabled.checked == false)
enableCheckBox(document.wlanSetup.elements.ctlband);
if (document.wlanSetup.band.selectedIndex == 0||
document.wlanSetup.band.selectedIndex == 1||
document.wlanSetup.band.selectedIndex == 2){
if (document.getElementById)
document.getElementById('optionfor11n').style.display = 'none';
else if(document.layers == false)
document.all.optionfor11n.style.display = 'none';
}
else if (document.wlanSetup.band.selectedIndex == 3||
document.wlanSetup.band.selectedIndex == 4||
document.wlanSetup.band.selectedIndex == 5){
if (document.getElementById)
document.getElementById('optionfor11n').style.display = 'block';
else if(document.layers == false)
document.all.optionfor11n.style.display = 'block';
}
updateChan_channebound();
}
function showChannel5G()
{
document.wlanSetup.chan.length=0;
for (idx=0, chan=36; chan<=64; idx++, chan+=4) {
document.wlanSetup.chan.options[idx] = new Option(chan, chan, false, false);
if (chan == defaultChan)
document.wlanSetup.chan.selectedIndex = idx;
}
document.wlanSetup.chan.length = idx;
}
function showChannel2G(bound_40, band)
{
start = 0;
end = 0;
if (regDomain==1 || regDomain==2) {
start = 1;
end = 11;
}
else if (regDomain==3) {
start = 1;
end = 13;
}
else if (regDomain==4) {
start = 10;
end = 11;
}
else if (regDomain==5) {
start = 10;
end = 13;
}
else if (regDomain==6) {
start = 1;
end = 14;
}
else {
start = 1;
end = 11;
}
if(band == 9 || band == 10 || band == 7){
if(bound_40 ==1){
var sideBand_idex = document.wlanSetup.ctlband.selectedIndex;
var sideBand = document.wlanSetup.ctlband.options[sideBand_idex].value;
if(regDomain==4){
if(sideBand ==0){
start = 11;
end = 11;
}else{
start = 10;
end = 10;
}
}else if(regDomain==5){
if(sideBand ==0){
start = 13;
end = 13;
}else{
start = 10;
end = 10;
}
}else{
if(sideBand ==0){
start = 5;
if (regDomain==1 || regDomain==2)
end = 11;
else
end = 13;
}else{
end = end-4;
start = 1;
}
}
}
}
document.wlanSetup.chan.length=0;
idx=0;
document.wlanSetup.chan.options[idx] = new Option("Auto", 0, false, false);
if (0 == defaultChan) {
document.wlanSetup.chan.selectedIndex = 0;
}
idx++;
for (chan=start; chan<=end; chan++, idx++) {
document.wlanSetup.chan.options[idx] = new Option(chan, chan, false, false);
if (chan == defaultChan)
document.wlanSetup.chan.selectedIndex = idx;
}
document.wlanSetup.chan.length = idx;
}
function updateChan()
{
var idx_value= document.wlanSetup.band.selectedIndex;
var band_value= document.wlanSetup.band.options[idx_value].value;
currentBand = 1;
if(band_value==9 || band_value==10 || band_value==7){
updateChan_channebound();
}
else {
if (lastBand != currentBand) {
lastBand = currentBand;
if (currentBand == 2)
showChannel5G();
else
showChannel2G(0, band_value);
}
else {
if((lastMode!=0) && (lastMode>=7)) {
showChannel2G(0, band_value);
}
}
}
lastMode = band_value;
if (document.wlanSetup.chanwid.selectedIndex == 0)
disableCheckBox(document.wlanSetup.elements.ctlband);
else
enableCheckBox(document.wlanSetup.elements.ctlband);
if (document.wlanSetup.band.selectedIndex == 0||
document.wlanSetup.band.selectedIndex == 1||
document.wlanSetup.band.selectedIndex == 2){
if (document.getElementById)
document.getElementById('optionfor11n').style.display = 'none';
else if(document.layers == false)
document.all.optionfor11n.style.display = 'none';
}
else if (document.wlanSetup.band.selectedIndex == 3||
document.wlanSetup.band.selectedIndex == 4||
document.wlanSetup.band.selectedIndex == 5){
if (document.getElementById)
document.getElementById('optionfor11n').style.display = 'block';
else if(document.layers == false)
document.all.optionfor11n.style.display = 'block';
}
}
function updateChan_channebound()
{
var idx_value= document.wlanSetup.band.selectedIndex;
var band_value= document.wlanSetup.band.options[idx_value].value;
var bound = document.wlanSetup.chanwid.selectedIndex;
var adjust_chan;
currentBand = 1;
if(band_value==9 || band_value==10 || band_value ==7){

&&*&&en**&**
if(bound ==0)
adjust_chan=0;
if(bound ==1)
adjust_chan=1;
}else
adjust_chan=0;
if (currentBand == 1)
showChannel2G(adjust_chan, band_value);
if(lastMode == 0)
lastMode = band_value;
}
function updateChanWidth()
{
if (document.wlanSetup.chanwid.selectedIndex == 0)
disableCheckBox(document.wlanSetup.elements.ctlband);
else
enableCheckBox(document.wlanSetup.elements.ctlband);
updateChan_channebound();
}
</SCRIPT>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Wireless Setup";
HelpItem="wlbasic";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<form action="form2WlanSetup.cgi" method=POST name="wlanSetup">
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Wireless Basic Settings
</td>
</tr>
<tr>
<td class=content>
<p>
This page is used to configure the parameters for wireless LAN clients which
may connect to your Access Point. Here you may change wireless encryption settings
as well as wireless network parameters.</p>
</td>
</tr>
</table>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>WIRELEES NETWORK SETTINGS
</td>
</tr>
<tr>
<td class=content>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width=100%>
<tr>
<td align=right><input type="checkbox" name="wlanDisabled"
<VWS_SCREEN (char*) webShowWlanDISABLED[];>
 ONCLICK=updateIputState()>
</td>
<td class=form_label_enabled>&nbsp;&nbsp;Disable Wireless LAN Interface
</td>
</tr>
<tr>
<td class=form_label_40>Band:</td>
<td><select size=1 name=band onChange="updateChan()">
<option value=0>2.4 GHz (B)</option>
<option value=1>2.4 GHz (G)</option>
<option value=2>2.4 GHz (B+G)</option>
<option value=7>2.4 GHz (N)</option>
<option value=9>2.4 GHz (G+N)</option>
<option value=10>2.4 GHz (B+G+N)</option>
</select>
</td>
</tr>
<tr>
<td class=form_label_40>Mode:</td>
<td><select size="1" name="mode">
<VWS_FUNCTION (void*)wlGetWlanMode();>
 </select>
</td>
</tr>
<tr>
<td class=form_label_40>SSID:</td>
<td><input type=text name=ssid size="25" maxlength="32" value=
<VWS_SCREEN (char*) webShowWlanSSID[];>
 >
</td>
</tr>
<tr>
<td class=form_label_40>Channel Number:</td>
<td><select size="1" name="chan"> </select>
<b>&nbsp; &nbsp;Current Channel:</b>
<VWS_SCREEN (char*) webShowCurrentChan[];>
 </td>
<SCRIPT>
<VWS_SCREEN (char*) webShowWlanDomChan[];>
 </SCRIPT>
</tr>
<tr>
<td class=form_label_40>Radio Power (Percent):</td>
<td><select size="1" name="txpower">
<option value="0">100%</option>
<option value="1">80%</option>
<option value="2">50%</option>
<option value="3">25%</option>
<option value="4">10%</option>
</select>
</td>
</tr>
<tr>
<td class=form_label_40>Associated Clients:</td>
<td>
<input type="button" value="Show Active Clients" name="showMac" onClick="showMacClick('/wlstatbl.htm')">
</td>
</tr>
</table>
</td>
</tr>
</table>
<div id="optionfor11n" style="display:none">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>WIRELEES OPTIONS
</td>
</tr>
<tr>
<td class=content>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width=100%>
<tr>
<td class=form_label_40>Channel Width:</td>
<td><select size="1" name="chanwid" onChange="updateChanWidth()">
<option value="0">20MHZ</option>
<option value="1">40MHZ</option>
<VWS_SCREEN (char*) webShowCoexist[];>
 </select>
</td>
</tr>
<tr>
<td class=form_label_40>Control Sideband:</td>
<td><select size="1" name="ctlband" onChange="updateChan_channebound()">
<option value="0">Upper</option>
<option value="1">Lower</option>
</select>
</td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<p align=center>
<input type="submit" value="Apply Changes" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
</p>
<input type="hidden" name="basicrates" value=0>
<input type="hidden" name="operrates" value=0>
<INPUT TYPE="hidden" NAME="submit.htm?wlbasic.htm" VALUE="Send">
<script>
updateChan();
<VWS_SCREEN (char*) webShowWlanBand[];>
 <VWS_SCREEN (char*) webShowWlanChanWidth[];>
 <VWS_SCREEN (char*) webShowWlanCtrlChan[];>
 <VWS_SCREEN (char*) webShowWlanTx_Power[];>
 <VWS_SCREEN (char*) webShowWlanDISABLED2[];>
 updateIputState();
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wladvanced.htm@#*&8930
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Wireless Advanced Setting</title>
<SCRIPT>
<VWS_SCREEN (char*) webShowWlanEncryption_WPA[];>
var band;
function validateNum(str)
{
for (var i=0; i<str.length; i++) {
if ( !(str.charAt(i) >='0' && str.charAt(i) <= '9')) {
alert("Invalid value. It should be in decimal number (0-9).");
return false;
}
}
return true;
}
function saveChanges()
{
if ( validateNum(document.advanceSetup.fragThreshold.value) == 0 ) {
document.advanceSetup.fragThreshold.focus();
return false;
}
num = parseInt(document.advanceSetup.fragThreshold.value);
if (document.advanceSetup.fragThreshold.value == "" || num < 256 || num > 2346) {
alert('Invalid value of Fragment Threshold. Input value should be between 256-2346 in decimal.');
document.advanceSetup.fragThreshold.focus();
return false;
}
if ( validateNum(document.advanceSetup.rtsThreshold.value) == 0 ) {
document.advanceSetup.rtsThreshold.focus();
return false;
}
num = parseInt(document.advanceSetup.rtsThreshold.value);
if (document.advanceSetup.rtsThreshold.value=="" || num > 2347) {
alert('Invalid value of RTS Threshold. Input value should be between 0-2347 in decimal.');
document.advanceSetup.rtsThreshold.focus();
return false;
}
if ( validateNum(document.advanceSetup.beaconInterval.value) == 0 ) {
document.advanceSetup.beaconInterval.focus();
return false;
}
num = parseInt(document.advanceSetup.beaconInterval.value);
if (document.advanceSetup.beaconInterval.value=="" || num < 20 || num > 1024) {
alert('Invalid value of Beacon Interval. Input value should be between 20-1024 in decimal.');
document.advanceSetup.beaconInterval.focus();
return false;
}
num = parseInt(document.advanceSetup.dtimInterval.value);
if (document.advanceSetup.dtimInterval.value=="" || num < 1 || num > 255) {
alert('Invalid value of DTIM. Input value should be between 1-255 in decimal.');
document.advanceSetup.dtimInterval.focus();
return false;
}
return true;
}
function disableRadioGroup (radioArrOrButton)
{
if (radioArrOrButton.type && radioArrOrButton.type == "radio") {
var radioButton = radioArrOrButton;
var radioArray = radioButton.form[radioButton.name];
}
else
var radioArray = radioArrOrButton;
radioArray.disabled = true;
for (var b = 0; b < radioArray.length; b++) {
if (radioArray[b].checked) {
radioArray.checkedElement = radioArray[b];
break;
}
}
for (var b = 0; b < radioArray.length; b++) {
radioArray[b].disabled = true;
radioArray[b].checkedElement = radioArray.checkedElement;
}
}
function enableRadioGroup (radioArrOrButton)
{
if (radioArrOrButton.type && radioArrOrButton.type == "radio") {
var radioButton = radioArrOrButton;
var radioArray = radioButton.form[radioButton.name];
}
else
var radioArray = radioArrOrButton;
radioArray.disabled = false;
radioArray.checkedElement = null;
for (var b = 0; b < radioArray.length; b++) {
radioArray[b].disabled = false;
radioArray[b].checkedElement = null;
}
}
function updateState()
{
if (document.advanceSetup.wlanDisabled.value == "ON") {
disableRadioGroup(document.advanceSetup.authType);
disableTextField(document.advanceSetup.fragThreshold);
disableTextField(document.advanceSetup.rtsThreshold);
disableTextField(document.advanceSetup.beaconInterval);
disableTextField(document.advanceSetup.dtimInterval);
disableTextField(document.advanceSetup.txRate);
disableRadioGroup(document.advanceSetup.preamble);
disableRadioGroup(document.advanceSetup.hiddenSSID);
disableRadioGroup(document.advanceSetup.block);
disableRadioGroup(document.advanceSetup.BlockEth2Wir);
disableRadioGroup(document.advanceSetup.mc2uc);
disableRadioGroup(document.advanceSetup.aggregation);
disableRadioGroup(document.advanceSetup.shortGI);
disableButton(document.advanceSetup.save);
}
else if(selectwpa == 1)
{
disableRadioGroup(document.advanceSetup.authType);
}
}
</SCRIPT>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Advanced Wireless";
HelpItem="wladvanced";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<body>
<form action="form2AdvanceSetup.cgi" method=POST name="advanceSetup">
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Wireless Advanced Settings</td>
</tr>
<tr>
<td class=content>
<p>These settings are only for more technically advanced users who have a sufficient
knowledge about wireless LAN. These settings should not be changed unless you know
what effect the changes will have on your Access Point.</p>
</td>
</tr>
</table>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Advanced Wireless Settings</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<input type=hidden name="wlanDisabled" 
<VWS_SCREEN (char*) webShowWlanDISABLED[];>
 >
</tr>
<tr>
<td class=form_label_left>Authentication Type:&nbsp;</td>
<td class=form_label_right>
<input type="radio" name="authType" value=0 >Open System&nbsp;&nbsp;
<input type="radio" name="authType" value=1 >Shared Key&nbsp;&nbsp;
<input type="radio" name="authType" value=2 >Auto
</td>
</tr>
<tr>
<td class=form_label_left>Fragment Threshold:&nbsp;</td>
<td class=form_label_right>
<input type="text" name="fragThreshold" size="10" maxlength="4" 
<VWS_SCREEN (char*) webShowWlanFragThreshold[];>
 >(256-2346)
</td>
</tr>
<tr>
<td class=form_label_left>RTS Threshold:&nbsp;</td>
<td class=form_label_right><input type="text" name="rtsThreshold" size="10" maxlength="4" 
<VWS_SCREEN (char*) webShowWlanRtsThreshold[];>
 >(0-2347)</td>
</tr>
<tr>
<td class=form_label_left>Beacon Interval:&nbsp;</td>
<td class=form_label_right><input type="text" name="beaconInterval" size="10" maxlength="4" 
<VWS_SCREEN (char*) webShowWlanBeaconInterval[];>
 >(20-1024 ms)</td>
</tr>
<tr>
<td class=form_label_left>DTIM Interval:&nbsp;</td>
<td class=form_label_right><input type="text" name="dtimInterval" size="10" maxlength="3" 
<VWS_SCREEN (char*) webShowWlanDTIM_PERIOD[];>
 >(1-255)</td>
</tr>
<tr>
<td class=form_label_left>Data Rate:&nbsp;</b></td>
<td class=form_label_right><select size="1" name="txRate">
<SCRIPT>
<VWS_SCREEN (char*) webShowWlanAdvanInit1[];>
 rate_mask = [15,1,1,1,1,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,8,8,8,8,8,8,8,8];
rate_name =["Auto","1M","2M","5.5M","11M","6M","9M","12M","18M","24M","36M","48M","54M", "MCS0", "MCS1",
"MCS2", "MCS3", "MCS4", "MCS5", "MCS6", "MCS7", "MCS8", "MCS9", "MCS10", "MCS11", "MCS12", "MCS13", "MCS14", "MCS15"];
mask=0;
if (auto)
txrate=0;
if (band & 1)
mask |= 1;
if ((band&2) || (band&4))
mask |= 2;
if (band & 8) {
if (rf_num == 2)
mask |= 12;	
else
mask |= 4;
}
defidx=0;
for (idx=0, i=0; i<=28; i++) {
if (rate_mask[i] & mask) {
if (i == 0)
rate = 0;
else
rate = (1 << (i-1));
if (txrate == rate)
defidx = idx;
document.write('<option value="' + i + '">' + rate_name[i] + '\n');
idx++;
}
}
document.advanceSetup.txRate.selectedIndex=defidx;
</SCRIPT>
</select>
</td>
</tr>
<tr>
<td class=form_label_left>Preamble Type:&nbsp;</td>
<td class=form_label_right>
<input type="radio" name="preamble" value=0>Long Preamble&nbsp;&nbsp;
<input type="radio" name="preamble" value=1>Short Preamble</td>
</tr>
<tr>
<td class=form_label_left>Broadcast SSID:&nbsp;</td>
<td class=form_label_right>
<input type="radio" name="hiddenSSID" value=0>Enabled&nbsp;&nbsp;
<input type="radio" name="hiddenSSID" value=1>Disabled</td>
</tr>
<tr>
<td class=form_label_left>Relay Blocking:&nbsp;</td>
<td class=form_label_right>
<input type="radio" name=block value=1>Enabled&nbsp;&nbsp;
<input type="radio" name=block value=0>Disabled</td>
</tr>
<tr>
<td class=form_label_left>Ethernet to Wireless Blocking:&nbsp;</td>
<td class=form_label_right>
<input type="radio" name=BlockEth2Wir value=1>Enabled&nbsp;&nbsp;
<input type="radio" name=BlockEth2Wir value=0>Disabled</td>
</tr>
<tr>
<td class=form_label_left>Wifi Multicast to Unicast:&nbsp;</td>
<td class=form_label_right>
<input type="radio" name=mc2uc value=1>Enabled&nbsp;&nbsp;
<input type="radio" name=mc2uc value=0>Disabled</td>
</tr>
<tr>
<td class=form_label_left>Aggregation:</td>
<td class=form_label_right>
<input type="radio" name=aggregation value=1>Enabled&nbsp;&nbsp;
<input type="radio" name=aggregation value=0>Disabled</td>
</tr>
<tr>
<td class=form_label_left>Short GI:</td>
<td class=form_label_right>
<input type="radio" name=shortGI value=1>Enabled&nbsp;&nbsp;
<input type="radio" name=shortGI value=0>Disabled</td>
</tr>
</table>
</td>
</tr>
</table>
<p align=center>
<input type="submit" value="Apply Changes" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
<INPUT TYPE="hidden" NAME="submit.htm?wladvanced.htm" VALUE="Send">
</p>
<script>
<VWS_SCREEN (char*) webShowWlanAdvanInit2[];>
 updateState();
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wlwpa.htm@#*&13307
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Wireless Security Setup</title>
<script>
<VWS_SCREEN (char*) webShowWlan_WPS2dotXLimit[];>
var defPskLen, defPskFormat;
function isValidWPAPasswd(str)   
{   
var patrn=/^[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~\x20]{6,61}[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}$/;   
if (!patrn.exec(str)) return false  ; 
if(str.indexOf("  ") != -1)
return false;
if(document.formEncrypt.pskValue.value.indexOf("  ",0)!=-1)
return false;
return true;	
} 
function disableRadioGroup (radioArrOrButton)
{
if (radioArrOrButton.type && radioArrOrButton.type == "radio") {
var radioButton = radioArrOrButton;
var radioArray = radioButton.form[radioButton.name];
}
else
var radioArray = radioArrOrButton;
radioArray.disabled = true;
for (var b = 0; b < radioArray.length; b++) {
if (radioArray[b].checked) {
radioArray.checkedElement = radioArray[b];
break;
}
}
for (var b = 0; b < radioArray.length; b++) {
radioArray[b].disabled = true;
radioArray[b].checkedElement = radioArray.checkedElement;
}
}
function enableRadioGroup (radioArrOrButton)
{
if (radioArrOrButton.type && radioArrOrButton.type == "radio") {
var radioButton = radioArrOrButton;
var radioArray = radioButton.form[radioButton.name];
}
else
var radioArray = radioArrOrButton;
radioArray.disabled = false;
radioArray.checkedElement = null;
for (var b = 0; b < radioArray.length; b++) {
radioArray[b].disabled = false;
radioArray[b].checkedElement = null;
}
}
function skip () { this.blur(); }
function preserve () { this.checked = this.storeChecked; }
function disableCheckBox (checkBox) {
if (!checkBox.disabled) {
checkBox.disabled = true;
if (!document.all && !document.getElementById) {
checkBox.storeChecked = checkBox.checked;
checkBox.oldOnClick = checkBox.onclick;
checkBox.onclick = preserve;
}
}
}
function enableCheckBox (checkBox)
{
if (checkBox.disabled) {
checkBox.disabled = false;
if (!document.all && !document.getElementById)
checkBox.onclick = checkBox.oldOnClick;
}
}
function check_wepbutton_state()
{
//if (document.formEncrypt.method.selectedIndex==1)
if (document.formEncrypt.method.value==1)
enableButton(document.formEncrypt.wepKey);
else
disableButton(document.formEncrypt.wepKey);
}
function check_radius_state()
{
form = document.formEncrypt ;
use1x = form.use1x;
wpaAuth = form.wpaAuth;
//if ( (form.method.selectedIndex<2 && use1x.checked) ) {
if ( (form.method.value<2 && use1x.checked) ) {
enableTextField(form.radiusPort);
enableTextField(form.radiusIP);
enableTextField(form.radiusPass);
}
//else if ( form.method.selectedIndex<2 ){ 
else if ( form.method.value<2 ){ 
disableTextField(form.radiusPort);
disableTextField(form.radiusIP);
disableTextField(form.radiusPass);
}
//if ( (form.method.selectedIndex>=2 && wpaAuth[0].checked) ) {
if ( (form.method.value>=2 && wpaAuth[0].checked) ) {
enableTextField(form.radiusPort);
enableTextField(form.radiusIP);
enableTextField(form.radiusPass);
disableTextField(document.formEncrypt.pskFormat);
disableTextField(document.formEncrypt.pskValue);
}
//else if ( (form.method.selectedIndex>=2 && wpaAuth[1].checked) ){
else if ( (form.method.value>=2 && wpaAuth[1].checked) ){
disableTextField(form.radiusPort);
disableTextField(form.radiusIP);
disableTextField(form.radiusPass);
enableTextField(document.formEncrypt.pskFormat);
enableTextField(document.formEncrypt.pskValue);
}
}
function check_nonWpaSupp_state()
{
check_radius_state();
check_wepbutton_state();
check_wepKeyLen_state();
}
function check_wepKeyLen_state()
{
form = document.formEncrypt ;
use1x = form.use1x;
//if ((form.method.selectedIndex==1 && use1x.checked) )
if ((form.method.value==1 && use1x.checked) )
enableRadioGroup(form.wepKeyLen);
else
disableRadioGroup(form.wepKeyLen);
}
function disable_wpa()
{
disableTextField(document.formEncrypt.pskFormat);
disableTextField(document.formEncrypt.pskValue);
//if(document.formEncrypt.elements.use1x.disabled != true)
enableCheckBox(document.formEncrypt.elements.use1x);
disableRadioGroup(document.formEncrypt.elements.wpaAuth);
check_nonWpaSupp_state();
}
function enable_wpa()
{
enableTextField(document.formEncrypt.pskFormat);
enableTextField(document.formEncrypt.pskValue);  
disableCheckBox(document.formEncrypt.elements.use1x);
// if(document.formEncrypt.elements.use1x.disabled != true)
enableRadioGroup(document.formEncrypt.elements.wpaAuth);  	
check_nonWpaSupp_state();
}
function checkState()
{
if (document.formEncrypt.wlanDisabled.value == "ON") {
disableTextField(document.formEncrypt.method);
disableButton(document.formEncrypt.wepKey);
disableTextField(document.formEncrypt.use1x);
disableRadioGroup(document.formEncrypt.wepKeyLen);
disableRadioGroup(document.formEncrypt.elements.wpaAuth);
disableTextField(document.formEncrypt.pskFormat);
disableTextField(document.formEncrypt.pskValue);
disableTextField(document.formEncrypt.radiusPort);
disableTextField(document.formEncrypt.radiusIP);
disableTextField(document.formEncrypt.radiusPass);
disableButton(document.formEncrypt.save);
} else {
//if (document.formEncrypt.method.selectedIndex>=2)
if (document.formEncrypt.method.value>=2)
enable_wpa();
else
disable_wpa();
};
}
function openWindow(url, windowName)
{
var wide=620;
var high=420;
if (document.all)
var xMax = screen.width, yMax = screen.height;
else if (document.layers)
var xMax = window.outerWidth, yMax = window.outerHeight;
else
var xMax = 640, yMax=500;
var xOffset = (xMax - wide)/2;
var yOffset = (yMax - high)/3;
var settings = 'width='+wide+',height='+high+',screenX='+xOffset+',screenY='+yOffset+',top='+yOffset+',left='+xOffset+', resizable=yes, toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes';
window.open( url, windowName, settings );
}
function wepKeyClick(url)
{
//if (document.formEncrypt.method.selectedIndex==1)
if (document.formEncrypt.method.value==1)
openWindow(url, 'SetWEPKey' );
}
function saveChanges()
{
//if (document.formEncrypt.method.selectedIndex>=2) {
if (document.formEncrypt.method.value>=2) {
if (document.formEncrypt.wpaAuth[1].checked) {
var str = document.formEncrypt.pskValue.value;
if (document.formEncrypt.pskFormat.selectedIndex==1) {
if (str.length != 64) {
alert('Pre-Shared Key value should be 64 characters.');
document.formEncrypt.pskValue.focus();
return false;
}
takedef = 0;
if (defPskFormat == 1 && defPskLen == 64) {
for (var i=0; i<64; i++) {
if ( str.charAt(i) != '*')
break;
}
if (i == 64 )
takedef = 1;
}
if (takedef == 0) {
for (var i=0; i<str.length; i++) {
if ( (str.charAt(i) >= '0' && str.charAt(i) <= '9') ||
(str.charAt(i) >= 'a' && str.charAt(i) <= 'f') ||
(str.charAt(i) >= 'A' && str.charAt(i) <= 'F') )
continue;
alert("Invalid Pre-Shared Key value. It should be in hex number (0-9 or a-f).");
document.formEncrypt.pskValue.focus();
return false;
}
}
}
else {
if (str.length < 8) {
alert('Pre-Shared Key value should be set at least 8 characters.');
document.formEncrypt.pskValue.focus();
return false;
}
if (str.length >= 64) {
alert('Pre-Shared Key value should be less than 64 characters.');
document.formEncrypt.pskValue.focus();
return false;
}
//add by ramen 20090603 for telefonica 
if(!isValidWPAPasswd(str))
{
alert('Pre-Shared Key value has illegal characters.');
return false;
}
}
}
else if (document.formEncrypt.wpaAuth[0].checked) {
if (!checkHostIP(document.formEncrypt.radiusIP, 1)) {
alert('Invalid IP address.');
document.formEncrypt.radiusIP.focus();
return false;
}
if (includeSpace(document.formEncrypt.radiusPass.value)) {
alert('Invalid password.');
document.formEncrypt.radiusPass.focus();
return false;
}
if (checkString(document.formEncrypt.radiusPass.value) == 0) {
alert('Invalid password.');
document.formEncrypt.radiusPass.focus();
return false;
}
}
}
//if ((document.formEncrypt.method.selectedIndex < 2) && (document.formEncrypt.use1x.checked)) {
if ((document.formEncrypt.method.value < 2) && (document.formEncrypt.use1x.checked)) {
if (!checkHostIP(document.formEncrypt.radiusIP, 1)) {
alert('Invalid IP address.');
document.formEncrypt.radiusIP.focus();
return false;
}
if (includeSpace(document.formEncrypt.radiusPass.value)) {
alert('Invalid password.');
document.formEncrypt.radiusPass.focus();
return false;
}
if (checkString(document.formEncrypt.radiusPass.value) == 0) {
alert('Invalid password.');
document.formEncrypt.radiusPass.focus();
return false;
}
}
//var selectidx = document.formEncrypt.method.selectedIndex;
var selectivalue = document.formEncrypt.method.value;
var enable1x = document.formEncrypt.use1x.checked;
var wpa_auth = 0;;
if(document.formEncrypt.wpaAuth[0].checked)
wpa_auth = 1;
else
wpa_auth = 2;
//if(enable1x == 1 || ((selectidx>=2 && selectidx <=5)&& wpa_auth==1))
if(enable1x == 1 || ((selectivalue>=3 && selectidx <=6)&& wpa_auth==1))
{
if (!confirm("WPS can not support Radius Authentication.Do you want to disable WPS function?"))
return false;
}
else if(wps2dotx == 1)
{
//if(selectidx == 1 && enable1x == 0)  //select WEP 
if(selectivalue == 1 && enable1x == 0)  //select WEP 
{
if (!confirm("New WPS(2.0) can not support WEP authentication.Do you want to disable WPS function?"))
return false;
}
//else if(selectidx == 2 && wpa_auth == 2)//select WPA(TKIP)
else if(selectivalue == 2 && wpa_auth == 2)//select WPA(TKIP)
{
if (!confirm("New WPS(2.0) can not support WPA(TKIP) Authentication.Do you want to disable WPS function?"))
return false;
}
//else if(selectidx == 5 && wpa_auth == 2)//select WPA2(TKIP)
else if(selectivalue == 6 && wpa_auth == 2)//select WPA2(TKIP)
{
if (!confirm("New WPS(2.0) can not support WPA2(TKIP) Authentication.Do you want to disable WPS function?"))
return false;
}
else if(ssidhidden == 1)
{
if (!confirm("New WPS(2.0) can not support SSID hidden.Do you want to disable WPS function?"))
return false;
}
else if(acllimit == 1)
{
if (!confirm("New WPS(2.0) can not support ACL mode is set to Allow List and the list is empty.Do you want to disable WPS function?"))
return false;
}
}
return true;
}
</script>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Wireless Setup";
HelpItem="wlsecurity";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<form action=form2WlEncrypt.cgi method=POST name="formEncrypt">
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Wireless Security Setup
</td>
</tr>
<tr>
<td class=content>
<p>This page allows you setup the wireless security. Turn on WEP or WPA by using
Encryption Keys could prevent any unauthorized access to your wireless network.</p>
</td>
</tr>
</table>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>WIRELEES SECURITY SETTINGS
</td>
</tr>
<tr>
<td class=content>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width=100%>
<input type=hidden name="wlanDisabled" 
<VWS_SCREEN (char*) webShowWlanDISABLED[];>
 >
<tr>
<td class=form_label_40>Encryption:&nbsp;</td>
<td><select size="1" name="method" onChange="checkState()">
<option value=0>None</option>
<VWS_SCREEN (char*) webShowWlanEncryptMethod[];> 
 </select>
<input type="button" value="Set WEP Key" name="wepKey" onClick="wepKeyClick('wlwep.htm')">
</td>
</tr>
<tr>
<td class=form_label_40 onClick="checkState()">
<input type="checkbox" name="use1x" value="ON">&nbsp;&nbsp;Use 802.1x Authentication
</td>
<td>
<input type="radio" name="wepKeyLen" value=1 >&nbsp;&nbsp;WEP 64bits&nbsp;
<input type="radio" name="wepKeyLen" value=2 >&nbsp;&nbsp;WEP 128bits
</td>     					
</tr>
<tr>
<td class=form_label_40>WPA Authentication Mode:</td>
<td>
<input type="radio" name="wpaAuth" value=1 onClick="checkState()">Enterprise (RADIUS)&nbsp;
<input type="radio" name="wpaAuth" value=2 onClick="checkState()">Personal (Pre-Shared Key)				
</td>
</tr>
<tr>
<td class=form_label_40>Pre-Shared Key Format:</td>
<td><select size="1" name="pskFormat">
<option value=0 >Passphrase</option>
<option value=1 >Hex (64 characters)</option>
</select>
</td>
</tr>
<tr>
<td class=form_label_40>Pre-Shared Key:</td>
<td>	 
<input type="text" name="pskValue" size="32" maxlength="64" value=
<VWS_SCREEN (char*) webShowWlanPSK[];>
 >
</td>
</tr>
<tr>
<td class=form_label_40>Authentication RADIUS Server:</td>
<td>	 
Port <input type="text" name="radiusPort" size="4" maxlength="5" 
<VWS_SCREEN (char*) webShowWlanRS_PORT[];>
 >&nbsp;&nbsp;
IP address <input type="text" name="radiusIP" size="10" 
<VWS_SCREEN (char*) webShowWlanRS_IP[];>
 >&nbsp;&nbsp;
Password <input type="password" name="radiusPass" size="8" maxlength="64" 
<VWS_SCREEN (char*) webShowWlanRS_PASSWORD[];>
 >
</td>
</tr>
</table>
</td>
</tr>
</table>
<p><font color="red">Note: When encryption WEP is selected, you must set WEP key value.</font></p>
<p align=center>
<input type=submit value="Apply Changes" name=save onClick="return saveChanges()">&nbsp;
</p>
<INPUT TYPE="hidden" NAME="submit.htm?wlwpa.htm" VALUE="Send">
<script>
<VWS_SCREEN (char*) webShowWlanSECURITY_INIT[];>
 checkState();
defPskLen = document.formEncrypt.pskValue.value.length;
defPskFormat = document.formEncrypt.pskFormat.selectedIndex;
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wlactrl.htm@#*&4473
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Wireless Access Control</title>
<script>
function skip () { this.blur(); }
function addClick()
{
if (!checkMacWithoutColon(document.formWlAcAdd.mac, 1))	{
alert("Invalid mac address!please input one valid unicast mac address!");
return false;
}
return true;
}
function disableDelButton()
{
disableButton(document.formWlAcDel.deleteSelFilterMac);
disableButton(document.formWlAcDel.deleteAllFilterMac);
}
function enableAc()
{
enableTextField(document.formWlAcAdd.mac);
}
function disableAc()
{
disableTextField(document.formWlAcAdd.mac);
}
function updateState()
{
if(wlanDisabled || wlanMode == 1 || wlanMode ==2){
disableDelButton();
disableButton(document.formWlAcAdd.reset);
disableButton(document.formWlAcAdd.addFilterMac);
disableTextField(document.formWlAcAdd.wlanAcEnabled);
disableAc();
} 
else{
if (document.formWlAcAdd.wlanAcEnabled.selectedIndex) {
enableButton(document.formWlAcAdd.reset);
enableButton(document.formWlAcAdd.addFilterMac);
enableAc();
}
else {
disableButton(document.formWlAcAdd.reset);
disableButton(document.formWlAcAdd.addFilterMac);
disableAc();
}
}
}
function  delEntryCheck()
{
if(document.formWlAcDel.select.length)
{
for(i=0;i<document.formWlAcDel.select.length;i++)   
{ 
if(document.formWlAcDel.select[i].checked)
return deleteClick();
}
}else
{
if(document.formWlAcDel.select.checked)
return deleteClick();
}
alert("please select an entry to delete!"); 
return false; 
}
</script>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Advanced Wireless";
HelpItem="wlacl";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<form action=form2WlAc.cgi method=POST name="formWlAcAdd">
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Wireless Access Control</td>
</tr>
<tr>
<td class=content>
<p> If you choose 'Allowed Listed', only those clients whose wireless MAC
addresses are in the access control list will be able to connect to your
Access Point. When 'Deny Listed' is selected, these wireless clients on 
the list will not be able to connect the Access Point.</p>
</td>
</tr>
</table>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Wireless Access Control Mode</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class=form_label_40>Wireless Access Control Mode: &nbsp;&nbsp;&nbsp;&nbsp;</td>
<td><select size="1" name="wlanAcEnabled" onclick="updateState()">
<option value=0 >Disable</option>
<option value=1 >Allow Listed</option>
<option value=2 >Deny Listed</option>
</select>
</td>						
</tr>
</table>				
</td>
</tr>
</table>
<p align=center>
<input type="submit" value="Apply Changes" name="setFilterMode">&nbsp;&nbsp;
</p>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Wireless Access Control Settings</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class=form_label_40>MAC Address: &nbsp;&nbsp;&nbsp;&nbsp;</td>
<td><input type="text" name="mac" size="15" maxlength="12">
&nbsp;&nbsp;(ex. 00E086710502)
</td>						
</tr>
</table>
</td>
</tr>
</table>
<p align=center>
<input type="submit" value="Add" name="addFilterMac" onClick="return addClick()">&nbsp;&nbsp;
<input type="reset" value="Reset" name="reset">&nbsp;&nbsp;&nbsp;
<INPUT TYPE="hidden" NAME="submit.htm?wlactrl.htm" VALUE="Send">
</p> 
</form>
<br>
<form action=form2WlAc.cgi method=POST name="formWlAcDel">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Current Access Control List</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<VWS_SCREEN (char*) webShowWlanAC_LIST[];>
 </table>				
</td>
</tr>
</table>	
<br>
<p align="center">
<input type="submit" value="Delete Selected" name="deleteSelFilterMac" onClick="return delEntryCheck()">&nbsp;&nbsp;
<input type="submit" value="Delete All" name="deleteAllFilterMac" onClick="return deleteAllClick()">&nbsp;&nbsp;&nbsp;
</p>
<INPUT TYPE="hidden" NAME="submit.htm?wlactrl.htm" VALUE="Send">
<script>
<VWS_SCREEN (char*) webShowWlanAC_INIT[];>
 updateState();
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wlstatbl.htm@#*&1389
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Active Wireless Client Table</title>
</head>
<body>
<blockquote>
<div id=maincontent style="width:500">
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Active Wireless Client Table
</td>
</tr>
<tr>
<td class=content>
<p>
This table shows the MAC address, transmission, reception packet counters and encrypted
status for each associated wireless client</p>
</td>
</tr>
</table>
<form action="form2WirelessTbl.cgi" method=POST name="formWirelessTbl">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Active Wireless Client Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row>
<td class=form_label_col>MAC Address</td>
<td class=form_label_col>Tx Packet</td>
<td class=form_label_col>Rx Packet</td>
<td class=form_label_col>Tx Rate (Mbps)</td>
<td class=form_label_col>Power Saving</td>	
<td class=form_label_col>Expired Time (s)</td>	
</tr>
<VWS_SCREEN (char*) webShowWlanClientList[];>					
 </table>
</td>
</tr>
</table>
<p align=center>
<input type="submit" value="Refresh" name="refresh">&nbsp;&nbsp;
<input type="button" value=" Close " name="close" onClick="javascript: window.close();">
</p>
<INPUT TYPE="hidden" NAME="submit.htm?wlstatbl.htm" VALUE="Send">
</form>
</blockquote>
</body>
</div>
</html>

&*#@wlwep.htm@#*&6347
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>WEP Key Setup</title>
<SCRIPT>
function validateKey(idx, str, len)
{

&&*&&en**&**
if (document.formWep.defaultTxKeyId.selectedIndex==idx && str.length==0) {
alert('The encryption key you selected as the \'Tx Default Key\' cannot be blank.');
return 0;
}
if (str.length ==0)
return 1;
if ( str.length != len) {
idx++;
alert('Invalid length of Key ' + idx + ' value. It should be ' + len + ' characters.');
return 0;
}
if ( str == "*****" ||
str == "**********" ||
str == "*************" ||
str == "**************************" )
return 1;
if (document.formWep.format.selectedIndex==0)
{
//add by ramen 20090604
var patrn=/^[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~\x20]*[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}$/;   
if (!patrn.exec(str)) {
alert("Invalid characters!please check your input! ");
return 0  ; 
}
if(str.indexOf("  ",0)!=-1)
{
alert("There should not be more than one consecutive space in the key!");
return 0;
}
return 1;
}
for (var i=0; i<str.length; i++) {
if ( (str.charAt(i) >= '0' && str.charAt(i) <= '9') ||
(str.charAt(i) >= 'a' && str.charAt(i) <= 'f') ||
(str.charAt(i) >= 'A' && str.charAt(i) <= 'F') )
continue;
alert("Invalid key value. It should be in hex number (0-9 or a-f).");
return 0;
}
return 1;
}
function updateFormat()
{
if (document.formWep.length.selectedIndex == 0) {
document.formWep.format.options[0].text = 'ASCII (5 characters)';
document.formWep.format.options[1].text = 'Hex (10 characters)';
}
else {
document.formWep.format.options[0].text = 'ASCII (13 characters)';
document.formWep.format.options[1].text = 'Hex (26 characters)';
}
setDefaultKeyValue();
}
function setDefaultKeyValue()
{
if (document.formWep.length.selectedIndex == 0) {
if ( document.formWep.format.selectedIndex == 0) {
document.formWep.key1.maxLength = 5;
document.formWep.key2.maxLength = 5;
document.formWep.key3.maxLength = 5;
document.formWep.key4.maxLength = 5;
document.formWep.key1.value = "*****";
document.formWep.key2.value = "*****";
document.formWep.key3.value = "*****";
document.formWep.key4.value = "*****";
}
else {
document.formWep.key1.maxLength = 10;
document.formWep.key2.maxLength = 10;
document.formWep.key3.maxLength = 10;
document.formWep.key4.maxLength = 10;
document.formWep.key1.value = "**********";
document.formWep.key2.value = "**********";
document.formWep.key3.value = "**********";
document.formWep.key4.value = "**********";
}
}
else {
if ( document.formWep.format.selectedIndex == 0) {
document.formWep.key1.maxLength = 13;
document.formWep.key2.maxLength = 13;
document.formWep.key3.maxLength = 13;
document.formWep.key4.maxLength = 13;
document.formWep.key1.value = "*************";
document.formWep.key2.value = "*************";
document.formWep.key3.value = "*************";
document.formWep.key4.value = "*************";
}
else {
document.formWep.key1.maxLength = 26;
document.formWep.key2.maxLength = 26;
document.formWep.key3.maxLength = 26;
document.formWep.key4.maxLength = 26;
document.formWep.key1.value = "**************************";
document.formWep.key2.value = "**************************";
document.formWep.key3.value = "**************************";
document.formWep.key4.value = "**************************";
}
}
}
function saveChanges()
{
var keyLen;
if (document.formWep.length.selectedIndex == 0) {
if ( document.formWep.format.selectedIndex == 0)
keyLen = 5;
else
keyLen = 10;
}
else {
if ( document.formWep.format.selectedIndex == 0)
keyLen = 13;
else
keyLen = 26;
}
if (validateKey(0,document.formWep.key1.value, keyLen)==0) {
document.formWep.key1.focus();
return false;
}
if (validateKey(1,document.formWep.key2.value, keyLen)==0) {
document.formWep.key2.focus();
return false;
}
if (validateKey(2,document.formWep.key3.value, keyLen)==0) {
document.formWep.key3.focus();
return false;
}
if (validateKey(3,document.formWep.key4.value, keyLen)==0) {
document.formWep.key4.focus();
return false;
}
return true;
}
function lengthClick()
{
updateFormat();
}
</SCRIPT>
</head>
<body>
<blockquote>
<div id=maincontent style="width:500">
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Wireless WEP Key Setup
</td>
</tr>
<tr>
<td class=content>
<p>
This page allows you setup the WEP key value. You could choose use 64-bit or
128-bit as the encryption key, and select ASCII or Hex as the format of input value.</p>
</td>
</tr>
</table>
<form action=form2Wep.cgi method=POST name="formWep">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Wireless WEP Key Setup</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border=0>
<input type="hidden" name="wepEnabled" value="ON" checked>
<tr>
<td class=form_label_40>Key Length:</td>
<td><select size="1" name="length" ONCHANGE=lengthClick()>
<option value=1>64-bit</option>
<option value=2>128-bit</option>
</select>
</td>
</tr>
<tr>
<td class=form_label_40>Key Format:</td>
<td><select size="1" name="format" ONCHANGE=setDefaultKeyValue()>
<option value=1>ASCII</option>
<option value=2>Hex</option>
</select>
</td>
</tr>
<tr>
<td class=form_label_40>Default Tx Key:</td>
<td><select size="1" name="defaultTxKeyId">
<option value="1">Key 1</option>
<option value="2">Key 2</option>
<option value="3">Key 3</option>
<option value="4">Key 4</option>
</select>
</td>
</tr>
<tr>
<td class=form_label_40>Encryption Key 1:</td>
<td>
<input type="text" name="key1" size="26" maxlength="26">
</td>
</tr>
<tr>
<td class=form_label_40>Encryption Key 2:</td>
<td>
<input type="text" name="key2" size="26" maxlength="26">
</td>
</tr>			
<tr>
<td class=form_label_40>Encryption Key 3:</td>
<td>
<input type="text" name="key3" size="26" maxlength="26">
</td>
</tr>		
<tr>
<td class=form_label_40>Encryption Key 4:</td>
<td>
<input type="text" name="key4" size="26" maxlength="26">
</td>
</tr>
</table>
</td>
</tr>
</table>
<p align=center>
<input type="submit" value="Apply Changes" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
<input type="button" value="Close" name="close" OnClick=window.close()>&nbsp;&nbsp;
<input type="reset" value="Reset" name="reset">
</p>
<INPUT TYPE="hidden" NAME="submit.htm?wlwep.htm" VALUE="Send">
<script>
<VWS_SCREEN (char*) webShowWlanWEP_INIT[];>
 updateFormat();
</script>
</form>
</blockquote>
</body>
</html>

&*#@wlwait.htm@#*&2220
<VWS_FUNCTION (void*)SendWebMetaStr();>
<link rel="stylesheet" href="stylemain.css" type='text/css'>
<title>Autoboot</title>
<script>
var wtime=20;
function stop()
{
//  clearTimeout(id); 
}
function start() 
{ 
wtime--;
if (wtime >= 0)
{ 
document.wlanWait.time.value = wtime;
id=setTimeout("start()",1000);
}
if (wtime == 0)
{ 
document.wlanWait.submit();
return true;
}
}
<VWS_FUNCTION (void*)WebShowModemName();>
<VWS_FUNCTION (void*)WebShowFirmwareVer();>
</script>
</head>
<body onLoad="start();" onUnload="stop();">
<blockquote>
<form action="form2WlanWait.cgi" method=POST name="wlanWait">
<DIV align="center" id="tblmain">
<table cellSpacing=0 width="840">
<tr>
<td>
<table id=header_container width="840">
<tr>
<script language="javascript">
document.writeln('<td align=left width="200">Product Page: ' + ModemVer + '</td>');
document.writeln('<td align=right width="50"></td>');
document.writeln('<td align=right width="550">Firmware Version: ' + FirmwareVer + '</td>');	
</script>
</tr>
</table>
<table cellSpacing=0 width=100%>
<tr>
<td height=3 style="background:white"></td>
</tr>
</table>
<table cellSpacing=0 width="840">
<tr>
<td id=masthead_container width="840"><img src="img_masthead.gif" alt="" width=836 height="92"></td>
</tr>
</table>
<table cellSpacing=0 summary="" border=0 width="100%" style="background-color:white" height=300>
<tr>
<td align=center >
<DIV id=maincontent style="width:600" >
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
WLAN RESTART
</td>
</tr>
<tr>
<td class=content>
<p> Wlan is restarting! Please wait...</p>
<table class=formarea border="0" cellspacing="0" cellpadding="0" width=100%>
<tr>
<td class=form_label_40>Please wait </td>
<td>
<INPUT TYPE=text NAME=time size=1>s
</td>
</tr>
</table>
<INPUT TYPE="hidden" NAME=
<VWS_FUNCTION (void*)webGetWlanRedirectURL();>
 VALUE="Send">
</td>
</tr>
</table>
</DIV>
</td>
</tr>
</table>
<table id=footer_container cellSpacing=0 border=0>
<tr>
<td id=leftimage>
<img height=35 alt="" src="img_broadband_bottom.gif" width=114></td>
<td>&nbsp;</td>
</tr>
</table>
</td>
</tr>
</table>
<DIV id=copyright>Copyright &copy; 2005-2012 D-Link Systems, Inc.</DIV>
</DIV>
</form>
</blockquote>
</body></html>

&*#@clientlimit.htm@#*&2966
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Routing Configuration </title>
<SCRIPT>
function applyClick()
{	
if(!validateDecimalDigit(document.clientlimit.numtextwindow.value))
{
if(document.clientlimit.limitcap[0].checked == true)
{
document.clientlimit.numtextwindow.value="";
return true;
}
alert("Please input decimal value!");
document.clientlimit.numtextwindow.focus();
return false;	
}
d1 = getDigit(document.clientlimit.numtextwindow.value, 1);
if(d1 > 32)
{
alert("Should less than 33!");
document.clientlimit.numtextwindow.focus();
return false;	
}
return true;
}
function disableLimit()
{
if (document.getElementById)  // DOM3 = IE5, NS6
{
document.getElementById('numtext').style.display = 'none';
} else {
if (document.layers == false) // IE4
{
document.all.numtext.style.display = 'none';
}
}
}
function enableLimit()
{
if (document.getElementById)  // DOM3 = IE5, NS6
{
document.getElementById('numtext').style.display = 'block';
} else {
if (document.layers == false) // IE4
{
document.all.numtext.style.display = 'block';
}
}
}	
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Network Tools";
//	HelpItem="Device Info";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Client Limit Configuration</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configure the capability of force how many device can access to Internet! </p>
</td>
</tr>
</table>
<form action="form2clientlimit.cgi" method=POST name="clientlimit">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Client Limit Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Client Limit Capability:</td>
<td class="form_label_right">
<input type="radio" value="0" name="limitcap" onClick="return disableLimit()">Disable&nbsp;&nbsp;
<input type="radio" value="1" name="limitcap" onClick="return enableLimit()">Enable
</td>
</tr>
</table>
<table id="numtext" style="display:none" class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Maximum Devices:</td>
<td class="form_label_right"><input type="text"  maxlength="2" size="2" name="numtextwindow"></td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Apply Changes" onClick="return applyClick()" >&nbsp;&nbsp;  
<input type="hidden" NAME="submit.htm?clientlimit.htm" value="Send">
<script>
<VWS_FUNCTION   (void*)clientlimitinitpage();>
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@tcpiplan_with_mac_addr_ctrl_linkmode.htm@#*&6445
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>LAN Interface Setup </title>
<SCRIPT>
selected=0;
function resetClick()
{
document.tcpip.reset;
}
function saveChanges()
{
if (!checkIP(document.tcpip.ip))
return false;
if (!checkMaskSpecial(document.tcpip.mask))
return false;
if (document.tcpip.enable_ip2.checked) {
if (!checkIP(document.tcpip.ip2))
return false;
if (!checkMaskSpecial(document.tcpip.mask2))
return false;
if (!Lan1NeqLan2(document.tcpip.ip, document.tcpip.mask, document.tcpip.ip2, document.tcpip.mask2)) {
alert("The first IP and the second IP must belong to the different subnet!");
document.tcpip.ip2.focus();
return false;
}
}
}
var warningstr= "Allowed MAC address Table should not empty when enabled on interface(s)!"
function macAcChanges()
{
if(document.delmacac.curTblNum.value == '0')
{
if(document.macac.lan1.checked == true)
alert(warningstr);
else if(document.macac.lan2.checked == true)
alert(warningstr);
else if(document.macac.lan3.checked == true)
alert(warningstr);
else if(document.macac.lan4.checked == true)
alert(warningstr);
else if(document.macac.wlan.checked == true)
alert(warningstr);
else{
return true;
}
return false;
}
}
function macAcDelFunc( form , dstmacaddr){
form.MacEntryDel.value = dstmacaddr;
form.submit();
}
function postEntry(port , linkmode)
{
document.linkmode.linkmode.value = linkmode;
document.linkmode.lanport.value = port;
selected = 1;
}
function modifyClick()
{
//if (!selected) {
//	alert("Please select an entry to modify!");
//	return false;
//}
}
</SCRIPT>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Local Network";
HelpItem="lancfg2";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">LAN Setting</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configure the LAN interface of your ADSL Router.
Here you may change the setting for IP addresss, subnet mask, etc..</p>
</td>
</tr>
</table>
<br>
<form action="form2lansetup.cgi" method=POST name="tcpip">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>LAN Interface Settings</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class=form_label_left>Interface Name:</td>
<td class=form_label_right><b>e1</b></td>
</tr>
<tr>
<td class=form_label_left>IP Address:</td>
<td class=form_label_right><input type="text" name="ip" size="15" maxlength="15" value="
<VWS_SCREEN (char*) xscrnLanIPAddr[];>
"></td>
</tr>
<tr>
<td class=form_label_left>Subnet Mask:</td>
<td class=form_label_right><input type="text" name="mask" size="15" maxlength="15" value="
<VWS_SCREEN (char*) xscrnLanSubnetMask[];>
"></td>
</tr> 
</table>
<VWS_FUNCTION (void*)lansetting();>
 </td>
</tr>
</table>
<br>
<script>
<VWS_FUNCTION   (void*)laninitpage();>
</script>
<input type="submit" value="Apply Changes" onClick="return saveChanges()">
<input type="hidden" value="Send" name="submit.htm?tcpiplan_with_mac_addr_ctrl_linkmode.htm">
</form>
<form action="form2lanlinkmode.cgi" method=POST name="linkmode">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>LAN Link Mode Settings</td>
</tr>
<tr>
<td class=content align=center>
<table class=formarea border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class=form_label_left>LAN Port:</td>
<td class=form_label_right>
<select size="1" name="lanport">
<VWS_FUNCTION  (void*)showLanPortTable(); >
 </select>
</td>
</tr>
<tr>
<td class=form_label_left>Link Speed/Duplex Mode:</td>
<td class=form_label_right>
<select size="1" name="linkmode">
<VWS_FUNCTION  (void*)showLinkModeTable(); >
 </select>
</td> 
</tr>
<br>
<br>
</table>
<p align=center>
<input type="submit" value="Modify" name="modify" onClick="return modifyClick()" >
</p>
</td>
</tr>
<tr>
<td class=content align=center colspan=3>
<table class=formlisting border=0 >
<tr class=form_label_row>
<td class=form_label_col colspan=3>
ETHERNET Status Table:
</td>
</tr>
<tr class=form_label_row>
<td class=form_label_col>Select</td>
<td class=form_label_col>Port</td>
<td class=form_label_col>Link Mode</td>
</tr>
<VWS_FUNCTION  (void*)showLanLinkModeTable(); >
 </table>
</td>
</tr>
</table>
<input type="hidden" value="Send" name="submit.htm?tcpiplan_with_mac_addr_ctrl_linkmode.htm">
</form> 
<form action="form2macac.cgi" method=POST name="macac">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>MAC Address Control Settings</td>
</tr>
<tr>
<td class=content>
<table class=formarea border=0>
<tr>
<td class=form_label_left>MAC Address Control:</td>
<td class=form_label_right>
<VWS_FUNCTION (void*)ShowMacAddrControlInterface();>
 </td>
</tr>
</table>
<p align=center>
<input type="submit" value="Apply Changes" onClick="return macAcChanges()"><br><br>
</p>
</td>
</tr>
</table>
<input type="hidden" value="Send" name="submit.htm?tcpiplan_with_mac_addr_ctrl_linkmode.htm">
</form>
<form action="form2macacadd.cgi" method=POST name="macacadd">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=content>
<table class=formarea border=0>
<tr>
<td class=form_label_left>New MAC Address:</td>
<td class=form_label_right>
<input type="text" name=newmac size=17 maxlength=17 >
<input type="submit" value="Add" onClick="return checkMac(document.macacadd.newmac)">
</td>
</tr>
</table>
</td>
</tr>
</table>
<input type="hidden" value="Send" name="submit.htm?tcpiplan_with_mac_addr_ctrl_linkmode.htm">
</form>
<form action="form2macacDel.cgi" method=POST name="delmacac">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Current Allowed MAC Address Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row>
<td class=form_label_col>MAC Addr</td>
<td class=form_label_col>Action</td>
</tr>
<VWS_FUNCTION (void*)ShowAllowedMacAddrTable();>
 </table>
</td>
</tr>
</table>
<input type="hidden" name="MacEntryDel" value ="0"> 
<input type="hidden" name="curTblNum" value=
<VWS_FUNCTION (void*)ShowEntriesNumInMacAllowList();>
;>
<input type="hidden" value="Send" name="submit.htm?tcpiplan_with_mac_addr_ctrl_linkmode.htm">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@adsl-diag.htm@#*&1746
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>ADSL Diagnostics </title>
<script>
function submitonce(theform)
{
if (document.all||document.getElementById)
{
for (i=0;i<theform.length;i++)
{
var tempobj=theform.elements[i]
if(tempobj.type.toLowerCase()=="submit"||tempobj.type.toLowerCase()=="reset")
tempobj.disabled=true;
}
}
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Maintenance";
SideItem="Diagnostics";
//	HelpItem="Device Info";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Diagnostic ADSL</td>
</tr>
<tr>
<td class=content>
<p>This page is used to diagnostic ADSL.
</p>
</td>
</tr>
</table>
<br>
<form action="formDiagAdsl.cgi" method=POST name=diag_adsl onSubmit="javascript:submitonce(this)">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Adsl Tone Diagnostic</td>
</tr>
<tr>
<td class="content" align="left">
<input type=submit value=" Start " name=start>
<input type=hidden value="adsl-diag_en.asp" name="submit-url">
</td>
</tr>
<VWS_FUNCTION (void*)adslToneDiagTbl();>
</table> 
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Adsl Tone List</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>			
<VWS_FUNCTION (void*)adslToneDiagList();>
 </table>
</td>
</tr>
</table> 
<script>
document.diag_adsl.start.focus();
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@nat_ftpalg.htm@#*&2088
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
 <SCRIPT>
function ftpalgportCheckClick()
{
var dport;
dport = getDigit(document.ftpalg.ftpdport.value, 1);
if ( validateKey(document.ftpalg.ftpdport.value) == 0 ||
(dport > 65535 || dport < 1) ) {
alert("Invalid port value! You should set a value between 1-65535.");
document.ftpalg.ftpdport.focus();
return false;
}
return true;
}
</SCRIPT>
</head>
<link href="stylemain.css" rel="stylesheet" type="text/css">
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="NAT";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>FTP ALG Configuration</td>
</tr>
<tr>
<td class=content>
<p>This page is used to configure FTP Server ALG and FTP Client ALG ports .
</p>
</td>
</tr>
</table>
<br>
<form action="form2ftpalg.cgi" method=POST name="ftpalg">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Setting port</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">
FTP ALG port
</td>
<td class='form_label_right'>
<input type="text" name="ftpdport" size="15" maxlength="125">
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Add Dest Ports" name="adddport" onClick="return ftpalgportCheckClick()">&nbsp;&nbsp;
<input type="submit" value="Delete Selected DestPort" name="deldport">&nbsp;&nbsp;
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>FTP ALG ports Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row >
<VWS_FUNCTION (void*)showFTPDportTable();>
 </tr>
</table>
</td>
</tr>
</table>
<input type="hidden" NAME="submit.htm?nat_ftpalg.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@arp_binding.htm@#*&3430
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>ARP Binding </title>
<SCRIPT>
function resetClick()
{
document.arpbinding.reset;
}
function arpTable(ip,mac)
{
this.ip=ip; 
//this.mac=mac;
this.mac=mac.replace(/:/g,"");
}
function checkDuplicateArp(ipaddr,macaddr)
{
var PermanentArpTables=new Array();
<VWS_FUNCTION (void*)CreatePermanentArpArray();>;
 for(var i=0; i<PermanentArpTables.length; i++)
{
if(PermanentArpTables[i].ip==ipaddr.value)
{
alert("The Ip address has been occupied!");
ipaddr.focus();
return false;
}
//if(PermanentArpTables[i].mac==macaddr.value )
//{
//	alert("The mac address has bound another ip address!");
//	macaddr.focus();
//	return false;
//}	
}
return true;
}
function saveChanges()
{
if (!checkIP(document.arpbinding.ipaddr))
{
return false;
}
if(!checkMacWithoutColon(document.arpbinding.macaddr,1))
{
alert("Invalid mac address!please input one valid unicast mac address!");
return false;
}
if(!checkDuplicateArp(document.arpbinding.ipaddr,document.arpbinding.macaddr))
{
return false;
}
return true;
}
function postArpBinding( ipaddr, macaddr)
{
document.arpbinding.ipaddr.value = ipaddr;
document.arpbinding.macaddr.value = macaddr.replace(/:/g,"");
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Network Tools";
//	HelpItem="Device Info";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">ARP Binding Configuration</td>
</tr>
<tr>
<td class="content">
<p>This page lists the permanent arp entry table.You can bind ip with corresponding mac to avoid arp spoof.</p>
</td>
</tr>
</table>
<form action="form2Arpbinding.cgi" method=POST name="arpbinding">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">ARP Binding Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">IP Address:</td>
<td class="form_label_right">
<input type="text" name="ipaddr" size="15" maxlength="15" value="0.0.0.0">
</td>
</tr>
<tr>
<td class="form_label_left">Mac Address:</td>
<td class="form_label_right">
<input type="text" name="macaddr" size="17" maxlength="17" value="000000000000">(ex. 00E086710502)
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Add" onClick="return saveChanges()">&nbsp;&nbsp;
<input type="submit" value="Delete Selected" name="delete">&nbsp;&nbsp;
<input type="reset" value="Undo" name="reset" onClick="resetClick()">
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">ARP Binding Table</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500">
<tr class="form_label_row">
<td class="form_label_col">Select</td>
<td class="form_label_col">IP Address</td>
<td class="form_label_col">MAC Address</td>
</tr>
<VWS_FUNCTION (void*)showArpBindingTable();>
 </table>
</td>
</tr>
</table>
<input type="hidden" NAME="submit.htm?arp_binding.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@nat_portrigger.htm@#*&16613
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Nat Port Trigger</title>
<SCRIPT language=javascript>
TOTAL_ROW = 8;
remain = 31;
var appName = '';
NO_SEL_MSG = 'please select an application';
RE_ALL_MSG = 'please input the match port & relate port rightly';
function isValidPort(port) {
var fromport = 0;
var toport = 100;
portrange = port.split(':');
if ( portrange.length < 1 || portrange.length > 2 ) {
return false;
}
if ( isNaN(portrange[0]) )
return false;
fromport = parseInt(portrange[0]);
if ( portrange.length > 1 ) {
if ( isNaN(portrange[1]) )
return false;
toport = parseInt(portrange[1]);
if ( toport <= fromport )
return false;
}
if ( fromport < 1 || fromport > 65535 || toport < 1 || toport > 65535 )
return false;
return true;
}
function clearAll()
{
with (document.form2PortriggerRule) {
for (i = 0; i < TOTAL_ROW; i++) {
matchPort_s[i].value = matchPort_e[i].value = relatePort_s[i].value = relatePort_e[i].value = "";
protocol[i].value = oProto[i].value = 1;
dir[i].value=0;
}
}
}
function appSelect(v)
{
clearAll();
with (document.form2PortriggerRule) {
switch(v) {
case '0':
AppName.selectedIndex = 0;
AppName.options[0].value = "0";
appName = "";
break;
case '1':
appName = "Aim Talk";
matchPort_s[0].value = matchPort_e[0].value = 4099;
relatePort_s[0].value = relatePort_e[0].value = 5191;
protocol[0].value = oProto[0].value = 0;
break;
case '2':
appName = "Asheron's Call";
matchPort_s[0].value = relatePort_s[0].value = 9000;
matchPort_e[0].value = relatePort_e[0].value = 9013;
protocol[0].value = oProto[0].value = 1;
break;
case '3':
appName = "Calista IP Phone";
matchPort_s[0].value = matchPort_e[0].value = 5190;
relatePort_s[0].value = relatePort_e[0].value = 3000;
protocol[0].value = 0;
oProto[0].value = 1;
break;
case '4':
appName = "Delta Force (Client/Server)";
matchPort_s[0].value = matchPort_e[0].value = 3568;
protocol[0].value = 1;
relatePort_s[0].value = 3100;
relatePort_e[0].value = 3999;
oProto[0].value = 255;
break;
case '5':
appName = "ICQ";
matchPort_s[0].value = matchPort_e[0].value = 4000;
protocol[0].value = 1;
relatePort_s[0].value = 20000;
relatePort_e[0].value = 20059;
oProto[0].value = 0;
break;
case '6':
appName = "Napster";
matchPort_s[0].value = matchPort_e[0].value = matchPort_s[1].value = matchPort_e[1].value = matchPort_s[2].value = matchPort_e[2].value =
matchPort_s[3].value = matchPort_e[3].value = matchPort_s[4].value = matchPort_e[4].value = matchPort_s[5].value = matchPort_e[5].value =
matchPort_s[6].value = matchPort_e[6].value = 6699;
relatePort_s[0].value = relatePort_e[0].value = 6699;
relatePort_s[1].value = relatePort_e[1].value = 6697;
relatePort_s[2].value = relatePort_e[2].value = 4444;
relatePort_s[3].value = relatePort_e[3].value = 5555;
relatePort_s[4].value = relatePort_e[4].value = 6666;
relatePort_s[5].value = relatePort_e[5].value = 7777;
relatePort_s[6].value = relatePort_e[6].value = 8888;
protocol[0].value = oProto[0].value = 0;
protocol[1].value = oProto[1].value = 0;
protocol[2].value = oProto[2].value = 0;
protocol[3].value = oProto[3].value = 0;
protocol[4].value = oProto[4].value = 0;
protocol[5].value = oProto[5].value = 0;
protocol[6].value = oProto[6].value = 0;
break;
case '7':
appName = "Net2Phone";
matchPort_s[0].value = matchPort_e[0].value = 6801;
protocol[0].value = 1;
relatePort_s[0].value = relatePort_e[0].value = 6801;
oProto[0].value = 1;
break;
case '8':
appName = "QuickTime 4 Client";
matchPort_s[0].value = matchPort_e[0].value = matchPort_s[1].value = matchPort_e[1].value = 554;
relatePort_s[0].value = relatePort_s[1].value = 6970;
relatePort_e[0].value = 32000;
relatePort_e[1].value = 7000;
protocol[0].value = protocol[1].value =0;
oProto[0].value=oProto[1].value = 1;
break;
case '9':
appName = "Rainbow Six/Rogue Spea";
matchPort_s[0].value = matchPort_e[0].value = 2346;
relatePort_s[0].value = 2436;
relatePort_e[0].value = 2438;
protocol[0].value =0;
oProto[0].value = 255;
break;
default:
alert('Not support selection');
}
}
}
function radioClick()
{
with (document.form2PortriggerRule) {
if (radiosrv[0].checked == true)
txtAppName.value = '';
}
appSelect("0");
}
function btnApply() {
var loc = "form2PortriggerRule.cgi?";
with ( document.form2PortriggerRule) {
if (radiosrv[0].checked == true) {
if (encodeURI(appName) == '') {
alert(NO_SEL_MSG);
return;
}
appName=appName.replace(/(^\s*)/g, "");
appName=appName.replace(/(\s*$)/g, "");
appName=appName.replace(/(\s)/g, "&nbsp;");
loc += '&AppName=' + encodeURI(appName);
}
else {
if (encodeURI(txtAppName.value) == '') {
alert('please input an application name');
return;
}
txtAppName.value=txtAppName.value.replace(/(^\s*)/g, "");
txtAppName.value=txtAppName.value.replace(/(\s*$)/g, "");
txtAppName.value=(txtAppName.value).replace(/(\s)/g, "&nbsp;");
loc += '&AppName=' + encodeURI(txtAppName.value);
}
for (i = 0; i < TOTAL_ROW; i++) {
if (matchPort_s[i].value == "" && matchPort_e[i].value == "" && relatePort_s[i].value == "" && relatePort_e[i].value == "")
break;
if (matchPort_s[i].value == "" || matchPort_e[i].value == "" || relatePort_s[i].value == "" || relatePort_e[i].value == "") {
alert(RE_ALL_MSG);
return;
}
}
if (i == 0) {
alert(RE_ALL_MSG);
return;
}
if (i > remain) {
remain = i - remain;
alert('xxxx' + remain);
remain = 31;
return;
}
tProtoLoc = '&triggerProto=';
tStartLoc = '&matchPort_s=';
tEndLoc = '&matchPort_e=';
oProtoLoc = '&openProto=';
oStartLoc = '&relatePort_s=';
oEndLoc = '&relatePort_e=';
dirLoc = '&dir=';
eCount = i;
for (i = 0; i < eCount; i++) {
if ( isValidPort(matchPort_s[i].value) == false ) {
alert('The start trigger port "' + matchPort_s[i].value + '" is unvalid.');
return;
}
if ( isValidPort(matchPort_e[i].value) == false ) {
alert('The end trigger port"' + matchPort_e[i].value + '" is unvalid.');
return;
}
if ( isValidPort(relatePort_s[i].value) == false ) {
alert('The start relate port "' + relatePort_s[i].value + '" is unvalid.');
return;
}
if ( isValidPort(relatePort_e[i].value) == false ) {
alert('he end relate port"' + relatePort_e[i].value + '" is unvalid.');
return;
}
tS = parseInt(matchPort_s[i].value);
tE = parseInt(matchPort_e[i].value);
if (tS > tE) {
alert('The range of open port [' + tS + '-' + tE + '] is unvalid.');
return;
}
oS = parseInt(relatePort_s[i].value);
oE = parseInt(relatePort_e[i].value);
if ( oS > oE ) {
alert('The range of related port [' + oS + '-' + oE + '] is unvalid.');
return;
}
tStartLoc = tStartLoc + matchPort_s[i].value + ',';
tEndLoc = tEndLoc + matchPort_e[i].value + ',';
tProtoLoc = tProtoLoc + protocol[i].value + ',';
oStartLoc = oStartLoc + relatePort_s[i].value + ',';
oEndLoc = oEndLoc + relatePort_e[i].value + ',';
oProtoLoc = oProtoLoc + oProto[i].value + ',';
dirLoc= dirLoc+dir[i].value+',';
}
}
loc = loc + tStartLoc + tEndLoc + tProtoLoc + oStartLoc + oEndLoc + oProtoLoc+dirLoc+'&submit.htm?nat_portrigger.htm=Send';
var code = 'location="' + loc + '"';
eval(code);
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Port Triggering";
HelpItem="porttriggering";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Nat Portrigger</td>
</tr>
<tr>
<td class="content">

&&*&&en**&**
<p>Some applications require that specific ports in the Router's firewall be opened for access by the remote parties. 
Port Trigger dynamically opens up the "Relate Port" in the firewall when an application on the LAN initiates a TCP/UDP connection to a remote party using the "Match Port".
The Router allows the remote party from the WAN side to establish new connections back to the application on the LAN side using the "Relate Port".</p>
<p>Entries in this table are used to restrict certain types of data packets from your local network to Internet through the Gateway. Use of such filters can be helpful in securing or restricting your local network.</p>
</td>
</tr>
</table>
<form action="form2NatPortriggerStatus.cgi" method=POST name="form2NatPortriggerStatus">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">NAT Port Trigger Status</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Nat Port Trigger:</td>
<td class="form_label_right">
<VWS_FUNCTION (void*)webGetPortriggerStatus();>
 </td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Apply Changes">&nbsp;&nbsp;
<input type="hidden" NAME="submit.htm?nat_portrigger.htm" value="Send">
</form>
<form action="form2PortriggerRule.cgi" name="form2PortriggerRule">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Application Type</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_radio" style="text-align:left"><input type="radio" name="radiosrv" value="0" onClick="radioClick();" checked>Usual Application Name:</td>
<td>
<select onchange=appSelect(this.value) size=1 name=AppName>
<option value=0 selected>Select One</option>
<option value=1>Aim Talk</option>
<option value=2>Asheron's Call</option>
<option value=3>Calista IP Phone</option>
<option value=4>Delta Force (Client/Server)</option>
<option value=5>ICQ</option>
<option value=6>Napster</option>
<option value=7>Net2Phone</option>
<option value=8>QuickTime 4 Client</option>
<option value=9>Rainbow Six/RogueSpea</option>
</select>
</td>
</tr>
<tr>
<td class="form_label_radio" style="text-align:left; width:220px"><input type="radio" name="radiosrv" value="1">User-defined Application Name:</td>
<td><input type="text" size="30" name="txtAppName" maxlength="15"></td>
</tr>
</table>
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<TR align=middle>
<TD class=hd>Start Match Port </TD>
<TD class=hd>End Match Port </TD>
<TD class=hd>Trigger Protocol</TD>
<TD class=hd>Start Relate Port</TD>
<TD class=hd>End Relate Port</TD>
<TD class=hd>Open Protocol</TD>
<TD class=hd>Nat Type</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
<TR>
<TD><INPUT size=7 name=matchPort_s></TD>
<TD><INPUT size=7 name=matchPort_e></TD>
<TD>
<SELECT name=protocol>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD><INPUT size=7 name=relatePort_s></TD>
<TD><INPUT size=7 name=relatePort_e></TD>
<TD>
<SELECT name=oProto>
<OPTION value=1 selected>UDP
<OPTION value=0>TCP
<OPTION value=255>TCP/UDP
</OPTION>
</SELECT>
</TD>
<TD>
<SELECT name=dir>
<OPTION value=0 selected>outgoing
<OPTION value=1 >incoming
</OPTION>
</SELECT>
</TD>
</TR>
</table>
</td>
</tr>
</table>
<input type="button" value="Apply Changes" name="save" onClick="return btnApply();">&nbsp;&nbsp;
</form>
<form method=POST Action="form2PortriggerRuleDelete.cgi">
<INPUT TYPE="HIDDEN" NAME="natType" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="dir" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="triggerproto" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="matchPort_s" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="matchPort_e" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="openproto" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="relatePort_s" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="relatePort_e" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="name" VALUE="" >
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Current Portrigger Table</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500">
<tr class="form_label_row">
<td class="form_label_col">ServerName</td>
<td class="form_label_col">Trigger Protocol</td>
<td class="form_label_col">Direction</td>
<td class="form_label_col">Match Port</td>
<td class="form_label_col">Open Protocol</td>
<td class="form_label_col">Relate Port</td>
<td class="form_label_col">Action</td>
</tr>
<VWS_FUNCTION (void*)showPortriggerTable();>
 </table>
</td>
</tr>
</table>
<br>
<INPUT TYPE="HIDDEN" NAME="submit.htm?nat_portrigger.htm" VALUE="Send" >
</form>
<script language="JavaScript">
function natPortriggerActionFunc( form , natType,dir,triggerproto,matchport_s,matchport_e,openproto,relateport_s,relateport_e,name){
form.elements[0].value=natType;
form.elements[1].value=dir;
form.elements[2].value=triggerproto;
form.elements[3].value=matchport_s;
form.elements[4].value=matchport_e;
form.elements[5].value=openproto;
form.elements[6].value=relateport_s;
form.elements[7].value=relateport_e;
form.elements[8].value=name;
form.submit();
}
</script>
<script>
</script>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@dos.htm@#*&12757
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>DoS Setting </title>
<script>
var dosEnabled=0 ;
var appClick=0;
function setDosEnabled() {
}
function dosEnabledClick(){
if(document.DosCfg.dosEnabled.checked){
enableTextField(document.DosCfg.sysfloodSYN);
enableTextField(document.DosCfg.sysfloodFIN);
enableTextField(document.DosCfg.sysfloodUDP);
enableTextField(document.DosCfg.sysfloodICMP);
enableTextField(document.DosCfg.sysfloodSYNcount);
enableTextField(document.DosCfg.sysfloodFINcount);
enableTextField(document.DosCfg.sysfloodUDPcount);
enableTextField(document.DosCfg.sysfloodICMPcount);
enableTextField(document.DosCfg.ipfloodSYN);
enableTextField(document.DosCfg.ipfloodFIN);
enableTextField(document.DosCfg.ipfloodUDP);
enableTextField(document.DosCfg.ipfloodICMP);
enableTextField(document.DosCfg.ipfloodSYNcount);
enableTextField(document.DosCfg.ipfloodFINcount);
enableTextField(document.DosCfg.ipfloodUDPcount);
enableTextField(document.DosCfg.ipfloodICMPcount);
enableTextField(document.DosCfg.TCPUDPPortScan);
enableTextField(document.DosCfg.portscanSensi);
enableTextField(document.DosCfg.ICMPSmurfEnabled);
enableTextField(document.DosCfg.IPLandEnabled);
enableTextField(document.DosCfg.IPSpoofEnabled);
enableTextField(document.DosCfg.IPTearDropEnabled);
enableTextField(document.DosCfg.PingOfDeathEnabled);
enableTextField(document.DosCfg.TCPScanEnabled);
enableTextField(document.DosCfg.TCPSynWithDataEnabled);
enableTextField(document.DosCfg.UDPBombEnabled);
enableTextField(document.DosCfg.UDPEchoChargenEnabled);
enableTextField(document.DosCfg.sourceIPblock);
enableTextField(document.DosCfg.IPblockTime);
}
else{
disableTextField(document.DosCfg.sysfloodSYN);
disableTextField(document.DosCfg.sysfloodFIN);
disableTextField(document.DosCfg.sysfloodUDP);
disableTextField(document.DosCfg.sysfloodICMP);
disableTextField(document.DosCfg.sysfloodSYNcount);
disableTextField(document.DosCfg.sysfloodFINcount);
disableTextField(document.DosCfg.sysfloodUDPcount);
disableTextField(document.DosCfg.sysfloodICMPcount);
disableTextField(document.DosCfg.ipfloodSYN);
disableTextField(document.DosCfg.ipfloodFIN);
disableTextField(document.DosCfg.ipfloodUDP);
disableTextField(document.DosCfg.ipfloodICMP);
disableTextField(document.DosCfg.ipfloodSYNcount);
disableTextField(document.DosCfg.ipfloodFINcount);
disableTextField(document.DosCfg.ipfloodUDPcount);
disableTextField(document.DosCfg.ipfloodICMPcount);
disableTextField(document.DosCfg.TCPUDPPortScan);
disableTextField(document.DosCfg.portscanSensi);
disableTextField(document.DosCfg.ICMPSmurfEnabled);
disableTextField(document.DosCfg.IPLandEnabled);
disableTextField(document.DosCfg.IPSpoofEnabled);
disableTextField(document.DosCfg.IPTearDropEnabled);
disableTextField(document.DosCfg.PingOfDeathEnabled);
disableTextField(document.DosCfg.TCPScanEnabled);
disableTextField(document.DosCfg.TCPSynWithDataEnabled);
disableTextField(document.DosCfg.UDPBombEnabled);
disableTextField(document.DosCfg.UDPEchoChargenEnabled);
disableTextField(document.DosCfg.sourceIPblock);
disableTextField(document.DosCfg.IPblockTime);
}
}
function SelectAll(){
if(document.DosCfg.dosEnabled.checked){
document.DosCfg.sysfloodSYN.checked=1;
document.DosCfg.sysfloodFIN.checked=1;
document.DosCfg.sysfloodUDP.checked=1;
document.DosCfg.sysfloodICMP.checked=1;
document.DosCfg.ipfloodSYN.checked=1;
document.DosCfg.ipfloodFIN.checked=1;
document.DosCfg.ipfloodUDP.checked=1;
document.DosCfg.ipfloodICMP.checked=1;
document.DosCfg.TCPUDPPortScan.checked=1;
document.DosCfg.ICMPSmurfEnabled.checked=1;
document.DosCfg.IPLandEnabled.checked=1;
document.DosCfg.IPSpoofEnabled.checked=1;
document.DosCfg.IPTearDropEnabled.checked=1;
document.DosCfg.PingOfDeathEnabled.checked=1;
document.DosCfg.TCPScanEnabled.checked=1;
document.DosCfg.TCPSynWithDataEnabled.checked=1;
document.DosCfg.UDPBombEnabled.checked=1;
document.DosCfg.UDPEchoChargenEnabled.checked=1;
}
}
function ClearAll(){
if(document.DosCfg.dosEnabled.checked){
document.DosCfg.sysfloodSYN.checked=0;
document.DosCfg.sysfloodFIN.checked=0;
document.DosCfg.sysfloodUDP.checked=0;
document.DosCfg.sysfloodICMP.checked=0;
document.DosCfg.ipfloodSYN.checked=0;
document.DosCfg.ipfloodFIN.checked=0;
document.DosCfg.ipfloodUDP.checked=0;
document.DosCfg.ipfloodICMP.checked=0;
document.DosCfg.TCPUDPPortScan.checked=0;
document.DosCfg.ICMPSmurfEnabled.checked=0;
document.DosCfg.IPLandEnabled.checked=0;
document.DosCfg.IPSpoofEnabled.checked=0;
document.DosCfg.IPTearDropEnabled.checked=0;
document.DosCfg.PingOfDeathEnabled.checked=0;
document.DosCfg.TCPScanEnabled.checked=0;
document.DosCfg.TCPSynWithDataEnabled.checked=0;
document.DosCfg.UDPBombEnabled.checked=0;
document.DosCfg.UDPEchoChargenEnabled.checked=0;
}
}
function checkPS(num)
{
if (num.value=="") {
alert("It cannot be empty!");
num.value = num.defaultValue;
num.focus();
return false;
}
if ( validateKey( num.value ) == 0 ) {
alert("Invalid value. It should be the decimal number (0-9).");
num.value = num.defaultValue;
num.focus();
return false;
}
return true;
}
function saveChanges()
{
if(document.DosCfg.sysfloodSYN.checked)
{
if(!checkPS(document.DosCfg.sysfloodSYNcount))
{
return false;
}
}
if(appClick==0)
{
appClick=1;
}
else
{
alert("The request is in process, please wait a few seconds!");
return false;
}
return true;
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="DOS Settings";
HelpItem="dos";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">DoS Settings</td>
</tr>
<tr>
<td class="content">
<p>A "denial-of-service" (DoS) attack is characterized by an explicit attempt by hackers to prevent legitimate users of a service from using that service.</p>
</td>
</tr>
</table>
<form action="form2DosCfg.cgi" method=POST name="DosCfg">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">DoS Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<input type="checkbox" name="dosEnabled" value="ON" onclick="dosEnabledClick()"
<VWS_SCREEN (char*) xscrndosEnabled[];>
>&nbsp;&nbsp;<font size=2><b>Enable DoS Prevention</b></font>
<div style=
"display:block"
>
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodSYN" value="ON"
<VWS_SCREEN (char*) xscrnsysfloodSYN[];>
 > <font size=2><b> Whole System Flood: SYN </b></font><br></td>
<td width="40%"><input type="text" name="sysfloodSYNcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnsysfloodSYNcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodFIN" value="ON"
<VWS_SCREEN (char*) xscrnsysfloodFIN[];>
 > <font size=2><b> Whole System Flood: FIN </b></font><br></td>
<td width="40%"><input type="text" name="sysfloodFINcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnsysfloodFINcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodUDP" value="ON"
<VWS_SCREEN (char*) xscrnsysfloodUDP[];>
 > <font size=2><b> Whole System Flood: UDP </b></font><br></td>
<td width="40%"><input type="text" name="sysfloodUDPcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnsysfloodUDPcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodICMP" value="ON"
<VWS_SCREEN (char*) xscrnsysfloodICMP[];>
 > <font size=2><b> Whole System Flood: ICMP </b></font><br></td>
<td width="40%"><input type="text" name="sysfloodICMPcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnsysfloodICMPcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodSYN" value="ON"
<VWS_SCREEN (char*) xscrnipfloodSYN[];>
 > <font size=2><b> Per-Source IP Flood: SYN </b></font><br></td>
<td width="40%"><input type="text" name="ipfloodSYNcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnipfloodSYNcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodFIN" value="ON"
<VWS_SCREEN (char*) xscrnipfloodFIN[];>
 > <font size=2><b> Per-Source IP Flood: FIN </b></font><br></td>
<td width="40%"><input type="text" name="ipfloodFINcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnipfloodFINcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodUDP" value="ON"
<VWS_SCREEN (char*) xscrnipfloodUDP[];>
 > <font size=2><b> Per-Source IP Flood: UDP </b></font><br></td>
<td width="40%"><input type="text" name="ipfloodUDPcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnipfloodUDPcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodICMP" value="ON"
<VWS_SCREEN (char*) xscrnipfloodICMP[];>
 > <font size=2><b> Per-Source IP Flood: ICMP </b></font><br></td>
<td width="40%"><input type="text" name="ipfloodICMPcount" size="6" maxlength="4" value=
<VWS_SCREEN (char*) xscrnipfloodICMPcount[];>
 > <font size=2><b> Packets/Second</b></font><br></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="TCPUDPPortScan" value="ON"
<VWS_SCREEN (char*) xscrnTCPUDPPortScan[];>
 > <font size=2><b> TCP/UDP PortScan </b></font></td>
<td width="40%">
<select name="portscanSensi">
<VWS_SCREEN (char*) xscrnportscanSensi[];>
 </select>
<font size=2><b> Sensitivity </b></font></td>
</tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ICMPSmurfEnabled" value="ON"
<VWS_SCREEN (char*) xscrnICMPSmurf[];>
 > <font size=2><b> ICMP Smurf </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="IPLandEnabled" value="ON"
<VWS_SCREEN (char*) xscrnIPLand[];>
 > <font size=2><b> IP Land </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="IPSpoofEnabled" value="ON"
<VWS_SCREEN (char*) xscrnIPSpoof[];>
 > <font size=2><b> IP Spoof </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="IPTearDropEnabled" value="ON"
<VWS_SCREEN (char*) xscrnIPTearDrop[];>
 > <font size=2><b> IP TearDrop </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="PingOfDeathEnabled" value="ON"
<VWS_SCREEN (char*) xscrnPingOfDeath[];>
 > <font size=2><b> PingOfDeath </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="TCPScanEnabled" value="ON"
<VWS_SCREEN (char*) xscrnTCPScan[];>
 > <font size=2><b> TCP Scan </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="TCPSynWithDataEnabled" value="ON"
<VWS_SCREEN (char*) xscrnTCPSynWithData[];>
 > <font size=2><b> TCP SynWithData </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="UDPBombEnabled" value="ON"
<VWS_SCREEN (char*) xscrnUDPBomb[];>
 > <font size=2><b> UDP Bomb </b></font></td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="UDPEchoChargenEnabled" value="ON"
<VWS_SCREEN (char*) xscrnUDPEchoChargen[];>
 > <font size=2><b> UDP EchoChargen </b></font></td></tr>
<tr>
<td colspan="2">
<input type="button" value=" Select ALL " name="selectAll" onClick="SelectAll()">&nbsp;&nbsp;
<input type="button" value=" Clear ALL " name="clearAll" onClick="ClearAll()">&nbsp;&nbsp;
</td>
</tr>
<tr>
<td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sourceIPblock" value="ON"
<VWS_SCREEN (char*) xscrnsourceIPblock[];>
> <font size=2><b> Enable Source IP Blocking </b></font></td>
<td width="40%"><input type="text" name="IPblockTime" size="4" maxlength="3" value=
<VWS_SCREEN (char*) xscrnIPblockTime[];>
> <font size=2><b> Block time (sec)</b></font><br>
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
<br>
<input type="hidden" name="submit.htm?dos.htm" VALUE="Send">
<input type="submit" value="Apply Changes" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
<script>
dosEnabledClick();
</script>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</table>
</body>
</html>

&*#@fw-natmapping.htm@#*&6312
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>NAT IP MAPPING</title>
<script>
function checkIpRangeValid(lowipstr,highipstr)
{
if((getDigit(lowipstr,1)>getDigit(highipstr,1))) return -2;
if((getDigit(lowipstr,2)>getDigit(highipstr,2))) return -2;
if((getDigit(lowipstr,3)>getDigit(highipstr,3))) return -2;
if((getDigit(lowipstr,4)>getDigit(highipstr,4))) return -2;
return true;
}
function addClick()
{
with(document.formNatmappingSetting){
if (lowip.value=="")return false;
if(!checkIP(lowip)) return false;
if(highip.value!=""){
if(!checkIP(highip))return false;
var checkre=checkIpRangeValid(lowip.value,highip.value);
if(checkre==-2){
alert("The high ip should be bigger than the low ip!");
return false;
}
}
if (mappinglowip.value=="")return false;
if(!checkIP(mappinglowip)) return false;
if(mappinghighip.value!=""){
if(!checkIP(mappinghighip))return false;
var checkre=checkIpRangeValid(mappinglowip.value,mappinghighip.value);
if(checkre==-2){
alert("The high ip should be bigger than the low ip!");
return false;
}
}
return true;
}
}
function checkState()
{
if ( document.formNatmappingSetting.addressMapType.selectedIndex == 0 ) {
enableTextField(document.formNatmappingSetting.lowip);
disableTextField(document.formNatmappingSetting.highip);
enableTextField(document.formNatmappingSetting.mappinglowip);
disableTextField(document.formNatmappingSetting.mappinghighip);
} else if ( document.formNatmappingSetting.addressMapType.selectedIndex == 1 ) {
enableTextField(document.formNatmappingSetting.lowip);
enableTextField(document.formNatmappingSetting.highip);
enableTextField(document.formNatmappingSetting.mappinglowip);
disableTextField(document.formNatmappingSetting.mappinghighip);
} else if ( document.formNatmappingSetting.addressMapType.selectedIndex == 2 ) {
enableTextField(document.formNatmappingSetting.lowip);
enableTextField(document.formNatmappingSetting.highip);
enableTextField(document.formNatmappingSetting.mappinglowip);
enableTextField(document.formNatmappingSetting.mappinghighip);
} else if ( document.formNatmappingSetting.addressMapType.selectedIndex == 3 ) {
enableTextField(document.formNatmappingSetting.lowip);
disableTextField(document.formNatmappingSetting.highip);
enableTextField(document.formNatmappingSetting.mappinglowip);
enableTextField(document.formNatmappingSetting.mappinghighip);
}
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body onLoad="checkState();">
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="NAT";
HelpItem="natipmapping";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>NAT IP MAPPING</td>
</tr>
<tr>
<td class=content>
<p>Entries in this table allow you to config one IP pool for specified source ip address from lan,so
one packet which's source ip is in range of the specified address will select one IP address from pool for NAT.
</p>
</td>
</tr>
</table>
<br>
<form action="form2natmapping.cgi" method=POST name="formNatmappingSetting">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Setting</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class='form_label_left'>
Type
</td>
<td class='form_label_right'>
<select size="1" name="addressMapType" onChange="checkState()">
<option value=1>One-to-One</option>
<option value=2>Many-to-One</option>
<option value=3>Many-to-Many</option>
<option value=4>One-to-Many</option>
</select>
</td>
</tr>
<tr>
<td class='form_label_left'>
Local Start IP
</td>
<td class='form_label_right'>
<INPUT TYPE="TEXT" NAME="lowip" SIZE="15" MAXLENGTH="15" VALUE="" >
</td>
</tr>
<tr>
<td class='form_label_left'>
Local End IP
</td>
<td class='form_label_right'>
<INPUT TYPE="TEXT" NAME="highip" SIZE="15" MAXLENGTH="15" VALUE="" >
</td>
</tr>
<tr>
<td class='form_label_left'>
Global Start IP
</td>
<td class='form_label_right'>
<INPUT TYPE="TEXT" NAME="mappinglowip" SIZE="15" MAXLENGTH="15" VALUE="" >
</td>
</tr>
<tr>
<td class='form_label_left'>
Global End IP
</td>
<td class='form_label_right'>
<INPUT TYPE="TEXT" NAME="mappinghighip" SIZE="15" MAXLENGTH="15" VALUE="" >
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Apply Changes" onClick="return addClick()">&nbsp;&nbsp;
<input type="reset" value="Reset" name="reset">&nbsp;&nbsp;
<input type="hidden" name="submit.htm?fw-natmapping.htm" VALUE="Send">
</form>
<form method=POST Action="form2natmappingdel.cgi" name="form2natmappingdel">
<INPUT TYPE="HIDDEN" NAME="actiontype" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="state" VALUE="" >
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Current NAT IP MAPPING Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row >
<td class='form_label_col' >
Local Start IP
</td>
<td class='form_label_col' >
Local End IP
</td>
<td class='form_label_col' >
Global Start IP
</td>
<td class='form_label_col' >
Global End IP
</td>
<td class='form_label_col' >
Action
</td>
</tr>
<VWS_FUNCTION (void*)showNatMappingTable();>
 </table>
</td>
</tr>
</table>
<br>
<INPUT TYPE="HIDDEN" NAME="deleteindex" VALUE="" >
<input type="submit" value="Delete Selected" onClick="deleteSelectClick()">
<INPUT onClick="return deleteAllClick()" type=submit value="Delete All" name=deleteAllAddressMap>
<INPUT TYPE="HIDDEN" NAME="submit.htm?fw-natmapping.htm" VALUE="Send" >
</form>
<script language="JavaScript">
<!--
function deleteSelectClick()
{
with(document){
var deleteindexobj=form2natmappingdel.deleteindex;
var i=0;
while(1){
var objname='select'+i;
if(!getElementById(objname))
break;
if(getElementById(objname).checked)
{
if(deleteindexobj.value.length)
deleteindexobj.value=deleteindexobj.value+','+i;
else
deleteindexobj.value=i;
}
i++;
}
}
}
function natActionFunc( form , actiontype, natcmd, state){
form.elements[0].value=actiontype;
form.elements[1].value=natcmd;
form.elements[2].value=state;
form.submit();
}
</script>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@lan_ipv6.htm@#*&15110
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>LAN IPv6 Setup</title>
<SCRIPT>
function ramodechange(obj)
{
with ( document.forms[0] )
{
if(obj.value == "0")
{
raSetup.style.display = "none";
}
else
{
raSetup.style.display = "block";
}
}
}
function dhcp6modechang() {
var idx = $('dhcp6mode').selectedIndex;
if (idx == 1) {
$('dhcp6server_block').style.display="block";
$('dhcp6Autoserver_block').style.display="none";
$('lan_dhcp_dns').style.display="block";
dhcp6manualmodechang();
dns_mode_selection();
}else if (idx == 2) {
$('dhcp6server_block').style.display="none";
$('dhcp6Autoserver_block').style.display="block";
$('lan_dhcp_dns').style.display="block";
dns_mode_selection();
}
else{
$('dhcp6server_block').style.display="none";
$('dhcp6Autoserver_block').style.display="none";
$('lan_dhcp_dns').style.display="none";
}
}
function dhcp6manualmodechang() {
var idx = $('manualmode').selectedIndex;
if (idx == 1)
$('dhcp6manual_block').style.display="inline";
else
$('dhcp6manual_block').style.display="none";
}
function dns_mode_selection()
{
if (document.dhcp6d.dhcp_dns_mode.value == 0)
{
document.getElementById('lan_dhcp_dns_setting').style.display = 'none';
}
else
{
document.getElementById('lan_dhcp_dns_setting').style.display = '';
}
}
function dhcpv6saveChanges() {
var idx = $('dhcp6mode').selectedIndex;
if (idx == 1)
{
var ipv6s = new Array;
ipv6s = [
['dhcp6dPoolS', 'DHCPV6 Pool Start Address', 1],
['dhcp6dPoolE', 'DHCPV6 Pool End Address', 0],
['dns1', 'DNS Server 1', 0],
['dns2', 'DNS Server 2', 0],
['dns3', 'DNS Server 3', 0]
];
for (var i = 0; i < ipv6s.length; i++) {
if ($(ipv6s[i][0]).value == '' && ipv6s[i][2]) {
alert(ipv6s[i][1] + ' can not be empty!');
return false;
}
if ($(ipv6s[i][0]).value != '' && !isIpv6Address($(ipv6s[i][0]).value)) {
alert(ipv6s[i][1] + ' is invalid!');
$(ipv6s[i][0]).focus();
return false;
}
}
var nums = new Array;
nums = [
['pltime', 'Preferred Time ', 1],
['vltime', 'Valid Time', 1],
['prefixlength', 'Prefix Length', 1]
];
for (var i = 0; i < nums.length; i++) {
if (!isNumber($(nums[i][0]).value)) {
alert('Please input a valid number for ' + nums[i][1]);
$(nums[i][0]).focus();
return false;
}
}
if (parseInt($('vltime').value) < parseInt($('pltime').value)) {
alert("Valid Time must be larger than Preferred Time!");
return false;
}
if (parseInt($('prefixlength').value) < 16 || parseInt($('prefixlength').value) > 64) {
alert("Prefix Length should be between 16 and 64!");
return false;
}
return true;
}else if(idx == 2)
{
var ipv6a = new Array;
ipv6a = [
['dhcp6dSuffixPoolS', 'DHCPV6 Auto Suffix Pool Start Address', 1],
['dhcp6dSuffixPoolE', 'DHCPV6 Auto Suffix Pool End Address', 1]
];
for (var i = 0; i < ipv6a.length; i++) {
if ($(ipv6a[i][0]).value == '' && ipv6a[i][2]) {
alert(ipv6a[i][1] + ' can not be empty!');
return false;
}
if ($(ipv6a[i][0]).value != '' && !isIpv6Address('2001:FFFF:FFFF:FFFF'+$(ipv6a[i][0]).value)) {
alert(ipv6a[i][1] + ' is invalid!');
$(ipv6a[i][0]).focus();
return false;
}
}
var ipv6s = new Array;
ipv6s = [
['dns1', 'DNS Server 1', 0],
['dns2', 'DNS Server 2', 0],
['dns3', 'DNS Server 3', 0]
];
for (var i = 0; i < ipv6s.length; i++) {
if ($(ipv6s[i][0]).value == '' && ipv6s[i][2]) {
alert(ipv6s[i][1] + ' can not be empty!');
return false;
}
if ($(ipv6s[i][0]).value != '' && !isIpv6Address($(ipv6s[i][0]).value)) {
alert(ipv6s[i][1] + ' is invalid!');
$(ipv6s[i][0]).focus();
return false;
}
}
}else
return true;
}
function lansaveChangesv6() {
if (document.tcpip6.ip6.value == "") {
alert("Please input address!");
document.tcpip6.ip6.focus();
return false;
}
if (!isIpv6Address(document.tcpip6.ip6.value)) {
alert("Invalid address.");
document.tcpip6.ip6.focus();
return false;
}
if (!isLinkLocalIpv6Address(document.tcpip6.ip6.value)) {
alert("Please input link-local address!");
document.tcpip6.ip6.focus();
return false;
}
return true;
}
function RATypeClick() {
if(document.ra.raEnable.checked == true) {
document.getElementById('raParameter').style.display = 'block';
document.getElementById('raMode').style.display = 'block';
document.getElementById('raSetup').style.display = 'block';
if($("prefixmode").selectedIndex==0)
document.getElementById('raSetup').style.display = 'none';
else
document.getElementById('raSetup').style.display = 'block';
}else{
document.getElementById('raParameter').style.display = 'none';

&&*&&en**&**
document.getElementById('raMode').style.display = 'none';
document.getElementById('raSetup').style.display = 'none';
}
}
function rasaveChangesv6() {
if (document.ra.raEnable.checked == true) {
var max = getDigit(document.ra.radvdMaxInter.value, 1);
var min = getDigit(document.ra.radvdMinInter.value, 1);
if (max < 4 || max > 1800) {
alert("Max Interval should be between 4 and 1800!");
document.ra.radvdMaxInter.focus();
return false;
}
if (min < 3 || min > (max * 3 / 4)) {
alert("Min Interval should be between 3 and 3/4*(Max Interval)!");
document.ra.radvdMinInter.focus();
return false;
}
if (document.ra.prefixmode.value == "1") {
if (document.ra.radvdPrefix.value == "") {
alert("Please input Prefix Address!");
document.ra.radvdPrefix.focus();
return false;
}
if (!isIpv6Address(document.ra.radvdPrefix.value)) {
alert("Invalid Prefix Address.");
document.ra.radvdPrefix.focus();
return false;
}
if (!isGlobalIpv6Address(document.ra.radvdPrefix.value)) {
alert("Invalid Prefix Address.");
document.ra.radvdPrefix.focus();
return false;
}
var prefixlen = getDigit(document.ra.RAPrefixLen.value, 1);
if (prefixlen > 64 || prefixlen < 16) {
alert("Wrong Prefix Length!");
document.ra.RAPrefixLen.focus();
return false;
}
var rat1 = getDigit(document.ra.RAt1.value, 1);
if (rat1 > 2147483647 || rat1 < 600) {
if(rat1!=-1)
{
alert("Wrong Preferred Time!");
document.ra.RAt1.focus();
return false;
}
}
var rat2 = getDigit(document.ra.RAt2.value, 1);
if (rat2 > 2147483647 || rat2 < 600) {
if(rat2!=-1)
{
alert("Wrong Valid Time!");
document.ra.RAt2.focus();
return false;
}
}
if(rat1==-1){
rat1=4294967295;
}
if(rat2==-1){
rat2=4294967295;
}
if (rat2 < rat1) {
alert("Valid Time should be larger than Preferred Time!");
document.ra.RAt2.focus();
return false;
}
}
}
return true;
}
function lansaveChangesv6() {
if (document.lanv6addr.ipaddr.value != "") {
if (!isIpv6Address(document.lanv6addr.ipaddr.value)) {
alert("Invalid address.");
document.lanv6addr.ipaddr.focus();
return false;
}
if (isLinkLocalIpv6Address(document.lanv6addr.ipaddr.value)) {
alert("Please input global address!");
document.lanv6addr.ipaddr.focus();
return false;
}
if (document.lanv6addr.prefixlen.value == "") {
alert("Prefixlen can't be empty!");
document.lanv6addr.prefixlen.focus();
return false;
}
var rat1 = getDigit(document.lanv6addr.prefixlen.value, 1);
if (rat1 >= 128 || rat1 <= 0) {
alert("Wrong Prefix Length!");
document.lanv6addr.prefixlen.focus();
return false;
}
}
return true;
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Local Network";
HelpItem="IPV6Set";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">LAN IPv6 Setting</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configurate ipv6 lan setting.
User can set lan RA server work mode and lan DHCPv6
server work mode.</p>
</td>
</tr>
</table>
<br >
<form action="form2Lanv6.cgi" method=POST name="lanv6addr">
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Lan Global Address Setting</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">Global Address:</td>
<td class="form_label_right" width="300"><INPUT TYPE="TEXT" NAME="ipaddr" SIZE="32" MAXLENGTH="64"
<VWS_FUNCTION (void*)lanGlobalAddr();>
 > / <input type="text" size="5" name="prefixlen"
<VWS_FUNCTION (void*)lanGlobalprefix();>
 ></td>
<tr>
</table>
</td>
</tr>
</table>
</br>
<input type="submit" value="Apply Changes" onClick="return lansaveChangesv6()">
<input type="hidden" value="Send" name="submit.htm?lan_ipv6.htm">
</form>
<form action="form2RAsetupv6.cgi" method=POST name="ra">
<table id="body_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">RA Setting</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">Enable:</td>
<td class="form_label_right"><input type="checkbox" onclick="RATypeClick()" name="raEnable"
<VWS_FUNCTION (void*)httpIsRAenable();>
 ></td>
</tr>
</table>
<table id='raParameter' style="display:none" class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">M Flag:</td>
<td class="form_label_right"><input type="checkbox" name="MEnable"
<VWS_FUNCTION (void*)httpIsMenable();>
 >
</td>
</tr>
<tr>
<td class="form_label_left">O Flag:</td>
<td class="form_label_right"><input type="checkbox" name="OEnable"
<VWS_FUNCTION (void*)httpIsOenable();>
 >
</td>
</tr>
<tr>
<td class="form_label_left">Max Interval:</td>
<td class="form_label_right">
<input type="text" maxlength="39" name="radvdMaxInter" value=
<VWS_SCREEN (char*) xscrnRALanMaxInter[];>
 > Secs
</td>
</tr>
<tr>
<td class="form_label_left">Min Interval:</td>
<td class="form_label_right"><input type="text" maxlength="39" name="radvdMinInter" value=
<VWS_SCREEN (char*) xscrnRALanMinInter[];>
 > Secs
</td>
</tr>
</table>
<table id='raMode' style="display:none" class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">Prefix Mode:</td>
<td class="form_label_right">
<select onchange="ramodechange(this)" id="prefixmode" name="prefixmode" size="1">
<VWS_SCREEN (char*) xscrnRaMode[];>
 </select>
</td>
</tr>
</table>
<table id='raSetup' style="display:none" class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr id='NamePrefix'>
<td class="form_label_left">Prefix Address:</td>
<td class="form_label_right">
<input type="text" name="radvdPrefix" maxlength="39" value=
<VWS_SCREEN (char*) xscrnRALanPrefix[];>
 >
</td>
</tr>
<tr id='NamePrefixLen'>
<td class="form_label_left">Prefix Length:</td>
<td class="form_label_right">
<input type="text" name="RAPrefixLen" maxlength="2" value=
<VWS_SCREEN (char*) xscrnRALanPrefixLen[];>
 >
[16 - 64]
</td>
</tr>
<tr id='NameRAt1'>
<td class="form_label_left">Preferred Time:</td>
<td class="form_label_right">
<input type="text" name="RAt1" maxlength="10" value=
<VWS_SCREEN (char*) xscrnRALanPtime[];>
 >
[600 - 2147483647 S] or [-1 S]
</td>
</tr>
<tr id='NameRAt2'>
<td class="form_label_left">Valid Time:</td>
<td class="form_label_right">
<input type="text" name="RAt2" maxlength="10" value=
<VWS_SCREEN (char*) xscrnRALanVtime[];>
 >
[600 - 2147483647 S] or [-1 S]
</td>
</tr>
</table>
<br>
</td>
</tr>
</table>
<br>
<input type="submit" onClick="return rasaveChangesv6()" value="Apply Changes">
<input type="hidden" value="Send" name="submit.htm?lan_ipv6.htm">
</form>
<form action="form2Dhcp6d.cgi" method=POST name="dhcp6d">
<table id="body_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">DHCPv6 Setting</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">DHCPv6 Mode:</td>
<td class="form_label_right">
<select onchange="dhcp6modechang()" id="dhcp6mode" name="dhcp6mode" size="1">
<VWS_SCREEN (char*) xscrnDhcp6dMode[];>
 </select>
</td>
</tr>
</table>
<table id='dhcp6server_block' style="display:none" class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">Address Mode:</td>
<td class="form_label_right">
<select size="1" name="manualmode" id="manualmode"
onChange="dhcp6manualmodechang()">
<VWS_SCREEN (char*) xscrnDhcp6dManualMode[];>
 </select>
</td>
</tr>
<tr>
<td class="form_label_left">IPv6 Address Pool:</td>
<td class="form_label_right">
<input type="text" name="dhcp6dPoolS" id="dhcp6dPoolS" value=
<VWS_SCREEN (char*) xscrnDhcp6dPoolS[];>
 >
<div id="dhcp6manual_block" style="display:inline;">
-
<input type="text" name="dhcp6dPoolE" id="dhcp6dPoolE" value=
<VWS_SCREEN (char*) xscrnDhcp6dPoolE[];>
 >&nbsp;
</div>
</td>
</tr>
<tr id="Basic14">
<td class="form_label_left">Prefix Length:</td>
<td class="form_label_right">
<input type="text" name="prefixlength" id="prefixlength" size=10 maxlength=3 value=
<VWS_SCREEN (char*) xscrnDhcp6dPrefixLength[];>
 >
</td>
</tr>
<tr id="Basic12">
<td class="form_label_left">Preferred Time:</td>
<td class="form_label_right">
<input type="text" name="pltime" id="pltime" size=10 maxlength=9 value=
<VWS_SCREEN (char*) xscrnDhcp6dPltime[];>
 > Secs
</td>
</tr>
<tr id="Basic13">
<td class="form_label_left">Valid Time:</td>
<td class="form_label_right">
<input type="text" name="vltime" id="vltime" size=10 maxlength=9 value=
<VWS_SCREEN (char*) xscrnDhcp6dVltime[];>
 > Secs
</td>
</tr>
</table>
<table id='dhcp6Autoserver_block' style="display:none" class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">IPv6 Address Suffix Pool:</td>
<td class="form_label_right">
<input type="text" name="dhcp6dSuffixPoolS" id="dhcp6dSuffixPoolS" value=
<VWS_SCREEN (char*) xscrnDhcp6dSuffixPoolS[];>
 >
-
<input type="text" name="dhcp6dSuffixPoolE" id="dhcp6dSuffixPoolE" value=
<VWS_SCREEN (char*) xscrnDhcp6dSuffixPoolE[];>
 >&nbsp;
(ex. :1:1:1:1 or ::1)
</td>
</tr>
</table>
<table id='lan_dhcp_dns' style="display:none" class="formarea" border="0" cellpadding="0" cellspacing="0" width="450">
<tr>
<td class="form_label_left">IPv6 DNS Mode:</td>
<td class="form_label_right">
<select size="1" name="dhcp_dns_mode" onChange="dns_mode_selection()">
<OPTION VALUE="0" > Auto</OPTION>
<OPTION VALUE="1" > Manual</OPTION>
</select>
</td>
</tr>
<tr id="lan_dhcp_dns_setting">
<td class="form_label_left">DNS Servers:</td>
<td class="form_label_right">
<input type="text" name="dns1" id="dns1" size=22 maxlength=64 value=
<VWS_SCREEN (char*) xscrnDhcp6ddns1[];>
 >
<input type="text" name="dns2" id="dns2" size=22 maxlength=64 value=
<VWS_SCREEN (char*) xscrnDhcp6ddns2[];>
 >
<input type="text" name="dns3" id="dns3" size=22 maxlength=64 value=
<VWS_SCREEN (char*) xscrnDhcp6ddns3[];>
 >
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" name="save" onClick="return dhcpv6saveChanges()" value="Apply Changes">
<INPUT TYPE="hidden" NAME="submit.htm?lan_ipv6.htm" VALUE="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
<script>
<VWS_FUNCTION (void*)init_dnsv6_setting();>
 dhcp6modechang();
RATypeClick();
if (document.ra.RAPrefixLen.value == '0')
document.ra.RAPrefixLen.value = '';
if (document.ra.RAt1.value == '0')
document.ra.RAt1.value = '';
if (document.ra.RAt2.value == '0')
document.ra.RAt2.value = '';
</script>
</html>

&*#@routing_v6.htm@#*&4860
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>IPv6 Routing Configuration </title>
<SCRIPT>
//IPv6
function addClick()
{
if (document.route.destNet.value=="") {
alert("Please input Destination Address!");
document.route.destNet.focus();
return false;
}
if (! isIpv6Address( document.route.destNet.value)) {
alert("Invalid Destination Address.");
document.route.destNet.focus();
return false;
}
if (document.route.prefixLen.value=="") {
alert("Please input Prefix Length!");
document.route.prefixLen.focus();
return false;
}
if (validateKey(document.route.prefixLen.value) == 0) {
alert("Wrong Prefix Length!");
document.route.prefixLen.focus();
return false;
}	
var prefixlen= getDigit(document.route.prefixLen.value, 1);
if (prefixlen > 128 || prefixlen < 0) {
alert("Wrong Prefix Length!");
document.route.prefixLen.focus();
return false;
}
if (document.route.nextHop.value != "") {
if (! isIpv6Address( document.route.nextHop.value)) {
alert("Invalid Next Hop Address.");
document.route.nextHop.focus();
return false;
}
if (!isUnicastIpv6Address(document.route.nextHop.value))
{
alert("Wrong Next Hop!");
document.route.nextHop.focus();
return false;
}
if (isLinkLocalIpv6Address(document.route.nextHop.value))
{
if(document.getElementsByName("interface")[0].value==""){
alert("Please select one interface!");
document.route.interface.focus();
return false;
}
}
}else {
if(document.getElementsByName("interface")[0].value==""){
alert("Please select one interface!");
document.route.interface.focus();
return false;	
}
}
return true;
}
function postRoutingV6(destip,prefixlen, nextip, itf)
{
document.route.destNet.value = destip;
document.route.nextHop.value = nextip;
document.route.prefixLen.value = prefixlen;
document.route.interface.value = itf;
}
function  delRuleCheck()
{
if(document.route.select.length)
{
for(i=0;i<document.route.select.length;i++)   
{ 
if(document.route.select[i].checked)
return deleteClick();
}
}else
{
if(document.route.select.checked)
return deleteClick();
}
alert("Please select the entry to be deleted!"); 
return false; 
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" alink="#000000" link="#000000" vlink="#000000">
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Routing";
HelpItem="IPv6Routing";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>IPv6 Routing Configuration</td>
</tr>
<tr>
<td class=content>
<p> This page is used to configure the ipv6 routing information. Here you can add/delete
IPv6 routes.
</p>
</td>
</tr>
</table>
<br>
<form action="form2RoutingV6.cgi" method=POST name="route">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class='form_label_left' align =left width="20%">
Destination
</td>
<td class='form_label_right' align =left width="80%">
<input type="text" name="destNet" size="32" maxlength="64">
</td>
</tr>
<tr>
<td class='form_label_left' align =left width="20%">
Prefix Length
</td>
<td class='form_label_right' align =left width="80%">
<input type="text" name="prefixLen" size="32" maxlength="5">
</td>
</tr>
<tr>
<td class='form_label_left' align =left width="20%">
Next Hop
</td>
<td class='form_label_right' align =left width="80%">
<input type="text" name="nextHop" size="32" maxlength="64">
</td>
</tr>
<tr>
<td class='form_label_left' align =left width="20%">
Interface
</td>
<td class='form_label_right' align =left width="80%">
<VWS_SCREEN (char*)xscrnRoutingv6If[];>
 </td>
</tr>
</table> 
</td>
</tr>
</table>
<br>
<input type="submit" value="Add Route" name="addRoute" onClick="return addClick()">&nbsp;&nbsp;
<input type="submit" value="Delete Selected" name="delRoute" onClick="return delRuleCheck()">&nbsp;&nbsp;
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>IPv6 Static Route Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row>
<td class='form_label_col' align =left width="5%">
Select
</td>
<td class='form_label_col' align =left width="8%">
Destination
</td>
<td class='form_label_col' align =left width="8%">
NextHop
</td>
<td class='form_label_col' align =left width="8%">
Interface
</td>
</tr>
<VWS_FUNCTION (void*)showRoutingCfgFuncV6();>
 </table> 
</td>
</tr>
</table>   
<input type="hidden" NAME="submit.htm?routing_v6.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@ping_v6.htm@#*&1900
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Ping6</title>
<SCRIPT>
//IPv6
function ping6Click()
{
if (document.ping6.ip6addr.value=="") {
alert("Please input target address!");
document.ping6.ip6addr.focus();
return false;
}
if (isLinkLocalIpv6Address(document.ping6.ip6addr.value))
{
if(document.getElementsByName("interface")[0].value==""){
alert("Please select one interface!");
document.ping6.interface.focus();
return false;
}
}
return true;
}
</SCRIPT>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script type='text/javascript'>
TabHeader="Maintenance";
SideItem="Diagnostics";
HelpItem="ping";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Ping6 Diagnostic</td>
</tr>
<tr>
<td class="content">
<p>Ping6 Diagnostic</p>
</td>
</tr>
</table>
<form action="form2pingv6.cgi" method=POST name="ping6" >
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Target Address:</td>
<td class="form_label_right">
<input type="text" name="ip6addr" size="32" maxlength="64">
</td>
</tr>
<tr>
<td class="form_label_left">Interface:</td>
<td class="form_label_right">
<select name="interface">
<OPTION VALUE="" SELECTED> </OPTION>
<VWS_SCREEN (char*) GeneralAlliflist[];>
 </select>
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value=" PING " onClick="return ping6Click()">
<INPUT TYPE="hidden" NAME="submit.htm?pingrlt_v6.htm" VALUE="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@pingrlt_v6.htm@#*&1202
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Ping6</title>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script type='text/javascript'>	
TabHeader="Maintenance";	
SideItem="Diagnostics";	
HelpItem="ping";
</script>
<script type='text/javascript'>	
mainTableStart();	
logo();	
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Ping6 Diagnostic</td>
</tr>
<tr>
<td class="content">
<p>This table shows the result of  Ping6.</p>
</td>
</tr>
</table>
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Ping6 Result</td>
</tr>
<tr>
<td class="content" align="left">
<table border=0>
<tr>
<td class="value4">
PING6 
<VWS_FUNCTION (void*)xscrnShowPingV6Ip();>
 <br><br>
<VWS_FUNCTION (void*)xscrnShowPingV6Result();>
 <br><br>
<form><input type=button value="  Back  " OnClick=window.location.replace("ping_v6.htm")></form>
</td>
</tr>
</table>
</td>
</tr>
</table>
<script type='text/javascript'>	
mainBodyEnd();		
ThirdRowEnd();
Footer()	
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@dns_v6.htm@#*&5042
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>IPv6 DNS Configuration </title>
<SCRIPT>
function autoDNS6clicked()
{
document.dns6.dns61.disabled = true;
document.dns6.dns62.disabled = true;
document.dns6.dns63.disabled = true;
document.dns6.interface1.disabled = true;
document.dns6.interface2.disabled = true;
document.dns6.interface3.disabled = true;
}
function manualDNS6clicked()
{
document.dns6.dns61.disabled = false;
document.dns6.dns62.disabled = false;
document.dns6.dns63.disabled = false;
document.dns6.interface1.disabled = false;
document.dns6.interface2.disabled = false;
document.dns6.interface3.disabled = false;
}
function saveClick6()
{
if (document.dns6.dns6Mode[0].checked) {
return true;
}
if (document.dns6.dns61.value=="") {
alert("Please input DNS 1 ipv6 address!");
document.dns6.dns61.focus();
return false;
}
if (! isUnicastIpv6Address( document.dns6.dns61.value)) {
alert("Invalid DNS 1 address!");
document.dns6.dns61.focus();
return false;
}
if (isLinkLocalIpv6Address(document.dns6.dns61.value))
{
if(document.getElementsByName("interface1")[0].value==""){
alert("Please specify one interface!");
document.dns6.interface1.focus();
return false;
}
}
if (document.dns6.dns62.value !="") {
if (! isUnicastIpv6Address( document.dns6.dns62.value)) {
alert("Invalid DNS 2 address!");
document.dns6.dns62.focus();
return false;
}
if (isLinkLocalIpv6Address(document.dns6.dns62.value))
{
if(document.getElementsByName("interface2")[0].value==""){
alert("Please specify one interface!");
document.dns6.interface2.focus();
return false;
}
}
}
if (document.dns6.dns63.value=="") {
return true;
}
if (! isUnicastIpv6Address( document.dns6.dns63.value)) {
alert("Invalid DNS 3 address!");
document.dns6.dns63.focus();
return false;
}
if (isLinkLocalIpv6Address(document.dns6.dns63.value))
{
if(document.getElementsByName("interface3")[0].value==""){
alert("Please specify one interface!");
document.dns6.interface3.focus();
return false;
}
}
return true;
}
function resetClick6()
{
if (initAutoDns)
autoDNS6clicked();
else
manualDNS6clicked();
}
</SCRIPT>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="DNS";
HelpItem="dns";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">IPv6 DNS Configuration</td>
</tr>
<tr>
<td class="content">
<p>This page is used to configure the DNS server ipv6 addresses.</p>
</td>
</tr>
</table>
<form id="form" action="form2Dns6.cgi" method=POST name="dns6">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">IPv6 DNS Configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left"><input type="radio" value="0" name="dns6Mode"
<VWS_FUNCTION (void*)httpDNS6IsAuto();>
 onClick="autoDNS6clicked()"></td>
<td class="form_label_right">Attain DNS Automatically</td>
</tr>
<tr>
<td class="form_label_left"><input type="radio" value="1" name="dns6Mode"
<VWS_FUNCTION (void*)httpDNS6IsManual();>
 onClick="manualDNS6clicked()"></td>
<td class="form_label_right">Set DNS Manually</td>
</tr>
</table>
<div id='dns6Info' style="display:block">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left"></td>
<td class="form_label_right">DNS 1:<input type="text" name="dns61" size="20" maxlength="64" value=
<VWS_SCREEN (char*) xscrnSetNameServer6IP1[];>
>
Interface:
<select name="interface1">
<OPTION VALUE="" SELECTED> </OPTION>
<VWS_SCREEN (char*) GeneralWaniflist[];>
 </select>
</td>
</tr>
<tr>
<td class="form_label_left"></td>
<td class="form_label_right">DNS 2:<input type="text" name="dns62" size="20" maxlength="64" value=
<VWS_SCREEN (char*) xscrnSetNameServer6IP2[];>
>
Interface:
<select name="interface2">
<OPTION VALUE="" SELECTED> </OPTION>
<VWS_SCREEN (char*) GeneralWaniflist[];>
 </select>
</td>
</tr>
<tr>
<td class="form_label_left"></td>
<td class="form_label_right">DNS 3:<input type="text" name="dns63" size="20" maxlength="64" value=
<VWS_SCREEN (char*) xscrnSetNameServer6IP3[];>
>
Interface:
<select name="interface3">
<OPTION VALUE="" SELECTED> </OPTION>
<VWS_SCREEN (char*) GeneralWaniflist[];>
 </select>
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
<input type="hidden" name="submit.htm?dns_v6.htm" value="Send">
<input type="submit" value="Apply Changes" name="save" onClick="return saveClick6()">
<input type="reset" value="Reset Selected" name="reset" onClick="return resetClick6()">
</form>
<script>
initAutoDns = document.dns6.dns6Mode[0].checked;
if (document.dns6.dns6Mode[0].checked)
autoDNS6clicked();
else
{
manualDNS6clicked();
<VWS_FUNCTION (void*)dns6BindPortInit();>
 }
</script>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@fw-ipportfilter_adv_v6.htm@#*&10919
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>IPv6/Port Filtering</title>
<script>
var retNum=/^[0-9]{1,15}$/;
function OnHelp( page)
{
HelpWin= window.open(page,"Help","toolbar=no,location=no,directories=no,   status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,height=500");
}
function protocalSelection()
{
if ( document.formFilterAdd.protocol.selectedIndex <=1 )
{
document.formFilterAdd.srcportfrom.disabled = true;
document.formFilterAdd.srcportto.disabled = true;
document.formFilterAdd.dstportfrom.disabled = true;
document.formFilterAdd.dstportto.disabled = true;
if ( document.formFilterAdd.protocol.selectedIndex ==1 )
document.formFilterAdd.icmp6type.disabled = false;
else
document.formFilterAdd.icmp6type.disabled = true;
}else{
document.formFilterAdd.srcportfrom.disabled = false;
document.formFilterAdd.srcportto.disabled = false;
document.formFilterAdd.dstportfrom.disabled = false;
document.formFilterAdd.dstportto.disabled = false;
document.formFilterAdd.icmp6type.disabled = true;
}
}
function addClick()
{
if (document.formFilterAdd.sourceip.value != "")
{
if (! isIpv6Address( document.formFilterAdd.sourceip.value )) {
alert("Invalid Source Address.");
document.formFilterAdd.sourceip.focus();
return false;
}
if (document.formFilterAdd.sourceprefix.value=="") {
alert("Please input Prefix Length!");
document.formFilterAdd.sourceprefix.focus();
return false;
}
if (validateKey(document.formFilterAdd.sourceprefix.value) == 0) {
alert("Wrong Prefix Length!");
document.formFilterAdd.sourceprefix.focus();
return false;
}
var prefixlen= getDigit(document.formFilterAdd.sourceprefix.value, 1);
if (prefixlen > 128 || prefixlen < 0) {
alert("Wrong Prefix Length!");
document.formFilterAdd.sourceprefix.focus();
return false;
}
}
else
document.formFilterAdd.sourceprefix.value = "";
if (document.formFilterAdd.destip.value != "")
{
if (! isIpv6Address( document.formFilterAdd.destip.value )) {
alert("Invalid Destination Address.");
document.formFilterAdd.destip.focus();
return false;
}
if (document.formFilterAdd.destprefix.value=="") {
alert("Please input Prefix Length!");
document.formFilterAdd.destprefix.focus();
return false;
}
if (validateKey(document.formFilterAdd.destprefix.value) == 0) {
alert("Wrong Prefix Length!");
document.formFilterAdd.destprefix.focus();
return false;
}
var prefixlen= getDigit(document.formFilterAdd.destprefix.value, 1);
if (prefixlen > 128 || prefixlen < 0) {
alert("Wrong Prefix Length!");
document.formFilterAdd.destprefix.focus();
return false;
}
}
else
document.formFilterAdd.destprefix.value = "";
if ( document.formFilterAdd.protocol.selectedIndex != 0 &&
document.formFilterAdd.protocol.selectedIndex != 1 )
{
digit1 = getDigit(document.formFilterAdd.srcportfrom.value, 1);
if ( (document.formFilterAdd.srcportfrom.value != "") && (digit1 > 65535 || digit1 <= 0) )
{
alert("Invalid SPort value! You should set a value between 1-65535.");
document.formFilterAdd.srcportfrom.focus();
return false;
}
digit2 = getDigit(document.formFilterAdd.srcportto.value, 1);
if (( (document.formFilterAdd.srcportto.value != "") && (digit2 > 65535 || digit2 <= 0) ))
{
alert("Invalid SPort value! You should set a value between 1-65535.");
document.formFilterAdd.srcportto.focus();
return false;
}
if ((document.formFilterAdd.srcportfrom.value != "") &&
(document.formFilterAdd.srcportto.value != "") && (digit1>digit2))
{
alert("Invalid Sport value range! port from is larger than port to.");
document.formFilterAdd.srcportfrom.focus();
return false;
}
digit1 = getDigit(document.formFilterAdd.dstportfrom.value, 1);
if (( (document.formFilterAdd.dstportfrom.value != "") && (digit1 > 65535 || digit1 <= 0) ))
{
alert("Invalid DPort value! You should set a value between 1-65535.");
document.formFilterAdd.dstportfrom.focus();
return false;
}
digit2 = getDigit(document.formFilterAdd.dstportto.value, 1);
if (( (document.formFilterAdd.dstportto.value != "") && (digit2 > 65535 || digit2 <= 0) ))
{
alert("Invalid DPort value! You should set a value between 1-65535.");
document.formFilterAdd.dstportto.focus();
return false;
}
if ((document.formFilterAdd.dstportfrom.value != "") &&
(document.formFilterAdd.dstportto.value != "") && (digit1>digit2))
{
alert("Invalid Dport value range! port from is larger than port to.");
document.formFilterAdd.dstportfrom.focus();
return false;
}
}
}
</script>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Filtering Options";
HelpItem="IPv6Filter";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">IP/Port Filtering</td>
</tr>
<tr>
<td class="content">
<p>Entries in this table are used to restrict certain types of ipv6 data packets from your local
network to Internet through the Gateway. Use of such filters can be helpful in securing
or restricting your local network.</p>
</td>
</tr>
</table>
<form action="form2Acl6defaultcfg.cgi" method=POST name="formFilter6Default">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Default Action Status</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">Outgoing Default Action:</td>
<td class="form_label_right">
<VWS_SCREEN (char*) xscrnSetFilter6OutState[];>
 </td>
</tr>
<tr>
<td class="form_label_left">Incoming Default Action:</td>
<td class="form_label_right">
<VWS_SCREEN (char*) xscrnSetFilter6inState[];>
 </td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<form action="form2Filter6cfg.cgi" method=POST name="formFilterAdd">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">Rule configuration</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left" style="width:150px;">Rule Action:</td>
<td class="form_label_radio" style="width:180px; text-align:left">
<input type="radio" name="operate" value="allow" checked>Permit
<input type="radio" name="operate" value="deny">Deny
</td>
<td class="form_label_left" style="width:150px;"></td>
<td class="form_label_right" style="width:180px;"></td>
</tr>
<tr>
<td class="form_label_left" style="width:150px;">Protocol:</td>
<td class="form_label_radio" style="width:180px; text-align:left">
<select name="protocol" onChange="protocalSelection();">
<option VALUE="41" SELECTED> IPv6
<option VALUE="58"> ICMP6
<option VALUE="6"> TCP
<option VALUE="17"> UDP
</select>
</td>
<td class="form_label_left" style="width:150px;">Icmp6Type:</td>
<td class="form_label_right" style="width:180px;">
<select name="icmp6type" disabled>
<option VALUE="1" SELECTED> PING6
</select>
</td>
</tr>
<tr>
<td class="form_label_left" style="width:150px;">Direction:</td>
<td class="form_label_radio" style="width:180px; text-align:left">
<select name="direction" >
<option VALUE="up" SELECTED> Upstream
<option VALUE="down"> Downstream
</select>
</td>
<td class="form_label_left" style="width:150px;"></td>
<td class="form_label_right" style="width:180px;"></td>
</tr>
<tr>
<td class="form_label_left" style="width:150px;">Source IPv6 Address:</td>
<td class="form_label_radio" style="width:180px; text-align:left">
<input type="text" name="sourceip" size="25" maxlength="40">
</td>
<td class="form_label_left" style="width:150px;">Prefix Length:</td>
<td class="form_label_right" style="width:180px;">
<input type="text" name="sourceprefix" size="5" maxlength="5">
</td>
</tr>
<tr>
<td class="form_label_left" style="width:150px;">Dest IPv6 Address:</td>
<td class="form_label_radio" style="width:180px; text-align:left">
<input type="text" name="destip" size="25" maxlength="40">
</td>
<td class="form_label_left" style="width:150px;">Prefix Length:</td>
<td class="form_label_right" style="width:180px;">
<input type="text" name="destprefix" size="5" maxlength="5">
</td>
</tr>
<tr>
<td class="form_label_left" style="width:150px;">SPort:</td>
<td class="form_label_radio" style="width:180px; text-align:left">
<input type="text" name="srcportfrom" size="5" maxlength="5" disabled>&nbsp;&nbsp;-&nbsp;&nbsp;<input type="text" name="srcportto" size="5" maxlength="5" disabled>
</td>
<td class="form_label_left" style="width:150px;">DPort:</td>
<td class="form_label_right" style="width:400px;">
<input type="text" name="dstportfrom" size="5" maxlength="5" disabled>-&nbsp;<input type="text" name="dstportto" size="5" maxlength="5" disabled>
</td>
</tr>
<tr>
<td class="form_label_left" style="width:150px;">Enable:</td>
<td class="form_label_radio" style="width:180px; text-align:left">

&&*&&en**&**
<INPUT TYPE="CHECKBOX" NAME="state" VALUE="enable" CHECKED>
</td>
<td class="form_label_left" style="width:150px;"></td>
<td class="form_label_right" style="width:180px;"></td>
</tr>
</table>
</td>
</tr>
</table>
<br>
<input type="submit" value="Apply Changes" onClick="return addClick()">&nbsp;&nbsp;
<input type="reset" value="Reset" name="reset">&nbsp;&nbsp;
<INPUT TYPE=BUTTON VALUE="Help" onclick=OnHelp("hlpacl.htm")>
<input type="hidden" NAME="submit.htm?fw-ipportfilter_adv_v6.htm" value="Send">
</form>
<form method=POST Action="form2Filter6del.cgi">
<INPUT TYPE="HIDDEN" NAME="rulenum" VALUE="" >
<INPUT TYPE="HIDDEN" NAME="state" VALUE="" >
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Current Filter Table</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="630" style="table-layout:fixed; word-wrap:break-word; overflow:hidden;">
<tr class="form_label_row">
<td class="form_label_col">Rule</td>
<td class="form_label_col">Protocol</td>
<td class="form_label_col">Source IPv6/Prefix</td>
<td class="form_label_col">SPort</td>
<td class="form_label_col">Dest IPv6/Prefix</td>
<td class="form_label_col">DPort</td>
<td class="form_label_col">ICMP6Type</td>
<td class="form_label_col">State</td>
<td class="form_label_col">Direction</td>
<td class="form_label_col">Action</td>
</tr>
<VWS_FUNCTION (void*)showFilter6List();>
 </table>
</td>
</tr>
</table>
<script language="JavaScript">
function aclDelFunc( form , rulenum, state){
form.elements[0].value=rulenum;
form.elements[1].value=state;
form.submit();
}
document.formFilter6Default.outAct[0].disabled = true;
document.formFilter6Default.outAct[1].disabled = true;
document.formFilter6Default.inAct[0].disabled = true;
document.formFilter6Default.inAct[1].disabled = true;
</script>
<input type="hidden" NAME="submit.htm?fw-ipportfilter_adv_v6.htm" value="Send">
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@mld.htm@#*&4693
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>IGMP Proxy Configuration </title>
<SCRIPT>
function disableRadioGroup (radioArrOrButton)
{
if(!radioArrOrButton)
return;
if (radioArrOrButton.type && radioArrOrButton.type == "radio") {
var radioButton = radioArrOrButton;
var radioArray = radioButton.form[radioButton.name];
}
else
var radioArray = radioArrOrButton;
radioArray.disabled = true;
for (var b = 0; b < radioArray.length; b++) {
if (radioArray[b].checked) {
radioArray.checkedElement = radioArray[b];
break;
}
}
for (var b = 0; b < radioArray.length; b++) {
radioArray[b].disabled = true;
radioArray[b].checkedElement = radioArray.checkedElement;
}
}
function enableRadioGroup (radioArrOrButton)
{
if(!radioArrOrButton)
return;
if (radioArrOrButton.type && radioArrOrButton.type == "radio") {
var radioButton = radioArrOrButton;
var radioArray = radioButton.form[radioButton.name];
}
else
var radioArray = radioArrOrButton;
radioArray.disabled = false;
radioArray.checkedElement = null;
for (var b = 0; b < radioArray.length; b++) {
radioArray[b].disabled = false;
radioArray[b].checkedElement = null;
}
}
function disableTextField (field) {
if(!field)
return;
if (document.all || document.getElementById)
field.disabled = true;
else {
field.oldOnFocus = field.onfocus;
field.onfocus = skip;
}
}
function enableTextField (field) {
if(!field)
return;
if (document.all || document.getElementById)
field.disabled = false;
else {
field.onfocus = field.oldOnFocus;
}
}
function resetClick()
{
if (initIgmpDisable){
disableTextField(document.mld.robustCount);
disableTextField(document.mld.queryIntvl);
disableTextField(document.mld.queryRespIntvl);
disableTextField(document.mld.LastQueryInt);
}
else{
enableTextField(document.mld.robustCount);
enableTextField(document.mld.queryIntvl);
enableTextField(document.mld.queryRespIntvl);
enableTextField(document.mld.LastQueryInt);
}
}
function proxySelection()
{
if (document.mld.proxy[0].checked) {
disableTextField(document.mld.robustCount);
disableTextField(document.mld.queryIntvl);
disableTextField(document.mld.queryRespIntvl);
disableTextField(document.mld.LastQueryInt);
}
else {
enableTextField(document.mld.robustCount);
enableTextField(document.mld.queryIntvl);
enableTextField(document.mld.queryRespIntvl);
enableTextField(document.mld.LastQueryInt);
}
}
function validateKey(str)
{
for (var i=0; i<str.length; i++) {
if ( (str.charAt(i) >= '0' && str.charAt(i) <= '9') || (str.charAt(i) == '.' ) )
continue;
return 0;
}
return 1;
}
function checkPS(num)
{
if (num.value=="") {
alert("Empty!");
num.value = num.defaultValue;
num.focus();
return 0;
}
if ( validateKey( num.value ) == 0 ) {
alert("Invalid Charactersshould be digit (0-9).");
num.value = num.defaultValue;
num.focus();
return 0;
}
return 1;
}
function saveChanges()
{
if(!checkPS(document.mld.robustCount))
{
return false;
}
if(!checkPS(document.mld.queryIntvl))
{
return false;
}
if(!checkPS(document.mld.queryRespIntvl))
{
return false;
}
if(!checkPS(document.mld.LastQueryInt))
{
return false;
}
d1 = getDigit(document.mld.queryIntvl.value, 1);
d2 = getDigit(document.mld.queryRespIntvl.value, 1);
if ((d1*1000) < d2) {
alert("Query Interval should be larger than Response Interval.");
return false;
}
return true;
}
</SCRIPT>
</head>
<body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" alink="#000000" link="#000000" vlink="#000000">
<blockquote>
<h2><font color="#0000FF">MLD Configuration</font></h2>
<form action="form2MLD.cgi" method=POST name="mld">
<table border=0 width="500" cellspacing=4 cellpadding=0>
<tr><font size=2>
MLD Proxy and Snooping can be configured here.
</tr>
<tr><hr size=1 noshade align=top></tr>
<tr>
<td width="30%"><font size=2><b>MLD proxy:</b></td>
<td width="35%">
<input type="radio" value="0" name="proxy"  
<VWS_SCREEN (char*)xscrnMldPrxyIsDisabled[];>
 onClick="proxySelection()">Disable&nbsp;&nbsp;
<input type="radio" value="1" name="proxy" 
<VWS_SCREEN (char*)xscrnMldPrxyIsEnabled[];>
 onClick="proxySelection()">Enable
</td>
</tr>
<VWS_SCREEN (char*) xscrnMldIsSnoopingAllow[];>
<VWS_SCREEN (char*) xscrnMldRobustConunt[];> 
<VWS_SCREEN (char*) xscrnMldQueryIntvl[];> 
<VWS_SCREEN (char*) xscrnMldQueryRespIntvl[];> 
<VWS_SCREEN (char*) xscrnMldLastListenerQueryIntvl[];> 
 </table>
<br>
<INPUT TYPE="hidden" NAME="submit.htm?mld.htm" VALUE="Send">
<input type="submit" value="Apply Changes" name="save" 
<VWS_SCREEN (char*) xscrnMldSaveChangesFunc[];> 
 >&nbsp;&nbsp;
<input type="reset" value="Cancel" name="reset" onClick="resetClick()">
<script>
initIgmpDisable = document.mld.proxy[0].checked;
proxySelection();
</script>
</form>
</blockquote>
</body>
</html>

&*#@dhcpclients.htm@#*&1492
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Active DHCP Client Table</title>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Status";
SideItem="DHCP Clients";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">Active DHCP Client Table</td>
</tr>
<tr>
<td class="content">
<p>This table shows the assigned IP address, MAC address and time expired for each DHCP leased client.</p>
</td>
</tr>
</table>
<form action="form2WebRefresh.cgi" method=POST name="status">
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Active DHCP Client Table</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500">
<tr class="form_label_row">
<td class="form_label_col">Name</td>
<td class="form_label_col">IP Address</td>
<td class="form_label_col">MAC Address</td>
<td class="form_label_col">Expiry</td>
<td class="form_label_col">Type</td>
</tr>
<VWS_FUNCTION (void*)showDhcpBindingX();>
 </table>
</td>
</tr>
</table>
<p align=center>
<input type="button" value="Refresh" onClick="window.location.href='dhcpclients.htm'">&nbsp;&nbsp;
</p>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@routeinfo.htm@#*&1440
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>IP Route Table</title>
<link href="stylemain.css" rel="stylesheet" type="text/css">
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Status";
SideItem="Route Info";
HelpItem="routeinfo";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">IP Route Table</td>
</tr>
<tr>
<td class="content">
<p>This table shows a list of destination routes commonly accessed by your network.</p>
</td>
</tr>
</table>
<table id="body_header" border="0" cellspacing="0">
<tr>
<td class="topheader">Current IP Routing Table</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formlisting" border="0" cellpadding="0" cellspacing="0" width="500">
<tr class="form_label_row">
<td class="form_label_col">Destination</td>
<td class="form_label_col">Subnet Mask</td>
<td class="form_label_col">NextHop</td>
<td class="form_label_col">Interface</td>
</tr>
<VWS_FUNCTION (void*)showRoutingTblFunc();>
 </table>
</td>
</tr>
</table>
<br>
<form>
<p align=center><input type="button" value="Refresh" onClick="window.location.href='routeinfo.htm'"></p>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@wlclients.htm@#*&1554
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Active Wireless Client Table</title>
</head>
<body>
<blockquote>
<script language="JavaScript">
TabHeader="Status";
SideItem="Wireless Clients";
//	HelpItem="Device Info";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Active Wireless Client Table
</td>
</tr>
<tr>
<td class=content>
<p>
This table shows the MAC address, transmission, reception packet counters and encrypted
status for each associated wireless client</p>
</td>
</tr>
</table>
<form action="form2WirelessTbl.cgi" method=POST name="formWirelessTbl">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Active Wireless Client Table</td>
</tr>
<tr>
<td class=content>
<table class=formlisting border=0>
<tr class=form_label_row>
<td class=form_label_col>MAC Address</td>
<td class=form_label_col>Tx Packet</td>
<td class=form_label_col>Rx Packet</td>
<td class=form_label_col>Tx Rate (Mbps)</td>
<td class=form_label_col>Power Saving</td>	
<td class=form_label_col>Expired Time (s)</td>	
</tr>
<VWS_SCREEN (char*) webShowWlanClientList[];>					
 </table>
</td>
</tr>
</table>
<p align=center>
<input type="button" value="Refresh" onClick="window.location.href='wlclients.htm'">
</p>
</form>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@internet.htm@#*&1914
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Internet Setup Wizard</title>
<link href="stylemain.css" rel="stylesheet" type="text/css">
<script type='text/javascript'>
var wanConnectionNumber = '2';
function btnQuick() {
var loc = '';
var wanNumber = parseInt(wanConnectionNumber);
if (wanNumber>=8) {
return false;
}
loc += 'wizintro.htm';
var code = 'location="' + loc + '"';
eval(code);
}
</script>
</head>
<body>
<blockquote>
<script type='text/javascript'>
TabHeader="Setup";
SideItem="Wizard";
HelpItem="wizard";
</script>
<script type='text/javascript'>
mainTableStart();
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</script>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Setting up your internet
</td>
</tr>
<tr>
<td class=content>
<p>
There are two ways to set up your Internet connection. You can use the Web-based Internet Connection Setup Wizard or you can manually configure the connection.</p>
<p>Please make sure you have your ISP's connection settings first if you choose manual setup.</p>
</td>
</tr>
</table>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Internet Connection Wizard
</td>
</tr>
<tr>
<td class=content>
<p>You can use this wizard for assistance and quick connection of your new D-Link Router to the Internet. You will be presented with step-by-step instructions in order to get your Internet connection up and running. Click the button below to begin.</p>
<p><center><input type='button' onClick='btnQuick()' value='Setup Wizard'></center></p>
<p><b>Note</b>: Before launching the wizard, please ensure you have correctly followed the steps outlined in the Quick Installation Guide included with the router.</p>
</td>
</tr>
</table>
<script type='text/javascript'>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</script>
</blockquote>
</body>
</html>

&*#@internetlist.js@#*&11148
var CountryList = new Array();
var ISPList = new Array();
var ispPrtcl;
var ispContype;
var ispVPI;
var ispVCI;
var i=0;
CountryList[i++] = new Citem("Australia", 12);
CountryList[i++] = new Citem("Chile", 2);
CountryList[i++] = new Citem("Colombia", 2);
CountryList[i++] = new Citem("Cyprus", 1);
CountryList[i++] = new Citem("Egypt", 9);
CountryList[i++] = new Citem("India", 7);
CountryList[i++] = new Citem("Idonesia", 7);
CountryList[i++] = new Citem("Iran", 1);
CountryList[i++] = new Citem("Israel", 1);
CountryList[i++] = new Citem("Jordan", 1);
CountryList[i++] = new Citem("Japan", 15);
CountryList[i++] = new Citem("Korea", 4);
CountryList[i++] = new Citem("Malaysia", 3);
CountryList[i++] = new Citem("Moroco", 1);
CountryList[i++] = new Citem("New Zealand", 2);
CountryList[i++] = new Citem("Oman", 1);
CountryList[i++] = new Citem("Pakistan", 7);
CountryList[i++] = new Citem("Palestine", 1);
CountryList[i++] = new Citem("Peru", 1);
CountryList[i++] = new Citem("Philippines", 3);
CountryList[i++] = new Citem("Qatar", 1);
CountryList[i++] = new Citem("Saudi Arabia", 1);
CountryList[i++] = new Citem("Singapore", 4);
CountryList[i++] = new Citem("Syria", 2);
CountryList[i++] = new Citem("Thailand", 9);
CountryList[i++] = new Citem("Turkey", 2);
i = 0;
ISPList[i++] = new ISPitem("Australia", "AAPT", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "Dodo Internet", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "Internode", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "iinet", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "iPrimus", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "Netspace", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "Optus", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "OzEmail", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "Pacific Internet", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "TelPacific", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "Telstra BigPond", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Australia", "TPG", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Chile", "Telefonica Chile(Bridge)", "Bridge", "LLC", "8", "32");
ISPList[i++] = new ISPitem("Chile", "Telefonica Chile(PPPoE)", "PPPoE", "LLC", "8", "34");
ISPList[i++] = new ISPitem("Colombia", "Emcali(PPPoA)", "PPPoA", "VC-Mux", "2", "35");
ISPList[i++] = new ISPitem("Colombia", "Emcali(PPPoE)", "PPPoE", "LLC", "2", "35");
ISPList[i++] = new ISPitem("Cyprus", "CYTA", "PPPoA", "VC-Mux", "8", "35");
ISPList[i++] = new ISPitem("Egypt", "EGYNET(PPPoA)", "PPPoA", "VC-Mux", "8", "35");
ISPList[i++] = new ISPitem("Egypt", "EGYNET(Static IP)", "Static IP", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Egypt", "link dot Net(PPPoA)", "PPPoA", "VC-Mux", "0", "35");
ISPList[i++] = new ISPitem("Egypt", "link dot Net(Static IP)", "Static IP", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Egypt", "Nile On Line", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Egypt", "Raya Telecom(PPPoA)", "PPPoA", "VC-Mux", "8", "80");
ISPList[i++] = new ISPitem("Egypt", "Raya Telecom(Static IP)", "Static IP", "LLC", "8", "80");
ISPList[i++] = new ISPitem("Egypt", "TeData(PPPoA)", "PPPoA", "VC-Mux", "0", "35");
ISPList[i++] = new ISPitem("Egypt", "TeData(Static IP)", "Static IP", "LLC", "0", "35");
ISPList[i++] = new ISPitem("India", "Airtel(PPPoE)", "PPPoE", "LLC", "1", "32");
ISPList[i++] = new ISPitem("India", "Airtel(Bridge)", "Bridge", "LLC", "1", "32");
ISPList[i++] = new ISPitem("India", "BSNL", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("India", "MTNL(PPPoE)", "PPPoE", "LLC", "0", "32");
ISPList[i++] = new ISPitem("India", "MTNL(Bridge)", "Bridge", "LLC", "0", "33");
ISPList[i++] = new ISPitem("India", "VSNL(PPPoE)", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("India", "VSNL(Bridge)", "Bridge", "LLC", "8", "33");
ISPList[i++] = new ISPitem("Idonesia", "PT Telkom DIVRE 1 (Sumatra)", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Idonesia", "PT Telkom DIVRE 2 (Jakarta) Alcatel", "PPPoA", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Idonesia", "PT Telkom DIVRE 2 (Jakarta) Siemens", "PPPoA", "VC-Mux", "1", "33");
ISPList[i++] = new ISPitem("Idonesia", "PT Telkom DIVRE 3 (West Java)", "PPPoA", "VC-Mux", "1", "33");
ISPList[i++] = new ISPitem("Idonesia", "PT Telkom DIVRE 4 (Central Java)", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Idonesia", "PT Telkom DIVRE 5 (East Java)", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Idonesia", "PT Telkom DIVRE 7 (East Idonesia)", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Iran", "Pars-Online", "Bridge", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Israel", "Bezeq", "PPPoE", "LLC", "8", "48");
ISPList[i++] = new ISPitem("Jordan", "Wanadoo", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Japan", "ACCA", "PPPoA", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Japan", "CTnet", "PPPoA", "LLC", "0", "32");
ISPList[i++] = new ISPitem("Japan", "DION (KDDI)", "PPPoA", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Japan", "eAccess", "PPPoE", "LLC", "0", "32");
ISPList[i++] = new ISPitem("Japan", "eAccess (PPPoA)", "PPPoA", "VC-Mux", "0", "32");
ISPList[i++] = new ISPitem("Japan", "FLET's ADSL (NTT)", "PPPoE", "LLC", "0", "32");
ISPList[i++] = new ISPitem("Japan", "HTnet", "PPPoA", "LLC", "0", "32");
ISPList[i++] = new ISPitem("Japan", "KCN", "PPPoA", "VC-Mux", "0", "32");
ISPList[i++] = new ISPitem("Japan", "Nagoya", "PPPoE", "LLC", "0", "32");
ISPList[i++] = new ISPitem("Japan", "OCN", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Japan", "OCN (J-DSL Personal)", "PPPoA", "VC-Mux", "0", "32");
ISPList[i++] = new ISPitem("Japan", "OCN (J-DSL Business)", "PPPoA", "VC-Mux", "0", "33");
ISPList[i++] = new ISPitem("Japan", "RMC", "Dynamic IP", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Japan", "T-com", "PPPoA", "VC-Mux", "0", "32");
ISPList[i++] = new ISPitem("Japan", "Yahoo!BB (SoftBankBB)", "Dynamic IP", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Korea", "Hanaro Telecom(PPPoE)", "PPPoE", "LLC", "0", "67");
ISPList[i++] = new ISPitem("Korea", "Hanaro Telecom(PPPoA)", "PPPoA", "VC-Mux", "0", "67");
ISPList[i++] = new ISPitem("Korea", "KT(Korea Telecom)(PPPoE)", "PPPoE", "LLC", "0", "32");
ISPList[i++] = new ISPitem("Korea", "KT(Korea Telecom)(PPPoA)", "PPPoA", "LLC", "0", "32");
ISPList[i++] = new ISPitem("Malaysia", "Maxis", "PPPoA", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Malaysia", "Streamyx (Telecom Malaysia - PPPoE)", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Malaysia", "Streamyx (Telecom Malaysia - PPPoA)", "PPPoA", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Moroco", "MAROC Telecom", "PPPoA", "VC-Mux", "8", "35");
ISPList[i++] = new ISPitem("New Zealand", "IHUG", "PPPoA", "VC-Mux", "0", "100");
ISPList[i++] = new ISPitem("New Zealand", "Telecom Xtra", "PPPoA", "VC-Mux", "0", "100");
ISPList[i++] = new ISPitem("Oman", "Oman Tel", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Pakistan", "Cyberet", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Pakistan", "Dancom", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Pakistan", "GerrysNet", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Pakistan", "MultiNet", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Pakistan", "Micronet", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Pakistan", "PAKnet", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Pakistan", "WolNet", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Palestine", "PalTel/Hadara", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Peru", "Telefonica", "PPPoE", "LLC", "8", "60");
ISPList[i++] = new ISPitem("Philippines", "Globe", "PPPoA", "VC-Mux", "0", "35");
ISPList[i++] = new ISPitem("Philippines", "PLDT (Manila)", "PPPoE", "LLC", "0", "100");
ISPList[i++] = new ISPitem("Philippines", "PLDT (Provincial)", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Qatar", "QTEL", "PPPoA", "VC-Mux", "8", "35");
ISPList[i++] = new ISPitem("Saudi Arabia", "Saudi Telecom", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Singapore", "Pacific Internet(PPPoA)", "PPPoA", "VC-Mux", "0", "100");
ISPList[i++] = new ISPitem("Singapore", "Pacific Internet(PPPoE)", "PPPoE", "LLC", "0", "100");
ISPList[i++] = new ISPitem("Singapore", "Singnet Broad Band(PPPoA)", "PPPoA", "VC-Mux", "0", "100");
ISPList[i++] = new ISPitem("Singapore", "Singnet Broad Band(PPPoE)", "PPPoE", "LLC", "0", "100");
ISPList[i++] = new ISPitem("Syria", "Syria Telecom-1", "PPPoE", "LLC", "0", "33");
ISPList[i++] = new ISPitem("Syria", "Syria Telecom-2", "PPPoA", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Thailand", "ADC", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Thailand", "Samart", "PPPoE", "LLC", "0", "35");
ISPList[i++] = new ISPitem("Thailand", "TOT", "PPPoE", "LLC", "1", "32");
ISPList[i++] = new ISPitem("Thailand", "TRUE (Nokia)", "PPPoA", "VC-Mux", "0", "100");
ISPList[i++] = new ISPitem("Thailand", "TRUE (Huawei)", "PPPoE", "LLC", "0", "100");
ISPList[i++] = new ISPitem("Thailand", "TT&T (Normal)", "PPPoE", "LLC", "0", "33");
ISPList[i++] = new ISPitem("Thailand", "TT&T (Hinet)", "PPPoE", "LLC", "0", "66");
ISPList[i++] = new ISPitem("Thailand", "Qnet", "PPPoE", "LLC", "0", "40");
ISPList[i++] = new ISPitem("Thailand", "UCOM", "PPPoE", "LLC", "0", "100");
ISPList[i++] = new ISPitem("Turkey", "TTNET(PPPoE)", "PPPoE", "LLC", "8", "35");
ISPList[i++] = new ISPitem("Turkey", "TTNET(PPPoA)", "PPPoA", "VC-Mux", "8", "35");
function Citem(country, isps)
{
this.country = country;
this.isps = isps;
}
function ISPitem(country, ispname, protocol, contype, vpi, vci)
{
this.country = country;
this.ispname = ispname;
this.protocol = protocol;
this.contype = contype;
this.vpi = vpi;
this.vci = vci;
}
function changeISP(cb1, cb2)
{
var value = cb1.value;
cb2.options.length = 0;
cb2.options[0]=new Option("(Click to Select)", "-1");
if ((value == -1) || (value == -2)) {
cb2.options[1] = new Option("Others", "-2");
if ((value == -2))
cb2.selectedIndex = cb2.length - 1;
return;
}
var count =0;
for (i = 0; i < ISPList.length; i ++) {
if (CountryList[cb1.value].country == ISPList[i].country) {
cb2.options[count+1] = new Option(ISPList[i].ispname, i);
count ++;
}
if (count == CountryList[cb1.value].isps) {
break;
}
}
cb2.options[count + 1]=new Option("Others", "-2");
}
function createCountry(cb)
{
cb.options.length=0;
cb.options[0]=new Option("(Click to Select)", "-1");
var count =0;
for (i = 0; i < CountryList.length; i ++) {
cb.options[i+1]=new Option(CountryList[i].country, i);
count ++;
}
cb.options[count + 1]=new Option("Others", "-2");
}
function getISPDetails(cb)
{
var value = cb.value;
if ((value == -1) || (value == -2)) {
ispPrtcl = "";
ispVPI = "";
ispVCI = "";
ispContype = "";
return;
}
ispPrtcl = ISPList[cb.value].protocol;
ispContype = ISPList[cb.value].contype;
ispVPI = ISPList[cb.value].vpi;
ispVCI = ISPList[cb.value].vci;
}

&*#@wizintro.htm@#*&44353
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Internet Setup Wizard</title>
<script language="javascript" src="internetlist.js"></script>
<script language="javascript">
<VWS_SCREEN (char*) getNTPServer[];>
<VWS_SCREEN (char*) getNTPServer2[];>
var ntpServers = new Array();
ntpServers[0] = 'ntp1.dlink.com';
ntpServers[1] = 'ntp.dlink.com.tw';
var timeZones = new Array();
<VWS_SCREEN (char*) showTimeZone_part1[];>
<VWS_SCREEN (char*) showTimeZone_part2[];>
 var dayLights = new Array();
<VWS_SCREEN (char*) xscrnShowDaylightSavingTime[];>
var addr = '0.0.0.0';
var mask = '0.0.0.0';
var gtwy = '';
var dns1 = '&nbsp';
if (dns1 == '&nbsp')
dns1 = '';
var wlssid = '';
function includeSpecialKey(str)
{
for (var i=0; i<str.length; i++) {
if ((str.charAt(i)== ' ') || (str.charAt(i)== '%')
|| (str.charAt(i)== '?')
|| (str.charAt(i)== '&') || (str.charAt(i)== '"')) {
return true;
}
}
return false;
}
function checkPasswd()
{
if (document.getElementById("pwdNew").value.length <5)
{
alert('Password should be at least 5 characters. Please try it again.');
document.getElementById("pwdNew").focus();
return false;
}
if (document.getElementById("pwdNew").value != document.getElementById("pwdCfm").value) {
document.getElementById("pwdNew").focus();
alert("The passwords do not match.");
return false;
}
var str = new String();
str = document.getElementById("pwdNew").value;
if (str.length > 16) {
alert('Password should not be longer than 16 characters.');
return false;
}
if (str.length == 0) {
alert('Password should not be empty.');
return false;
}
if (str.indexOf(' ') != -1) {
alert('Password cannot contain a space.');
return false;
}
if (encodeUrl(str, "New Password") == ERROR_ENCODE_URL) {
alert('Password cannot contain irregular char.');
return false;
}
if (includeSpecialKey(str)) {
alert('Invalid password,Please try it again.');
return false;
}
document.getElementById("sumpasswd").style.display="";
document.getElementById("tdpasswd").innerHTML=document.getElementById("pwdNew").value;
return true;
}
function checksntp()
{
document.getElementById("trntpstate").style.display="none";
document.getElementById("trntpmode").style.display="none";
document.getElementById("trntpone").style.display="none";
document.getElementById("trntptwo").style.display="none";
document.getElementById("trntpint").style.display="none";
document.getElementById("trtimezone").style.display="none";
document.getElementById("trdststat").style.display="none";
var intetval = document.getElementById("ntpinterval");
if (intetval.value=="") {
alert("Interval cannot be empty!");
intetval.value = intetval.defaultValue;
return false;
}
if (validateKey(intetval.value) == 0) {
alert("Invalid intetval value. It should be the decimal number (0-9).");
intetval.value = intetval.defaultValue;
return false;
}
if (!checkDigitRange(intetval.value, 1, 1, 999)) {
alert("Invalid intetval . It should be 1-999.");
intetval.value = intetval.defaultValue;
return false;
}
if(document.getElementById("ntpMode").selectedIndex==0) {
document.getElementById("tdtimestate").innerHTML="Copy from Computer";
return true;
}else {
document.getElementById("tdtimestate").innerHTML="Copy from NTP Server";
document.getElementById("trntpstate").style.display="";
}
if (document.getElementById("ntpstate1").checked)
{
if (document.getElementById("ntp1Server").selectedIndex != 2)
document.getElementById("ntpserver").value=ntp1;
if (document.getElementById("ntpserver").value == "")
document.getElementById("ntpserver").value=ntpServers[0];
if (!checkSpecialChar(document.getElementById("ntpserver").value, 1)) {
var obj = document.getElementById("ntpMode");
if (!obj || obj.selectedIndex == 1) {
alert("Invalid charaters or empty for First time server!");
return false;
}
}
if (document.getElementById("ntp2Server").selectedIndex == 1 || document.getElementById("ntp2Server").selectedIndex == 2)
document.getElementById("ntpserver2").value=ntp2;
if (document.getElementById("ntpserver2").value == "")
document.getElementById("ntpserver2").value='';
if (!checkSpecialChar(document.getElementById("ntpserver2").value, 1) && document.getElementById("ntpserver2").value !="")
{
var obj = document.getElementById("ntpMode");
if (!obj || obj.selectedIndex == 1) {
alert("Invalid charaters or empty for Second time server!");
return false;
}
}
}
if (document.getElementById("ntpstate0").checked) {
document.getElementById("tdntpstate").innerHTML="Disable";
return true;
}
document.getElementById("tdntpstate").innerHTML="Enable";
document.getElementById("tdntpone").innerHTML=document.getElementById("ntpserver").value;
document.getElementById("tdntptwo").innerHTML=document.getElementById("ntpserver2").value;
if (document.getElementById("ntpserver2").value == "")
document.getElementById("tdntptwo").innerHTML="None";
document.getElementById("tdntpint").innerHTML=document.getElementById("ntpinterval").value;
document.getElementById("tdtimezone").innerHTML=timeZones[document.getElementById("ntptimezone").selectedIndex];
if (document.getElementById("ntpMode").selectedIndex == 1) {
document.getElementById("trntpone").style.display="";
document.getElementById("trntptwo").style.display="";
document.getElementById("trntpint").style.display="";
}
else {
document.getElementById("tdntpmode").innerHTML="Copy Computer time";
document.getElementById("trntpone").style.display="none";
document.getElementById("trntptwo").style.display="none";
document.getElementById("trntpint").style.display="none";
}
document.getElementById("trtimezone").style.display="";
document.getElementById("trdststat").style.display="";
document.getElementById("tddststat").innerHTML=dayLights[document.getElementById("daylightsaving").selectedIndex];
return true;
}
function writeNtpList(needed) {
if (!needed)
document.writeln("<option value=None>None</option>");
for (var i = 0; i < ntpServers.length; i ++)
document.writeln("<option value=" + ntpServers[i] + ">" + ntpServers[i] + "</option>");
document.writeln("<option value=Other>Other</option>");
}
function updateNtpServer()
{
document.getElementById("ntpserver").value=ntp1;
document.getElementById("ntpserver2").value=ntp2;
for (i = 0; i < ntpServers.length; i ++) {
document.getElementById("ntpserver").style.display="none";
if (ntp1 == ntpServers[i]) {
document.getElementById("ntp1Server").selectedIndex = i;
break;
}
else if (ntp1 == '') {
document.getElementById("ntp1Server").selectedIndex = 0;
break;
}
else {
document.getElementById("ntp1Server").selectedIndex = ntpServers.length;
document.getElementById("ntpserver").style.display="";
}
}
for (i = 0; i < ntpServers.length; i ++) {
document.getElementById("ntpserver2").style.display="none";
if (ntp2 == ntpServers[i]) {
document.getElementById("ntp2Server").selectedIndex = i + 1;
break;
}
else if (ntp2 == '') {
document.getElementById("ntp2Server").selectedIndex = 0;
break;
}
else {
document.getElementById("ntp2Server").selectedIndex = ntpServers.length + 1;
document.getElementById("ntpserver2").style.display="";
}
}
}
function updateNtpMode()
{
if(document.getElementById("ntpMode").selectedIndex == 0 )
document.getElementById("ntpConfig").style.display="none";
else if(document.getElementById("ntpMode").selectedIndex == 1)
document.getElementById("ntpConfig").style.display="";
if (document.getElementById("ntpstate1").checked == true)
updateNtpServer();
else if(document.getElementById("ntpstate0").checked == true)
{
updateNtpServer();
disableNtpClicked();
}
}
function changeNtpServer(serverno)
{
if (serverno == '1')
{
if(document.getElementById("ntp1Server").selectedIndex != ntpServers.length)
{
ntp1 = document.getElementById("ntp1Server").value;
document.getElementById("ntpserver").style.display="none";
}
else if (document.getElementById("ntp1Server").selectedIndex == ntpServers.length)
{
document.getElementById("ntpserver").value = '';
document.getElementById("ntpserver").style.display="";
}
}
else if (serverno == '2')
{
if (document.getElementById("ntp2Server").selectedIndex == 0)
{
document.getElementById("ntpserver2").value = '';
document.getElementById("ntpserver2").style.display="none";
}
else if(document.getElementById("ntp2Server").selectedIndex == ntpServers.length + 1)
{
document.getElementById("ntpserver2").value = '';

&&*&&en**&**
document.getElementById("ntpserver2").style.display="";
}
else
{
ntp2 = document.getElementById("ntp2Server").value;
document.getElementById("ntpserver2").style.display="none";
}
}
}
function checkisp()
{
document.getElementById("trusername").style.display="none";
document.getElementById("trpassword").style.display="none";
document.getElementById("tripaddress").style.display="none";
document.getElementById("trsubnet").style.display="none";
document.getElementById("trgw").style.display="none";
document.getElementById("trpridns").style.display="none";
{
if (!isInValidRange(document.getElementById("vpi").value,0,255,"VPI"))
return false;
if (!isInValidRange(document.getElementById("vci").value,32,65535,"VCI"))
return false;
document.getElementById("tdvpivci").innerHTML=document.getElementById("vpi").value+"/"+document.getElementById("vci").value;
}
if (document.getElementById("prtcltype").selectedIndex == 0) {
alert('Please select a "Protocol".');
return false;
}
if (document.getElementById("contype").selectedIndex == 0) {
alert('Please select a "Connection Type".');
return false;
}
document.getElementById("tdprotocol").innerHTML=document.getElementById("prtcltype").value;
document.getElementById("tdencapmode").innerHTML=document.getElementById("contype").value
if ((ispPrtcl == "PPPoA") || (ispPrtcl == "PPPoE")) {
if ((document.getElementById("username").value != "") && (encodeUrl(document.getElementById("username").value,"Username") == ERROR_ENCODE_URL)) {
return false;
}
if ((document.getElementById("password").value != "") && (encodeUrl(document.getElementById("password").value,"Password")==ERROR_ENCODE_URL)) {
return false;
}
if (document.getElementById("conPass").value != document.getElementById("password").value) {
alert("The passwords do not match.");
return false;
}
document.getElementById("trusername").style.display="";
document.getElementById("trpassword").style.display="";
document.getElementById("tdusername").innerHTML=document.getElementById("username").value;
document.getElementById("tdpassword").innerHTML=document.getElementById("password").value;
}
else if (ispPrtcl == "Static IP") {
if (isValidIpAddress(document.getElementById("statdns").value,"Primary DNS server") == false)
return false;
if (isValidIpAddress(document.getElementById("statgw").value,"Default Gateway") == false)
return false;
if (isValidIpAddress(document.getElementById("statip").value,"WAN IP address") == false)
return false;
if (isValidSubnetMask(document.getElementById("statmask").value) == false && document.getElementById("statmask").value != '255.255.255.255') {
alert('WAN subnet mask "' + document.getElementById("statmask").value + '" is invalid.');
return false;
}
var reIP, reSubnetMask;
reIP = reencodeIP(document.getElementById("statip").value);
reSubnetMask = reencodeIP(document.getElementById("statmask").value);
if (document.getElementById("statip").value != "" && document.getElementById("statmask").value != "") {
if (!DoValidateNetworkIP(reIP, reSubnetMask))
return false;
if (!DoValidateIpRange(reIP,reSubnetMask))
return false;
}
document.getElementById("tripaddress").style.display="";
document.getElementById("trsubnet").style.display="";
document.getElementById("trgw").style.display="";
document.getElementById("trpridns").style.display="";
document.getElementById("tdipaddress").innerHTML=document.getElementById("statip").value;
document.getElementById("tdsubnet").innerHTML=document.getElementById("statmask").value;
document.getElementById("tdgw").innerHTML=document.getElementById("statgw").value;
document.getElementById("tdpridns").innerHTML=document.getElementById("statdns").value;
}
else if (ispPrtcl == "Dynamic IP") {
}
return true;
}
function onChangeCountry()
{
changeISP(document.getElementById("country"), document.getElementById("isplist"));
onChangeISP();
}
function onChangeISP()
{
var status = false;
document.getElementById("cmdNxt").disabled = false;
if (document.getElementById("isplist").selectedIndex == 0) {
status = true;
document.getElementById("cmdNxt").disabled = true;
changeBlockState('id_dslopt', DISABLED);
}
else
changeBlockState('id_dslopt', ENABLED);
getISPDetails(document.getElementById("isplist"));
if (ispPrtcl == "PPPoE") {
document.getElementById("prtcltype").selectedIndex = 1;
} else if (ispPrtcl == "PPPoA") {
document.getElementById("prtcltype").selectedIndex = 2;
} else if (ispPrtcl == "Dynamic IP") {
document.getElementById("prtcltype").selectedIndex = 3;
} else if (ispPrtcl == "Static IP") {
document.getElementById("prtcltype").selectedIndex = 4;
} else if (ispPrtcl == "Bridge") {
document.getElementById("prtcltype").selectedIndex = 5;
} else
document.getElementById("prtcltype").selectedIndex = 0;
if (ispContype == "VC-Mux") {
document.getElementById("contype").selectedIndex = 1;
} else if (ispContype == "LLC") {
document.getElementById("contype").selectedIndex = 2;
} else
document.getElementById("contype").selectedIndex = 0;
onChangeProtocol();
document.getElementById("vpi").value = ispVPI;
document.getElementById("vci").value = ispVCI;
if ((document.getElementById("isplist").selectedIndex == (document.getElementById("isplist").length - 1)) || (document.getElementById("isplist").selectedIndex == 0)) {
document.getElementById("vpi").value = "(Enter a number)";
document.getElementById("vci").value = "(Enter a number)";
}
}
function onChangeProtocol()
{
ispPrtcl = document.getElementById("prtcltype").value;
document.getElementById("staticInfo").style.display = "none";
document.getElementById("pppoeInfo").style.display = "none";
if (ispPrtcl == "PPPoA") {
document.getElementById("lblProtName").innerHTML = "PPPoA";
document.getElementById("pppoeInfo").style.display = "block";
} else if (ispPrtcl == "PPPoE") {
document.getElementById("lblProtName").innerHTML = "PPPoE";
document.getElementById("pppoeInfo").style.display = "block";
} else if (ispPrtcl == "Static IP") {
document.getElementById("staticInfo").style.display = "block";
}
}
function isValidASCIIKey(str)
{
var patrn=/^[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~\x20]*[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}$/;   
if (!patrn.exec(str)) {
alert("Invalid characters!please check your input! ");
return 0 ;
}
if (str.indexOf("  ",0) != -1) {
alert("There should not be more than one consecutive space in the key!");
return 0;
}
return 1;
}
function isValidHexKey(str)
{
for (var i=0; i<str.length; i++)
{
if ((str.charAt(i) >= '0' && str.charAt(i) <= '9') ||
(str.charAt(i) >= 'a' && str.charAt(i) <= 'f') ||
(str.charAt(i) >= 'A' && str.charAt(i) <= 'F') )
continue;
alert("Invalid key value. It should be in hex number (0-9 or a-f).");
return 0;
}
return 1;
}
function isValidWPAPskKey(val) {
var ret = false;
var len = val.length;
var maxSize = 64;
var minSize = 8;
if (len >= minSize && len < maxSize)
ret = true;
else if (len == maxSize) {
for (i = 0; i < maxSize; i++)
if (i == maxSize)
ret = true;
}
else
ret = false;
var patrn=/^[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~\x20]*[a-zA-Z0-9!#$%&\'()*+,-./:;=?@[\\^_`{|}~]{1}$/;   
if (!patrn.exec(val)) {
alert("Invalid characters!please check your input! ");
return false;
}
if (val.indexOf("  ",0) != -1) {
alert("There should not be more than one consecutive space in the key!");
return false;
}
return ret;
}
function checkwl()
{
document.getElementById("trwlssid").style.display="none";
document.getElementById("trwlvisibility").style.display="none";
document.getElementById("trwlEncryption").style.display="none";
document.getElementById("trwlkey").style.display="none";
if (!document.getElementById("wlEnable").checked) {
document.getElementById("tdwlstate").innerHTML='Disabled';
return true;
}
document.getElementById("tdwlstate").innerHTML='Enabled';
var ssidvar = document.getElementById("SSID").value
if (ssidvar == '') {
alert('Wireless Network Name (SSID) should not be empty.');
return false;
}
if (ssidvar.charAt(0) == ' ') {
alert('Wireless Network Name (SSID) should not start with a <space>.');
return false;
}
if(!checkSpecialCharExcludeSpace(ssidvar, 1)){
alert('Invalid SSID.');
return false;
}
if (ssidvar.length > 32) {
alert('Wireless Network Name (SSID) "' + ssidvar + '" should not be longer than 32 characters.');
return false;
}
document.getElementById("trwlssid").style.display="";
document.getElementById("tdwlssid").innerHTML=ssidvar;
document.getElementById("trwlvisibility").style.display="";
if (document.getElementById("wlVisiblility").checked)
document.getElementById("tdwlvisibility").innerHTML='Visible';
else
document.getElementById("tdwlvisibility").innerHTML='Invisible';
document.getElementById("trwlEncryption").style.display="";
if (document.getElementById("encryptType0").checked) {
document.getElementById("tdwlEncryption").innerHTML='None';
}
else if (document.getElementById("encryptType1").checked) {
if (document.getElementById("encryptkey").value == '') {
alert('Key cannot have an empty value.');
document.setupWizard.encryptkey.focus();
return false;
}
var wepkeystr = document.getElementById("encryptkey").value;
if(wepkeystr.length ==5 || wepkeystr.length == 13)
{
if(!isValidASCIIKey(wepkeystr))
return false;
}
else if(wepkeystr.length ==10 || wepkeystr.length == 26)
{
if(!isValidHexKey(wepkeystr))
return false;
}
else
{
alert('Key should be 5/13 ASCII characters or 10/26 hex digits.');
return false;
}
document.getElementById("trwlkey").style.display="";
document.getElementById("tdwlEncryption").innerHTML='WEP';
document.getElementById("tdkeyname").innerHTML='WEP Key :';
document.getElementById("tdkeyval").innerHTML=document.getElementById("encryptkey").value;
}
else if ((document.getElementById("encryptType2").checked)||(document.getElementById("encryptType3").checked)) {
if (isValidWPAPskKey(document.getElementById("encryptkey").value) == false) {
alert('Key should be between 8 and 63 ASCII characters.');
return false;
}
document.getElementById("trwlkey").style.display="";
document.getElementById("tdwlEncryption").innerHTML='WPA-PSK/TKIP (also known as WPA Personal)';
if (document.getElementById("encryptType3").checked)
document.getElementById("tdwlEncryption").innerHTML='WPA2-PSK/AES (also known as WPA2 Personal)';
document.getElementById("tdkeyname").innerHTML='Pre-Shared Key :';
document.getElementById("tdkeyval").innerHTML=document.getElementById("encryptkey").value;
}
return true;
}
function doLabelChange()
{
document.getElementById("encryptkey").disabled = false;
if (document.getElementById("encryptType1").checked == true) {
document.getElementById("lblkey").innerHTML="WEP";
document.getElementById("lbllength").innerHTML="(5 or 13 characters, such as a~z, A~Z, or 0~9, or 10 or 26 hex digits, such as 0~9, a~f, or A~F, i.e. <b>@1xyz</b> or <b>@11xyzABC1234</b> or <b>A12B34C56D</b> or <b>A12B34C56D78E90Fabcdef1250</b>)";
document.getElementById("keySecInfo").style.display = 'block';
document.getElementById("encryptkey").value = '@11xyzABC1234';
} else if (document.getElementById("encryptType2").checked == true) {
document.getElementById("lblkey").innerHTML="WPA Pre-Shared";
document.getElementById("lbllength").innerHTML="(8-63 characters, such as a~z, A~Z, or 0~9, i.e. <b>'%Fortress123&'</b>)";
document.getElementById("keySecInfo").style.display = 'block';
document.getElementById("encryptkey").value = '%Fortress123&';
} else if (document.getElementById("encryptType3").checked == true) {
document.getElementById("lblkey").innerHTML="WPA2 Pre-Shared";
document.getElementById("lbllength").innerHTML="(8-63 characters, such as a~z, A~Z, or 0~9, i.e. <b>'%Fortress123&'</b>)";
document.getElementById("keySecInfo").style.display = 'block';
document.getElementById("encryptkey").value = '%Fortress123&';
} else {
document.getElementById("lblkey").innerHTML="";
document.getElementById("lbllength").innerHTML="";
document.getElementById("encryptkey").disabled = true;
document.getElementById("keySecInfo").style.display = 'none';
}
}
function doChangeWlInfo(value) {
switch (value) {
case 0:
document.getElementById("wlLevelInfo").innerHTML = '&nbsp;<b>Security Mode:</b> None<br>&nbsp;Select this option if you do not want to activate any security features.';
break;
case 1:
document.getElementById("wlLevelInfo").innerHTML = '&nbsp;<b>Security Mode:</b> WEP<br>&nbsp;Select this option if your wireless adapters only support WEP but do NOT support WPA.';
break;
case 2:
document.getElementById("wlLevelInfo").innerHTML = '&nbsp;<b>Security Mode:</b> WPA-PSK<br>&nbsp;Select this option if your wireless adapters support WPA-PSK.';
break;
case 3:
document.getElementById("wlLevelInfo").innerHTML = '&nbsp;<b>Security Mode:</b> WPA2-PSK<br>&nbsp;Select this option if your wireless adapters support WPA2-PSK.';
break;
}
doLabelChange();
}
function dowlEnable()
{
if (document.getElementById("wlEnable").checked != true) {
changeBlockState('wlSSISInfo',DISABLED);
changeBlockState('wlVisibleInfo',DISABLED);
changeBlockState('wlSecurityInfo',DISABLED);
changeBlockState('keySecInfo',DISABLED);
}
else {
changeBlockState('wlSSISInfo',ENABLED);
changeBlockState('wlVisibleInfo',ENABLED);
changeBlockState('wlSecurityInfo',ENABLED);
changeBlockState('keySecInfo',ENABLED);
}
}
function frmLoad() {
document.getElementById("div_intro").style.display = "";
document.getElementById("div_passwd").style.display = "none";
document.getElementById("div_sntp").style.display = "none";
document.getElementById("div_isp").style.display = "none";
document.getElementById("div_wl").style.display = "none";
document.getElementById("div_sum").style.display = "none";
document.getElementById("statip").value = addr;
document.getElementById("statmask").value = mask;
document.getElementById("statgw").value = gtwy;
document.getElementById("statdns").value = dns1;
createCountry(document.getElementById("country"));
onChangeCountry();
document.getElementById("encryptType0").checked = true;
doChangeWlInfo(0);
document.getElementById("wlEnable").checked = true;
document.getElementById("wlVisiblility").checked = true;
updateNtpMode();
}
var curDiv = "div_intro";
function btnBack()
{
switch(curDiv) {
case "div_passwd":
curDiv = "div_intro";
document.getElementById("div_intro").style.display = "";
document.getElementById("div_passwd").style.display = "none";
break;
case "div_sntp":
curDiv = "div_passwd";
document.getElementById("div_passwd").style.display = "";
document.getElementById("div_sntp").style.display = "none";
break;
case "div_isp":
curDiv = "div_sntp";
document.getElementById("div_sntp").style.display = "";
document.getElementById("div_isp").style.display = "none";
break;
case "div_wl":
curDiv = "div_isp";
document.getElementById("div_isp").style.display = "";
document.getElementById("div_wl").style.display = "none";
break;
case "div_sum":
curDiv = "div_wl";
document.getElementById("div_wl").style.display = "";
document.getElementById("div_sum").style.display = "none";
break;
}
}
function btnSkip()
{
if (curDiv == "div_passwd") {
curDiv = "div_sntp";
document.getElementById("pwdNew").value="";
document.getElementById("pwdCfm").value="";
document.getElementById("div_passwd").style.display = "none";
document.getElementById("div_sntp").style.display = "";
document.getElementById("sumpasswd").style.display = "none";
}
}
function btnCancel()
{
var code = 'location="internet.htm"';
var response = confirm('Are you sure you want to quit Setup Wizard and discard settings?');
if (response == 1) {
eval(code);
}
}
function btnNext()
{
switch(curDiv) {
case "div_intro":
document.getElementById("div_intro").style.display = "none";
curDiv = "div_passwd";
document.getElementById("div_passwd").style.display = "";
break;
case "div_passwd":
if (!checkPasswd())
return;
curDiv = "div_sntp";
document.getElementById("div_passwd").style.display = "none";
document.getElementById("div_sntp").style.display = "";
break;
case "div_sntp":
if (!checksntp())
return;
curDiv = "div_isp";
document.getElementById("div_sntp").style.display = "none";
document.getElementById("div_isp").style.display = "";
break;
case "div_isp":
if (!checkisp())
return;
curDiv = "div_wl";
document.getElementById("div_isp").style.display = "none";
document.getElementById("div_wl").style.display = "";
break;
case "div_wl":
if (!checkwl())
return;
curDiv = "div_sum";
document.getElementById("div_wl").style.display = "none";
document.getElementById("div_sum").style.display = "";
break;
}
}
function disableNtpClicked()
{
document.getElementById("ntp1Server").disabled=true;
document.getElementById("ntp2Server").disabled=true;
document.getElementById("ntpinterval").disabled=true;
document.getElementById("ntpserver").style.display="none";
document.getElementById("ntpserver2").style.display="none";
}
function enableNtpClicked()
{
document.getElementById("ntp1Server").disabled=false;
document.getElementById("ntp2Server").disabled=false;
document.getElementById("ntpinterval").disabled=false;
updateNtpServer();
}
function ntpConfigShow(isShow)
{
if(isShow == 0)
document.getElementById("ntpConfig").style.display="none";
else if(isShow == 1)
document.getElementById("ntpConfig").style.display="";
}
</script>
</head>
<body OnLoad="frmLoad()">
<blockquote>
<div id=hidediv style="display:none">
<IFRAME id=frmhide FRAMEBORDER=0 SCROLLING=no SRC=""></IFRAME>
</div>
<script type='text/javascript'>
wizardHead();
</script>
<div id=div_intro>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Welcome to D-Link Setup Wizard
</td>
</tr>
<tr>
<td class=content>
<P>This wizard will guide you through a step-by-step process to configure your new D-Link
router and connect to the Internet.</P>
<div align=center ><UL>
<table cellspacing=5 >
<tr><td>
<LI><b>Step 1&nbsp;:</b></td><td>&nbsp;&nbsp;Change Device Login Password
</td></tr>
<tr><td>
<LI><b>Step 2&nbsp;:</b></td><td>&nbsp;&nbsp;Set Time and Date
</td></tr>
<tr><td>
<LI><b>Step 3&nbsp;:</b></td><td>&nbsp;&nbsp;Setup Internet Connection
</td></tr>
<tr><td>
<LI><b>Step 4&nbsp;:</b></td><td>&nbsp;&nbsp;Configure Wireless Network
</td></tr>
<tr><td>
<LI><b>Step 5&nbsp;:</b></td><td>&nbsp;&nbsp;Completed and Apply
</td></tr>
</table>
</UL></div>
<p align=center>
<input type=button value='Next' onclick='btnNext()'>
<input type=button value='Cancel' onclick='btnCancel()'>
</p>
</td>
</tr>
</table>
</div>
<form action="form2Wizard.cgi" method=POST name="setupWizard">
<div id=div_passwd>
<table id=box_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Step 1: Change Device Login Password <font color="#f1f1f1">
&#8594; 2 &#8594; 3
&#8594; 4
&#8594; 5
</font>
</td>
</tr>
<tr>
<td class=content>
<P>To help secure your network, D-Link recommends that you should choose a new password. If you do not wish to choose a new password now, just click "Skip" to continue. Click "Next" to proceed to next step.</P>
<p>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 align=center>
<TR>
<TD class=form_label_nowidth width=52%><LABEL for=radio_control>Current Password&nbsp;:</LABEL></TD>
<TD><INPUT id=pwdOld name=pwdOld type=password maxlength="16"></TD>
</TR>
<TR>
<TD class=form_label_nowidth width=52%><LABEL for=radio_control>New Password&nbsp;:</LABEL></TD>
<TD><INPUT id=pwdNew name="pwdNew" type=password maxlength="16"></TD>
</TR>
<TR>
<TD class=form_label_nowidth width=52%><LABEL for=radio_control>Confirm Password&nbsp;:</LABEL></TD>
<TD><INPUT id=pwdCfm name="confirm" type=password maxlength="16"></TD>
</TR>
</TABLE>
</p>
<p align=center>
<input type=button value='Back' onclick='btnBack()'>
<input type=button value='Next' onclick='btnNext()'>
<input type=button value='Skip' onclick='btnSkip()'>
<input type=button value='Cancel' onclick='btnCancel()'>
</p>
</td>
</tr>
</table>
</div>
<div id=div_sntp>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">
<font color="#f1f1f1">1 &#8594; </font>
Step 2: Set Time and Date <font color="#f1f1f1">
&#8594; 3
&#8594; 4
&#8594; 5
</font>
</td>
</tr>
<tr>
<td class="content">
<p>The Time Configuration option allows you to configure, update, and maintain the correct time on the internal system clock. From this section you can set the time zone that you are in and set the NTP (Network Time Protocol) Server. Daylight Saving can also be configured to automatically adjust the time when needed.</p>
</td>
</tr>
</table>
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">System Time</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="650">
<tr>
<td class="form_label_left">System time:</td>
<td class="form_label_right">
<VWS_SCREEN (char*) showNtpGmtTimeHttp[];>
 </td>
</tr>
<tr>
<td class="form_label_left">Time Zone:</td>
<td class="form_label_right">
<VWS_SCREEN (char*) xscrnTimeZone_part1[];>
 <VWS_SCREEN (char*) xscrnTimeZone_part2[];>
 </td>
</tr>
<VWS_SCREEN (char*) xscrnSetDaylightSavingTime[];>
 <VWS_FUNCTION (void*)webShowSNtpMode();>
 </table>
</td>
</tr>
</table>
<br>
<div id="ntpConfig">
<table id="body_header" border="0" cellSpacing="0">
<tr>
<td class="topheader">NTP Configuration:</td>
</tr>
<tr>
<td class="content" align="left">
<table class="formarea" border="0" cellpadding="0" cellspacing="0" width="500">
<tr>
<td class="form_label_left">State:</td>
<td class="form_label_right" style="text-align: left;">
<input type="radio" value="Disable" id="ntpstate0" name="ntpstate" onclick="disableNtpClicked()"
<VWS_SCREEN (char*)xscrnNtpStateDisable[];>
 >Disable&nbsp;&nbsp;
<input type="radio" value="Enable" id="ntpstate1" name="ntpstate" onclick="enableNtpClicked()"
<VWS_SCREEN (char*)xscrnNtpStateEnable[];>
 >Enable
</td>
</tr>
<tr>
<td class="form_label_left">Server:</td>
<td class="form_label_right"><select name='ntp1Server' id=ntp1Server size="1" onChange="changeNtpServer(1);">
<script language="javascript">writeNtpList(true);
</script>
</select>
</td>
</tr>
<tr>
<td class="form_label_left"></td>
<td class="form_label_right">
<VWS_SCREEN (char*) setNtpServer[];>
 </td>
</tr>
<tr>
<td class="form_label_left">Server2:</td>
<td class="form_label_right"><select name='ntp2Server' id=ntp2Server size="1" onChange="changeNtpServer(2);">
<script language="javascript">writeNtpList(false);
</script>
</select>
</td>
</tr>
<tr>
<td class="form_label_left"></td>
<td class="form_label_right">
<VWS_SCREEN (char*) setNtpServer2[];>
 </td>
</tr>
<tr>
<td class="form_label_left">Interval:</td>
<td class="form_label_right">
<VWS_SCREEN (char*) setNtpInterval[];>
 </td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<br>
<p align=center>
<input type='button' value="Back" onClick='btnBack()' id='back'>
<input id='next' type='button' value="Next" onClick='btnNext()'>
<input type='button' onClick='btnCancel()' value='Cancel'>
</p>
</div>
<div id=div_isp>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">
<font color="#f1f1f1">1 &#8594; 2 &#8594; </font>
Step 3: Setup Internet Connection <font color="#f1f1f1">
&#8594; 4
&#8594; 5
</font>
</td>
</tr>
<tr>
<td class=content>
<P>Please select your Country and ISP (Internet Service Provider) from the list below. If your Country or ISP is not in the list, please select "Others". </P>
<p>
<div id=ispSecInfo>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 align=center width=70%>
<TR>
<TD class=form_label_nowidth width=51%><LABEL for=radio_control>Country&nbsp;:</LABEL></TD>
<TD><select id=country onchange='onChangeCountry()'>
<Option value=0>Select</Option>
<Option value=Others>Others</Option>
</select></TD>
</TR>
<TR>
<TD class=form_label_nowidth width=51%><LABEL for=radio_control>Internet Service Provider&nbsp;:</LABEL></TD>
<TD><select id=isplist onchange='onChangeISP()'>
<Option value=0>Select</Option>
<Option value=Others>Others</Option>
</select></TD>
</TR>
<tbody id='id_dslopt'>
<tr>
<td class=form_label_nowidth width=51% align=right>Protocol&nbsp;:</></td>
<td><select id=prtcltype name=prtcltype onchange='onChangeProtocol()'>
<option value="-1">(Click to Select)</option>
<option value="PPPoE">PPPoE</option>
<option value="PPPoA">PPPoA</option>
<option value="Dynamic IP">Dynamic IP</option>
<option value="Static IP">Static IP</option>
<option value="Bridge">Bridge</option>
</select></td>
</tr>
<tr>
<td class=form_label_nowidth width=51% align=right>Connection Type&nbsp;:</></td>
<td><select id=contype name=contype>
<option value="-1">(Click to Select)</option>
<option value="VC-Mux">VC-Mux</option>
<option value="LLC">LLC</option>
</select></td>
</tr>
<tr>
<td class=form_label_nowidth width=51% align=right><label id=lblvpi>VPI&nbsp;:</label></td>
<td><INPUT type=text id=vpi name=vpi maxlength='3' onFocus="this.value='';" onBlur="if(this.value==''){this.value='(Enter a number)';}">(0-255)</td>
</tr>
<tr>
<td class=form_label_nowidth width=51% align=right><label id=lblvci>VCI&nbsp;:</label></td>
<td><INPUT type=text id=vci name=vci maxlength='5' onFocus="this.value='';" onBlur="if(this.value==''){this.value='(Enter a number)';}">(32-65535)</td>
</tr>
</tbody>
<tr>
<td>&nbsp;</td>
<td></td>
</tr>
</TABLE>
</div>
</p>
</td>
</tr>
</table>
<BR>
<div id=pppoeInfo style="display:none">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader2><label id=lblProtName>PPPoE</label></td>
</tr>
<tr>
<td class=content>
<P>Please enter your Username and Password as provided by your ISP (Internet Service Provider). Please enter the information exactly as shown taking note of upper and lower cases. Click "Next" to continue.</P>
<p>
<TABLE class=formarea align=center>
<tr>
<td class=form_label_nowidth width=52%>Username&nbsp;:</></td>
<td><INPUT type=text id=username name=username maxlength='256'></td>
</tr>
<tr>
<td class=form_label_nowidth width=52%>Password&nbsp;:</></td>
<td><INPUT type=password id=password name=password maxlength='30'></td>
</tr>
<tr>
<td class=form_label_nowidth width=52%>Confirm Password&nbsp;:</></td>
<td><INPUT type=password id=conPass name=conPass maxlength='30'></td>
</tr>
</table>
</p>
</td>
</tr>
</table>
</div>
<div id=staticInfo style="display:none">
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>Static IP</td>
</tr>
<tr>
<td class=content>
<P>You have selected Static IP Internet connection. Please enter the appropriate information below as provided by your ISP.</P>
<p>The Auto PVC Scan feature will not work in all cases so please enter the VPI/VCI numbers if provided by the ISP.</p>
<p>Click Next to continue.</p>
<p>
<TABLE class=formarea align=center width=100%>
<tr>
<td class=form_label_nowidth width=51%>IP Address&nbsp;:</></td>
<td><INPUT type=text id=statip name=statip maxlength="15"></td>
</tr>
<tr>
<td class=form_label_nowidth width=51%>Subnet Mask&nbsp;:</></td>
<td><INPUT type=text id=statmask name=statmask maxlength="15"></td>
</tr>
<tr>
<td class=form_label_nowidth width=51%>Default Gateway&nbsp;:</></td>
<td><INPUT type=text id=statgw name=statgw maxlength="15"></td>
</tr>
<tr>
<td class=form_label_nowidth width=51%>Primary DNS Server&nbsp;:</></td>
<td><INPUT type=text id=statdns name=statdns maxlength="15"></td>
</tr>
</table>
</p>
</td>
</tr>
</table>
</div>
<br>
<p align=center>
<input type='button' value="Back" onClick='btnBack()' id='back'>
<input id='cmdNxt' type='button' value="Next" onClick='btnNext()'>
<input type='button' onClick='btnCancel()' value='Cancel'>
</p>
</div>
<div id=div_wl>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">
<font color="#f1f1f1">1 &#8594; 2 &#8594; 3 &#8594; </font>
Step 4: Configure Wireless Network <font color="#f1f1f1">
&#8594; 5</font>
</td>
</tr>
<tr>
<td class=content>
<P>Your wireless network is enabled by default. You can simply uncheck it to disable it and
click "Next" to skip configuration of wireless network.</P>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 width=100%>
<TR>
<td width=50px>&nbsp;</td>
<TD class=form_label_left_noWidth>
<INPUT type="checkbox" id=wlEnable name=wlEnable value="ON" onclick="dowlEnable()" class=INPUT_lefMinus4>&nbsp;&nbsp;
<label for=wlEnable>Enable Your Wireless Network</label>
</TD>
</TR>
</table>
<div id=wlSSISInfo>
<P>Your wireless network needs a name so it can be easily recognized by wireless clients.
For security purposes, it is highly recommended to change the pre-configured network name.</p>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 width=100%>
<TR>
<td width=50px>&nbsp;</td>
<TD class=form_label_left_noWidth>Wireless Network Name (SSID)&nbsp;:&nbsp;&nbsp;
<INPUT type="text" id=SSID name=ssid maxLength=32 value=
<VWS_SCREEN (char*) webShowWlanSSID[];>
 >&nbsp;
<label style="FONT-WEIGHT:normal">(1~32 characters)</label>
</TD>
</TR>
</TABLE>
</div>
<BR>
<div id=wlVisibleInfo>
<p>Select "Visible" to publish your wireless network and SSID can be found by wireless clients,
or select "Invisible" to hide your wireless network so that users need to manually enter SSID in
order to connect to your wireless network.</p>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 width=100%>
<TR>
<td width=50px>&nbsp;</td>
<TD class=form_label_left_noWidth>Visibility Status&nbsp;:</TD>
<TD class=left>
<table cellSpacing=0 cellPadding=0>
<tr><td>
<INPUT type="radio" id=wlVisiblility name=wlVisiblility value="0">
<label for=wlVisiblility>Visible</label>
&nbsp;&nbsp;&nbsp;&nbsp;
<INPUT type="radio" id=wlInvisiblility name=wlVisiblility value="1">
<label for=wlInvisiblility>Invisible</label>
</td></tr>
</table>
</TD>
</TR>
</table>
</div>
<BR>
<div id=wlSecurityInfo>
<P>In order to protect your network from hackers and unauthorized users, it is highly recommended
you choose one of the following wireless network security settings.</P>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 width=100%>
<tr>
<td width=50px>&nbsp;</td>
<td class=form_label_left_noWidth>Security Level&nbsp;:</td>
<td width=50px>&nbsp;</td>
</tr>
<tr>
<td width=50px>&nbsp;</td>
<td colspan=4>
<table width=100% cellSpacing=0 cellPadding=0 border=0>
<tr>
<td align=left width=25%><input type="radio" id=encryptType0 name=encryptType value="0" onclick="doChangeWlInfo(0)">
<label for=encryptType0>None</label>
</td>
<td align=left width=25%><input type="radio" id=encryptType1 name=encryptType value="1" onclick="doChangeWlInfo(1)">
<label for=encryptType1>WEP</label>
</td>
<td align=center width=25%><input type="radio" id=encryptType2 name=encryptType value="2" onclick="doChangeWlInfo(2)">
<label for=encryptType2>WPA-PSK</label>
</td>
<td align=right width=25%><input type="radio" id=encryptType3 name=encryptType value="3" onclick="doChangeWlInfo(3)">
<label for=encryptType3>WPA2-PSK</label>
</td>
</tr>
</table>
</td>
<td width=50px>&nbsp;</td>
</tr>
<tr>
<td width=50px>&nbsp;</td>
<td colspan=4>
<table border=1 cellSpacing=0 cellPadding=0 width=100% style="border-color:black">
<tr><td><label id=wlLevelInfo name=wlLevelInfo></label></td></tr>
</table>
</td>
<td width=50px>&nbsp;</td>
</tr>
</TABLE>
</div>
<BR>
<div id=keySecInfo>
<p>Now, please enter your wireless security key.</p>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 width=100%>
<TR>
<td width=50px>&nbsp;</td>
<TD class=form_label_left_noWidth>
<Label id=lblkey name=lblkey>WEP</label> Key&nbsp;:&nbsp;&nbsp;
<INPUT type=text id="encryptkey" name="encryptkey" maxlength="63" size="80" onFocus="this.value='';" onBlur="if(this.value==''){this.value='%Fortress123&';}">
</TD>
</TR>
<TR>
<td width=50px>&nbsp;</td>
<TD align=center><Label id=lbllength name=lbllength></label></TD>
</TR>
</table>
<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
<tr>
<td colspan=2>
<p><b>Note:</b> You will need to enter the same key here into your wireless clients in order to enable proper wireless connection.</p>
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
<br>
<p align=center>
<input type='button' value="Back" onClick='btnBack()' id='back'>
<input id='next' type='button' value="Next" onClick='btnNext()'>
<input type='button' onClick='btnCancel()' value='Cancel'>
</p>
</div>
<div id=div_sum>
<table id="box_header" border=0 cellSpacing=0>
<tr>
<td class="topheader">
<font color="#f1f1f1">1 &#8594; 2 &#8594; 3 &#8594; 4 &#8594; </font>
Step 5: Completed and Apply
</td>
</tr>
<tr>
<td class="content">
<P>Setup complete. Click "Back" to review or modify settings. Click "Apply" to apply current settings.</P>
<p>If your Internet connection does not work after apply, you can try the Setup Wizard again with alternative settings or use Manual Setup instead if you have your Internet connection details as provided by your ISP.</p>
</td>
</tr>
</table>
<table id=body_header border=0 cellSpacing=0>
<tr>
<td class=topheader>
Setup Summary
</td>
</tr>
<tr>

&&*&&en**&**
<td class=content>
<p>Below is a detailed summary of your settings.
Please print this page out, or write the information on a piece of paper, so you can configure the correct settings on your wireless client adapters.
</p>
<table id=sumpasswd class=formlisting style="width:590" align=center>
<tr><td class='form_label_col' width='300px'>Modem Password&nbsp;:</td>
<td id=tdpasswd></td></tr>
</table>
<table id=sumsntp class=formlisting style="width:590" align=center>
<tr><td class=form_label_col width=300px>Time Settings&nbsp;:</td>
<td id=tdtimestate>Enabled</td></tr>
<tr id=trntpstate><td class=form_label_col width=300px>NTP State&nbsp;:</td>
<td id=tdntpstate>Enabled</td></tr>
<tr id=trntpmode><td class=form_label_col width=300px>Mode&nbsp;:</td>
<td id=tdntpmode></td></tr>
<tr id=trntpone><td class=form_label_col width=300px>NTP Server 1&nbsp;:</td>
<td id=tdntpone></td></tr>
<tr id=trntptwo><td class=form_label_col width=300px>NTP Server 2&nbsp;:</td>
<td id=tdntptwo></td></tr>
<tr id=trntpint><td class=form_label_col width=300px>Interval&nbsp;:</td>
<td id=tdntpint></td></tr>
<tr id=trtimezone><td class=form_label_col width=300px>Time Zone&nbsp;:</td>
<td id=tdtimezone></td></tr>
<tr id=trdststat><td class=form_label_col width=300px>Daylight&nbsp;:</td>
<td id=tddststat></td></tr>
</table>
<table id=sumisp class=formlisting style="width:590" align=center>
<tr><td class=form_label_col width=300px>VPI / VCI&nbsp;:</td>
<td id=tdvpivci></td></tr>
<tr><td class=form_label_col width=300px>Protocol&nbsp;:</td>
<td id=tdprotocol>Bridge</td></tr>
<tr><td class=form_label_col width=300px>Connection Type&nbsp;:</td>
<td id=tdencapmode>VC-Mux</td></tr>
<tr id=trusername><td class=form_label_col width=300px>Username&nbsp;:</td>
<td id=tdusername></td></tr>
<tr id=trpassword><td class=form_label_col width=300px>Password&nbsp;:</td>
<td id=tdpassword></td></tr>
<tr id=tripaddress><td class=form_label_col width=300px>IP Address&nbsp;:</td>
<td id=tdipaddress></td></tr>
<tr id=trsubnet><td class=form_label_col width=300px>Subnet Mask&nbsp;:</td>
<td id=tdsubnet></td></tr>
<tr id=trgw><td class=form_label_col width=300px>Default Gateway&nbsp;:</td>
<td id=tdgw></td></tr>
<tr id=trpridns><td class=form_label_col width=300px>Primary DNS Server&nbsp;:</td>
<td id=tdpridns></td></tr>
</table>
<table id=tabwireless class=formlisting style="width:590" align=center>
<tr><td class=form_label_col width=300px>Wireless Network&nbsp;:</td>
<td id=tdwlstate>Disabled</td></tr>
<tr id=trwlssid><td class=form_label_col width=300px>Wireless Network Name (SSID)&nbsp;:</td>
<td id=tdwlssid></td></tr>
<tr id=trwlvisibility><td class=form_label_col width=300px>Visibility Status&nbsp;:</td>
<td id=tdwlvisibility></td></tr>
<tr id=trwlEncryption><td class=form_label_col width=300px>Encryption&nbsp;:</td>
<td id=tdwlEncryption>None</td></tr>
<tr id=trwlkey><td id=tdkeyname class=form_label_col width=300px>WEP Key&nbsp;:</td>
<td id=tdkeyval></td></tr>
</table>
<br>
</td>
</tr>
</table>
<br>
<p align=center>
<input type='button' value="Back" onClick='btnBack()' id='back'>
<input type='submit' value="Apply" name="save">
<input type='button' onClick='btnCancel()' value='Cancel'>
<INPUT TYPE="hidden" NAME="submit.htm?status.htm" VALUE="Send">
</p>
</div>
</form>
<script type='text/javascript'>
wizardFooter();
</script>
</blockquote>
</body>
</html>

&*#@ledtest.htm@#*&2031
<VWS_FUNCTION (void*)SendWebMetaStr();>
<VWS_FUNCTION (void*)SendWebCssStr();>
<title>Led Test</title>
<SCRIPT>
function stateChange()
{
document.led.action.value = 0;
return true;
}
function ledSelect()
{
var state=document.led.state.value;
var sel=document.led.ledselect.value;
if(state=="start"){
alert("Please start led test first!");
return false;
}
if (sel==0){
alert("Please select the led!");
return false;
}
document.led.action.value = 1;
return true;
}
</SCRIPT>
</head>
<body id="main_auto" topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" alink="#000000" link="#000000" vlink="#000000" >
<blockquote>
<DIV align="left" style="padding-left:20px; padding-top:5px">
<form action="form2Ledtest.cgi" method=POST name="led">
<b>Led test</b><br><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td>led test</td>
<td colspan=2><input type="submit" name="state" value="start" onclick="return stateChange()"></td>
</tr>
<tr>
<td width="30%">led test set</td>
<td width="35%">
<select name="ledselect">
<option value="0">Please select</option>
<option value="1">power red</option>
<option value="2">power green</option>
<option value="3">dsl</option>
<option value="4">internet red</option>
<option value="5">internet green</option>
<option value="6">lan 1</option>
<option value="7">lan 2</option>
<option value="8">lan 3</option>
<option value="9">lan 4</option>
<option value="10">wlan</option>
<option value="11">wps green</option>
<option value="12">wps red</option>
<option value="13">wps yellow</option>
<option value="15">all led on</option>
<option value="16">all led off</option>
<option value="17">all green led on</option>
<option value="18">all red led on</option>
</select>
</td>
<td><input type="submit" name="light" value="submit" onclick="return ledSelect()">
</tr>
</table>
<br>
<input type="hidden" name="action">
<input type="hidden" name="submit.htm?ledtest.htm" value="Send">
<script>
<VWS_FUNCTION (void*)ledtestinitpage();>
 </script>
</form>
</DIV>
</blockquote>
</body>
</html>
